module.exports=[20731,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944);a.i(30485);var e=a.i(31052),f=a.i(18740),g=a.i(19337),h=a.i(70106);let i=(0,h.default)("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]),j=(0,h.default)("Pause",[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]]);var k=a.i(87654),l=a.i(21161),m=a.i(33508);let n=(0,h.default)("Volume2",[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]]),o=(0,h.default)("VolumeX",[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15",key:"1ewh16"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15",key:"5ykzw1"}]]);var p=a.i(44194),q=a.i(61545),r=a.i(40695),s=a.i(45404),t=a.i(79641),u=a.i(3130);let v=(0,h.default)("Waves",[["path",{d:"M2 6c.6.5 1.2 1 2.5 1C7 7 7 5 9.5 5c2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"knzxuh"}],["path",{d:"M2 12c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"2jd2cc"}],["path",{d:"M2 18c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"rd2r6e"}]]),w=(0,h.default)("CloudRain",[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M16 14v6",key:"1j4efv"}],["path",{d:"M8 14v6",key:"17c4r9"}],["path",{d:"M12 16v6",key:"c8a4gj"}]]),x=(0,h.default)("Wind",[["path",{d:"M17.7 7.7a2.5 2.5 0 1 1 1.8 4.3H2",key:"1k4u03"}],["path",{d:"M9.6 4.6A2 2 0 1 1 11 8H2",key:"b7d0fd"}],["path",{d:"M12.6 19.4A2 2 0 1 0 14 16H2",key:"1p5cb3"}]]),y=(0,h.default)("Music",[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]]),z=(0,h.default)("BellOff",[["path",{d:"M8.7 3A6 6 0 0 1 18 8a21.3 21.3 0 0 0 .6 5",key:"o7mx20"}],["path",{d:"M17 17H3s3-2 3-9a4.67 4.67 0 0 1 .3-1.7",key:"16f1lm"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);var A=a.i(23312);function B({isActive:a}){let[d,e]=(0,c.useState)("none"),[f,g]=(0,c.useState)(.3),[h,i]=(0,c.useState)(!1),j=(0,c.useRef)(null);(0,c.useEffect)(()=>()=>{j.current&&(j.current.pause(),j.current=null)},[]),(0,c.useEffect)(()=>{j.current&&a&&("none"===d?j.current.pause():console.log(`Would play: ${{"coffee-shop":"/sounds/coffee-shop.mp3",rain:"/sounds/rain.mp3",ocean:"/sounds/ocean.mp3","white-noise":"/sounds/white-noise.mp3","lo-fi":"/sounds/lo-fi.mp3"}[d]}`))},[d,a]),(0,c.useEffect)(()=>{j.current&&(j.current.volume=f)},[f]),(0,c.useEffect)(()=>{document.title="StudyPal"},[h]);let k=[{id:"none",label:"Silence",icon:o,color:"gray"},{id:"coffee-shop",label:"Coffee Shop",icon:p.Coffee,color:"amber"},{id:"rain",label:"Rain",icon:w,color:"blue"},{id:"ocean",label:"Ocean",icon:v,color:"cyan"},{id:"white-noise",label:"White Noise",icon:x,color:"slate"},{id:"lo-fi",label:"Lo-Fi Beats",icon:y,color:"purple"}];return a?(0,b.jsx)(u.Card,{className:"p-4 bg-gradient-to-br from-purple-500/5 to-pink-500/5 border-purple-500/20",children:(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(n,{className:"w-4 h-4 text-purple-500"}),(0,b.jsx)("h4",{className:"font-semibold",children:"Ambient Sounds"})]}),(0,b.jsxs)("button",{onClick:()=>i(!h),className:`flex items-center gap-1 px-3 py-1 rounded-full text-xs font-medium transition-all ${h?"bg-red-500 text-white":"bg-gray-100 dark:bg-gray-800 text-muted-foreground hover:bg-gray-200 dark:hover:bg-gray-700"}`,children:[h?(0,b.jsx)(z,{className:"w-3 h-3"}):(0,b.jsx)(A.Bell,{className:"w-3 h-3"}),h?"DND On":"DND Off"]})]}),(0,b.jsx)("div",{className:"grid grid-cols-3 gap-2",children:k.map(a=>{let c=a.icon,f=d===a.id;return(0,b.jsxs)("button",{onClick:()=>e(a.id),className:`flex flex-col items-center gap-1 p-3 rounded-lg border transition-all ${f?`bg-${a.color}-500/10 border-${a.color}-500 text-${a.color}-500`:"bg-background border-border hover:border-gray-400"}`,children:[(0,b.jsx)(c,{className:"w-5 h-5"}),(0,b.jsx)("span",{className:"text-xs font-medium",children:a.label})]},a.id)})}),"none"!==d&&(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between text-xs text-muted-foreground",children:[(0,b.jsx)("span",{children:"Volume"}),(0,b.jsxs)("span",{children:[Math.round(100*f),"%"]})]}),(0,b.jsx)("input",{type:"range",min:"0",max:"100",value:100*f,onChange:a=>g(Number(a.target.value)/100),className:"w-full h-2 bg-gray-200 dark:bg-gray-800 rounded-lg appearance-none cursor-pointer accent-purple-500"})]}),h&&(0,b.jsx)("div",{className:"pt-2 border-t border-purple-500/20",children:(0,b.jsxs)("p",{className:"text-xs text-muted-foreground flex items-center gap-2",children:[(0,b.jsx)(z,{className:"w-3 h-3"}),"Do Not Disturb is active. Browser notifications are suppressed."]})})]})}):null}let C={workDuration:25,shortBreakDuration:5,longBreakDuration:15,sessionsBeforeLongBreak:4,autoStartBreaks:!0,autoStartWork:!1,soundEnabled:!0,notificationsEnabled:!0};function D({task:a,onClose:d,compact:e=!1,onSessionComplete:f}){let{user:h}=(0,s.useAuthContext)(),[u,v]=(0,c.useState)(C),[w,x]=(0,c.useState)(!1),[y,z]=(0,c.useState)("work"),[A,D]=(0,c.useState)(60*C.workDuration),[E,F]=(0,c.useState)(!1),[G,H]=(0,c.useState)(0),[I,J]=(0,c.useState)(0),[K,L]=(0,c.useState)(0),M=(0,c.useRef)(null),N=(0,c.useRef)(null),[O,P]=(0,c.useState)(null);(0,c.useEffect)(()=>{h&&((0,g.getPomodoroSettings)(h.uid).then(a=>{a&&(v(a),D(60*a.workDuration))}),(0,t.generatePersonalizedContent)({learningStyle:"visual",goals:["Improve focus","Complete tasks efficiently"],currentLevel:"intermediate",preferredSubjects:["Study","Work"]},"productivity techniques","explanation").then(a=>{P({optimalWorkTime:"9:00 AM - 11:00 AM",recommendedBreakActivity:"Take a 5-minute walk or do stretching exercises",productivityTips:["Maintain consistent sleep schedule","Stay hydrated during work sessions","Use the 2-minute rule for small tasks"]})}).catch(()=>{P({optimalWorkTime:"Morning hours",recommendedBreakActivity:"Light exercise or meditation",productivityTips:["Stay focused","Take regular breaks","Track progress"]})}))},[h]),(0,c.useEffect)(()=>{let a=null;return E&&A>0?a=setInterval(()=>{D(a=>a-1)},1e3):0===A&&Y(),()=>{a&&clearInterval(a)}},[E,A]);let[Q,R]=(0,c.useState)(!1),[S,T]=(0,c.useState)(""),U=(0,c.useRef)(null),V=(0,c.useRef)(null);(0,c.useEffect)(()=>{"Notification"in window&&"default"===Notification.permission&&Notification.requestPermission()},[]),(0,c.useEffect)(()=>{let a=()=>{try{V.current=new(window.AudioContext||window.webkitAudioContext)}catch(a){console.warn("Audio context not supported")}document.removeEventListener("click",a),document.removeEventListener("keydown",a)};return document.addEventListener("click",a),document.addEventListener("keydown",a),()=>{document.removeEventListener("click",a),document.removeEventListener("keydown",a)}},[]);let W=(0,c.useCallback)(()=>{if(u.soundEnabled)try{if(V.current){let a=V.current,b=a.createOscillator(),c=a.createGain();b.connect(c),c.connect(a.destination),b.frequency.setValueAtTime(800,a.currentTime),b.frequency.setValueAtTime(600,a.currentTime+.1),c.gain.setValueAtTime(.3,a.currentTime),c.gain.exponentialRampToValueAtTime(.01,a.currentTime+.5),b.start(a.currentTime),b.stop(a.currentTime+.5)}else M.current&&M.current.play().catch(()=>{})}catch(a){console.warn("Audio playback failed:",a)}},[u.soundEnabled]),X=(0,c.useCallback)(a=>{T(a),R(!0),U.current&&clearTimeout(U.current),U.current=setTimeout(()=>{R(!1)},5e3)},[]),Y=(0,c.useCallback)(async()=>{if(F(!1),W(),u.notificationsEnabled&&"Notification"in window)if("granted"===Notification.permission){let a=new Notification("work"===y?"ðŸŽ‰ Focus Session Complete!":"â˜• Break Time Over!",{body:"work"===y?`Great work! Take a ${G+1>=u.sessionsBeforeLongBreak?"long":"short"} break.`:"Time to get back to work!",icon:"/icon.svg",badge:"/icon.svg",requireInteraction:!0,silent:!1});setTimeout(()=>a.close(),1e4)}else"default"===Notification.permission&&Notification.requestPermission();if(X("work"===y?`ðŸŽ‰ Session Complete! ${G+1>=u.sessionsBeforeLongBreak?"Long break time!":"Short break earned!"}`:"âš¡ Break's over! Ready to focus?"),h&&N.current&&"work"===y){let b=u.workDuration,c={userId:h.uid,startTime:N.current,endTime:new Date,plannedDuration:b,actualDuration:b,type:y,completed:!0,interrupted:!1};a?.id&&(c.taskId=a.id),a?.course&&(c.course=a.course),await (0,g.logPomodoroSession)(c),J(a=>a+b),H(a=>a+1),L(a=>a+1),f?.({duration:b,type:"work"})}if("work"===y){let a=(G+1)%u.sessionsBeforeLongBreak==0?"long-break":"short-break";z(a),D("long-break"===a?60*u.longBreakDuration:60*u.shortBreakDuration),u.autoStartBreaks&&setTimeout(()=>{F(!0),N.current=new Date},1e3)}else z("work"),D(60*u.workDuration),u.autoStartWork&&setTimeout(()=>{F(!0),N.current=new Date},1e3)},[y,u,G,h,a,f]),Z=()=>{!E&&(N.current=new Date,u.notificationsEnabled&&"Notification"in window&&"default"===Notification.permission&&Notification.requestPermission()),F(!E)},$=()=>{F(!1),D("work"===y?60*u.workDuration:"short-break"===y?60*u.shortBreakDuration:60*u.longBreakDuration),N.current=null},_=async a=>{let b={...u,...a};v(b),h&&await (0,g.savePomodoroSettings)({...b,userId:h.uid}),!E&&(a.workDuration&&"work"===y&&D(60*a.workDuration),a.shortBreakDuration&&"short-break"===y&&D(60*a.shortBreakDuration),a.longBreakDuration&&"long-break"===y&&D(60*a.longBreakDuration))},aa=a=>{let b=Math.floor(a/60);return`${b.toString().padStart(2,"0")}:${(a%60).toString().padStart(2,"0")}`},ab="work"===y?1-A/(60*u.workDuration):"short-break"===y?1-A/(60*u.shortBreakDuration):1-A/(60*u.longBreakDuration),ac=()=>{switch(y){case"work":return"from-red-500 to-orange-500";case"short-break":return"from-green-500 to-emerald-500";case"long-break":return"from-blue-500 to-cyan-500"}};return e?(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("audio",{ref:M,src:"/notification.mp3",preload:"auto"}),(0,b.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(()=>{switch(y){case"work":return(0,b.jsx)(q.Brain,{className:"w-5 h-5"});case"short-break":case"long-break":return(0,b.jsx)(p.Coffee,{className:"w-5 h-5"})}})(),(0,b.jsx)("span",{className:"text-sm font-medium capitalize",children:y.replace("-"," ")})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("button",{onClick:()=>_({soundEnabled:!u.soundEnabled}),className:"p-1 hover:bg-slate-700 rounded",children:u.soundEnabled?(0,b.jsx)(n,{className:"w-4 h-4"}):(0,b.jsx)(o,{className:"w-4 h-4"})}),d&&(0,b.jsx)("button",{onClick:d,className:"p-1 hover:bg-slate-700 rounded",children:(0,b.jsx)(m.X,{className:"w-4 h-4"})})]})]}),(0,b.jsxs)("div",{className:"text-center mb-4",children:[(0,b.jsx)("div",{className:"text-4xl font-mono font-bold text-slate-100 mb-2",children:aa(A)}),(0,b.jsx)("div",{className:"h-2 bg-muted rounded-full overflow-hidden",children:(0,b.jsx)("div",{className:`h-full bg-gradient-to-r ${ac()} transition-all duration-1000`,style:{width:`${100*ab}%`}})})]}),(0,b.jsxs)("div",{className:"flex justify-center gap-3",children:[(0,b.jsx)(r.Button,{size:"sm",variant:"outline",onClick:$,children:(0,b.jsx)(k.RotateCcw,{className:"w-4 h-4"})}),(0,b.jsx)(r.Button,{size:"sm",onClick:Z,className:`bg-gradient-to-r ${ac()} text-white`,children:E?(0,b.jsx)(j,{className:"w-4 h-4"}):(0,b.jsx)(i,{className:"w-4 h-4"})})]}),(0,b.jsxs)("div",{className:"flex justify-center gap-4 mt-4 text-xs text-slate-400",children:[(0,b.jsxs)("span",{children:[G," sessions"]}),(0,b.jsx)("span",{children:"â€¢"}),(0,b.jsxs)("span",{children:[Math.round(I)," min focused"]}),(0,b.jsx)("span",{children:"â€¢"}),(0,b.jsxs)("span",{children:[K," day streak"]})]})]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("audio",{ref:M,src:"/notification.mp3",preload:"auto"}),(0,b.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold text-slate-100",children:"Focus Timer"}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("button",{onClick:()=>x(!w),className:"p-2 hover:bg-slate-700 rounded-lg transition-colors",children:(0,b.jsx)(l.Settings,{className:"w-5 h-5"})}),d&&(0,b.jsx)("button",{onClick:d,className:"p-2 hover:bg-slate-700 rounded-lg transition-colors",children:(0,b.jsx)(m.X,{className:"w-5 h-5"})})]})]}),a&&(0,b.jsxs)("div",{className:"mb-6 p-4 rounded-xl bg-card border border-border",children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Working on:"}),(0,b.jsx)("p",{className:"font-medium text-foreground",children:a.title})]}),(0,b.jsx)("div",{className:"flex gap-2 mb-6",children:[{id:"work",label:"Focus",icon:q.Brain},{id:"short-break",label:"Short Break",icon:p.Coffee},{id:"long-break",label:"Long Break",icon:p.Coffee}].map(({id:a,label:c,icon:d})=>(0,b.jsxs)("button",{onClick:()=>{F(!1),z(a),D("work"===a?60*u.workDuration:"short-break"===a?60*u.shortBreakDuration:60*u.longBreakDuration)},className:`flex-1 flex items-center justify-center gap-2 py-2 px-3 rounded-lg text-sm font-medium transition-colors ${y===a?`bg-gradient-to-r ${"work"===a?"from-red-500 to-orange-500":"short-break"===a?"from-green-500 to-emerald-500":"from-blue-500 to-cyan-500"} text-white`:"bg-slate-700 text-slate-400 hover:text-slate-100"}`,children:[(0,b.jsx)(d,{className:"w-4 h-4"}),(0,b.jsx)("span",{className:"text-xs sm:text-sm",children:c})]},a))}),(0,b.jsx)("div",{className:"flex justify-center mb-8",children:(0,b.jsxs)("div",{className:"relative w-64 h-64",children:[(0,b.jsxs)("svg",{className:"w-full h-full transform -rotate-90",children:[(0,b.jsx)("circle",{cx:"128",cy:"128",r:"120",fill:"none",stroke:"currentColor",strokeWidth:"8",className:"text-muted"}),(0,b.jsx)("circle",{cx:"128",cy:"128",r:"120",fill:"none",stroke:"url(#gradient)",strokeWidth:"8",strokeLinecap:"round",strokeDasharray:2*Math.PI*120,strokeDashoffset:2*Math.PI*120*(1-ab),className:"transition-all duration-1000"}),(0,b.jsx)("defs",{children:(0,b.jsxs)("linearGradient",{id:"gradient",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:["work"===y&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("stop",{offset:"0%",stopColor:"#ef4444"}),(0,b.jsx)("stop",{offset:"100%",stopColor:"#f97316"})]}),"short-break"===y&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("stop",{offset:"0%",stopColor:"#22c55e"}),(0,b.jsx)("stop",{offset:"100%",stopColor:"#10b981"})]}),"long-break"===y&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("stop",{offset:"0%",stopColor:"#3b82f6"}),(0,b.jsx)("stop",{offset:"100%",stopColor:"#06b6d4"})]})]})})]}),(0,b.jsxs)("div",{className:"absolute inset-0 flex flex-col items-center justify-center",children:[(0,b.jsx)("span",{className:"text-5xl font-mono font-bold text-slate-100",children:aa(A)}),(0,b.jsx)("span",{className:"text-sm text-slate-400 capitalize mt-2",children:y.replace("-"," ")})]})]})}),(0,b.jsxs)("div",{className:"flex justify-center gap-4 mb-6",children:[(0,b.jsx)(r.Button,{variant:"outline",size:"lg",onClick:$,className:"w-14 h-14 rounded-full p-0",children:(0,b.jsx)(k.RotateCcw,{className:"w-6 h-6"})}),(0,b.jsx)(r.Button,{size:"lg",onClick:Z,className:`w-20 h-20 rounded-full p-0 bg-gradient-to-r ${ac()} hover:opacity-90 text-white shadow-lg`,children:E?(0,b.jsx)(j,{className:"w-8 h-8"}):(0,b.jsx)(i,{className:"w-8 h-8 ml-1"})}),(0,b.jsx)(r.Button,{variant:"outline",size:"lg",onClick:()=>_({soundEnabled:!u.soundEnabled}),className:"w-14 h-14 rounded-full p-0",children:u.soundEnabled?(0,b.jsx)(n,{className:"w-6 h-6"}):(0,b.jsx)(o,{className:"w-6 h-6"})})]}),(0,b.jsxs)("div",{className:"flex justify-center gap-8 text-center",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-2xl font-bold text-slate-100",children:G}),(0,b.jsx)("p",{className:"text-xs text-slate-400",children:"Sessions"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-2xl font-bold text-slate-100",children:Math.round(I)}),(0,b.jsx)("p",{className:"text-xs text-slate-400",children:"Minutes focused"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-2xl font-bold text-slate-100",children:K}),(0,b.jsx)("p",{className:"text-xs text-slate-400",children:"Day streak"})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("p",{className:"text-2xl font-bold text-slate-100",children:[G%u.sessionsBeforeLongBreak,"/",u.sessionsBeforeLongBreak]}),(0,b.jsx)("p",{className:"text-xs text-slate-400",children:"Until long break"})]})]}),O&&(0,b.jsxs)("div",{className:"mt-6 p-4 rounded-xl bg-gradient-to-br from-purple-500/10 to-pink-500/10 border border-purple-500/20",children:[(0,b.jsxs)("h3",{className:"font-medium text-slate-100 mb-3 flex items-center gap-2",children:[(0,b.jsx)(q.Brain,{className:"w-4 h-4 text-purple-500"}),"AI Productivity Insights"]}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Optimal work time"}),(0,b.jsx)("p",{className:"font-medium text-foreground",children:O.optimalWorkTime})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Recommended break activity"}),(0,b.jsx)("p",{className:"font-medium text-foreground",children:O.recommendedBreakActivity})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground mb-2",children:"Productivity tips"}),(0,b.jsx)("ul",{className:"space-y-1",children:O.productivityTips.map((a,c)=>(0,b.jsxs)("li",{className:"text-sm text-foreground flex items-start gap-2",children:[(0,b.jsx)("span",{className:"text-purple-500 mt-1",children:"â€¢"}),a]},c))})]})]})]}),(0,b.jsx)("div",{className:"mt-6",children:(0,b.jsx)(B,{isActive:E&&"work"===y})}),w&&(0,b.jsxs)("div",{className:"mt-6 p-4 rounded-xl bg-card border border-border space-y-4",children:[(0,b.jsx)("h3",{className:"font-medium text-foreground",children:"Timer Settings"}),(0,b.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-xs text-muted-foreground",children:"Focus (min)"}),(0,b.jsx)("input",{type:"number",value:u.workDuration,onChange:a=>_({workDuration:parseInt(a.target.value)||25}),className:"w-full mt-1 px-3 py-2 rounded-lg bg-muted border border-border text-foreground text-sm",min:1,max:120})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-xs text-muted-foreground",children:"Short Break"}),(0,b.jsx)("input",{type:"number",value:u.shortBreakDuration,onChange:a=>_({shortBreakDuration:parseInt(a.target.value)||5}),className:"w-full mt-1 px-3 py-2 rounded-lg bg-muted border border-border text-foreground text-sm",min:1,max:30})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-xs text-muted-foreground",children:"Long Break"}),(0,b.jsx)("input",{type:"number",value:u.longBreakDuration,onChange:a=>_({longBreakDuration:parseInt(a.target.value)||15}),className:"w-full mt-1 px-3 py-2 rounded-lg bg-muted border border-border text-foreground text-sm",min:1,max:60})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("label",{className:"flex items-center gap-3 cursor-pointer",children:[(0,b.jsx)("input",{type:"checkbox",checked:u.autoStartBreaks,onChange:a=>_({autoStartBreaks:a.target.checked}),className:"w-4 h-4 rounded"}),(0,b.jsx)("span",{className:"text-sm text-foreground",children:"Auto-start breaks"})]}),(0,b.jsxs)("label",{className:"flex items-center gap-3 cursor-pointer",children:[(0,b.jsx)("input",{type:"checkbox",checked:u.autoStartWork,onChange:a=>_({autoStartWork:a.target.checked}),className:"w-4 h-4 rounded"}),(0,b.jsx)("span",{className:"text-sm text-foreground",children:"Auto-start focus after break"})]}),(0,b.jsxs)("label",{className:"flex items-center gap-3 cursor-pointer",children:[(0,b.jsx)("input",{type:"checkbox",checked:u.notificationsEnabled,onChange:a=>_({notificationsEnabled:a.target.checked}),className:"w-4 h-4 rounded"}),(0,b.jsx)("span",{className:"text-sm text-foreground",children:"Desktop notifications"})]})]})]})]}),Q&&(0,b.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 pointer-events-none",children:(0,b.jsxs)("div",{className:"bg-gradient-to-r from-green-500 to-blue-500 text-white px-8 py-4 rounded-2xl shadow-2xl animate-bounce max-w-md mx-4 text-center",children:[(0,b.jsx)("div",{className:"text-4xl mb-2",children:"ðŸŽ‰"}),(0,b.jsx)("p",{className:"text-lg font-semibold",children:S}),(0,b.jsx)("button",{onClick:()=>R(!1),className:"mt-3 px-4 py-2 bg-white/20 rounded-lg hover:bg-white/30 transition-colors pointer-events-auto",children:"Dismiss"})]})})]})}var E=a.i(27508),F=a.i(41675);let G=(0,h.default)("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);var H=a.i(15618),I=a.i(8406),J=a.i(53722);let K=(0,h.default)("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);var L=a.i(38246);function M({tasks:a,events:c,habits:e,focusMinutes:f=0,targetMinutes:g=120,flashcardsDue:h=0,onStartFocus:j,onTaskClick:k,onTaskToggle:l,onHabitToggle:m,onOpenJarvis:n}){let o=(0,d.useRouter)(),p=new Date().toISOString().split("T")[0],q=a.filter(a=>"done"!==a.status).length,s=e.filter(a=>a.completions?.some(a=>a.date===p&&a.completed)).length,t=e.length,v=t-s,w=a.find(a=>"done"!==a.status);return(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[(0,b.jsxs)("button",{onClick:j,className:"group p-4 rounded-xl bg-gradient-to-br from-blue-600/20 to-blue-800/10 border border-blue-500/30 hover:border-blue-400/50 hover:from-blue-600/30 transition-all text-left",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("div",{className:"w-8 h-8 rounded-lg bg-blue-500/20 flex items-center justify-center",children:(0,b.jsx)(i,{className:"w-4 h-4 text-blue-400"})}),(0,b.jsx)("span",{className:"text-sm font-medium text-slate-300",children:"Focus"})]}),(0,b.jsx)(K,{className:"w-4 h-4 text-blue-400 opacity-0 group-hover:opacity-100 transition-opacity"})]}),(0,b.jsxs)("div",{className:"flex items-baseline gap-1",children:[(0,b.jsx)("span",{className:"text-2xl font-bold text-white",children:f}),(0,b.jsxs)("span",{className:"text-slate-400 text-sm",children:["/ ",g," min"]})]}),(0,b.jsx)("p",{className:"text-xs text-blue-400 mt-1 font-medium",children:"Start 25-min session â†’"})]}),(0,b.jsxs)("button",{onClick:()=>w?k(w):o.push("/planner"),className:"group p-4 rounded-xl bg-gradient-to-br from-yellow-600/10 to-orange-800/5 border border-yellow-500/20 hover:border-yellow-400/40 transition-all text-left",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("div",{className:"w-8 h-8 rounded-lg bg-yellow-500/20 flex items-center justify-center",children:(0,b.jsx)(G,{className:"w-4 h-4 text-yellow-400"})}),(0,b.jsx)("span",{className:"text-sm font-medium text-slate-300",children:"Tasks"})]}),(0,b.jsx)(K,{className:"w-4 h-4 text-yellow-400 opacity-0 group-hover:opacity-100 transition-opacity"})]}),(0,b.jsxs)("div",{className:"flex items-baseline gap-1",children:[(0,b.jsx)("span",{className:"text-2xl font-bold text-white",children:q}),(0,b.jsx)("span",{className:"text-slate-400 text-sm",children:"pending"})]}),(0,b.jsx)("p",{className:"text-xs text-yellow-400 mt-1 font-medium",children:q>0?"Do next task â†’":"Add tasks â†’"})]}),(0,b.jsx)(L.default,{href:"/flashcards",className:"block",children:(0,b.jsxs)("div",{className:"group p-4 rounded-xl bg-gradient-to-br from-purple-600/10 to-purple-800/5 border border-purple-500/20 hover:border-purple-400/40 transition-all text-left h-full",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("div",{className:"w-8 h-8 rounded-lg bg-purple-500/20 flex items-center justify-center",children:(0,b.jsx)(J.BookOpen,{className:"w-4 h-4 text-purple-400"})}),(0,b.jsx)("span",{className:"text-sm font-medium text-slate-300",children:"Cards"})]}),(0,b.jsx)(K,{className:"w-4 h-4 text-purple-400 opacity-0 group-hover:opacity-100 transition-opacity"})]}),(0,b.jsxs)("div",{className:"flex items-baseline gap-1",children:[(0,b.jsx)("span",{className:"text-2xl font-bold text-white",children:h}),(0,b.jsx)("span",{className:"text-slate-400 text-sm",children:"due"})]}),(0,b.jsx)("p",{className:"text-xs text-purple-400 mt-1 font-medium",children:h>0?"Review now â†’":"Create cards â†’"})]})})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[(0,b.jsxs)(u.Card,{className:"p-4 bg-slate-800/40 border-slate-700/50",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,b.jsx)("span",{className:"text-sm font-medium text-slate-300",children:"Today's Tasks"}),(0,b.jsx)(L.default,{href:"/planner",className:"text-xs text-blue-400 hover:text-blue-300",children:"All â†’"})]}),0===a.length?(0,b.jsxs)("div",{className:"py-4 text-center",children:[(0,b.jsx)("p",{className:"text-slate-500 text-sm mb-3",children:"No tasks scheduled"}),(0,b.jsxs)("div",{className:"flex gap-2 justify-center",children:[(0,b.jsxs)(r.Button,{size:"sm",variant:"outline",className:"text-xs h-8",onClick:()=>o.push("/planner"),children:[(0,b.jsx)(H.Plus,{className:"w-3 h-3 mr-1"}),"Add 3 tasks"]}),n&&(0,b.jsxs)(r.Button,{size:"sm",variant:"ghost",className:"text-xs h-8 text-purple-400",onClick:n,children:[(0,b.jsx)(I.Sparkles,{className:"w-3 h-3 mr-1"}),"AI plan"]})]})]}):(0,b.jsxs)("div",{className:"space-y-1.5",children:[a.slice(0,5).map(a=>(0,b.jsxs)("div",{className:`group flex items-center gap-2 p-2 rounded-lg bg-slate-700/30 hover:bg-slate-700/50 cursor-pointer border-l-2 ${(a=>{switch(a){case"urgent":return"border-l-red-500";case"high":return"border-l-orange-500";case"medium":return"border-l-yellow-500";default:return"border-l-slate-600"}})(a.priority)} transition-all`,children:[(0,b.jsx)("button",{onClick:b=>{b.stopPropagation(),l(a.id,"done"!==a.status)},className:`w-4 h-4 rounded border flex-shrink-0 ${"done"===a.status?"bg-green-500 border-green-500":"border-slate-500 hover:border-blue-400"} flex items-center justify-center`,children:"done"===a.status&&(0,b.jsx)(G,{className:"w-3 h-3 text-white"})}),(0,b.jsx)("span",{onClick:()=>k(a),className:`text-sm flex-1 truncate ${"done"===a.status?"text-slate-500 line-through":"text-slate-200"}`,children:a.title}),"done"!==a.status&&(0,b.jsx)("button",{onClick:b=>{b.stopPropagation(),k(a),j()},className:"opacity-0 group-hover:opacity-100 p-1 hover:bg-blue-500/20 rounded",title:"Focus on this",children:(0,b.jsx)(i,{className:"w-3 h-3 text-blue-400"})})]},a.id)),a.length>5&&(0,b.jsxs)(L.default,{href:"/planner",className:"block text-center text-xs text-slate-400 hover:text-blue-400 py-1",children:["+",a.length-5," more"]})]})]}),(0,b.jsxs)(u.Card,{className:"p-4 bg-slate-800/40 border-slate-700/50",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,b.jsx)("span",{className:"text-sm font-medium text-slate-300",children:"Daily Habits"}),(0,b.jsx)(L.default,{href:"/habits",className:"text-xs text-blue-400 hover:text-blue-300",children:"Manage â†’"})]}),0===e.length?(0,b.jsxs)("div",{className:"py-4 text-center",children:[(0,b.jsx)("p",{className:"text-slate-500 text-sm mb-3",children:"Build consistency"}),(0,b.jsxs)(r.Button,{size:"sm",variant:"outline",className:"text-xs h-8",onClick:()=>o.push("/habits"),children:[(0,b.jsx)(H.Plus,{className:"w-3 h-3 mr-1"}),"Add first habit"]})]}):(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,b.jsx)("div",{className:"flex-1 h-2 bg-slate-700 rounded-full overflow-hidden",children:(0,b.jsx)("div",{className:"h-full bg-gradient-to-r from-orange-500 to-yellow-500 transition-all duration-500",style:{width:`${t>0?s/t*100:0}%`}})}),(0,b.jsxs)("span",{className:"text-xs text-slate-400 font-mono",children:[s,"/",t]})]}),(0,b.jsx)("div",{className:"flex flex-wrap gap-2",children:e.map(a=>{let c=a.completions?.some(a=>a.date===p&&a.completed);return(0,b.jsxs)("button",{onClick:()=>m(a.id),className:`px-3 py-1.5 rounded-full text-xs font-medium transition-all ${c?"bg-green-500/20 text-green-400 border border-green-500/30":"bg-slate-700/50 text-slate-300 border border-slate-600 hover:border-orange-500/50"}`,children:[c&&(0,b.jsx)(G,{className:"w-3 h-3 inline mr-1"}),a.name]},a.id)})}),v>0&&(0,b.jsxs)("p",{className:"text-xs text-slate-500 mt-2",children:[v," remaining â€¢ Keep going!"]})]})]})]}),c.length>0&&(0,b.jsxs)("div",{className:"flex items-center gap-4 p-3 rounded-lg bg-slate-800/30 border border-slate-700/30",children:[(0,b.jsx)(F.Calendar,{className:"w-4 h-4 text-blue-400 flex-shrink-0"}),(0,b.jsx)("div",{className:"flex-1 flex items-center gap-4 overflow-x-auto",children:c.slice(0,3).map(a=>(0,b.jsxs)("div",{className:"flex items-center gap-2 text-sm whitespace-nowrap",children:[(0,b.jsx)("span",{className:"text-slate-500 font-mono text-xs",children:new Date(a.startTime).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}),(0,b.jsx)("span",{className:"text-slate-300",children:a.title})]},a.id))}),(0,b.jsx)(L.default,{href:"/calendar",className:"text-xs text-blue-400 hover:text-blue-300 flex-shrink-0",children:"Calendar â†’"})]})]})}var N=a.i(50429),O=a.i(96221),P=a.i(42211),Q=a.i(79790);class R{context;cache;CACHE_DURATION=3e5;constructor(a){this.context=a,this.cache=new Map}updateContext(a){this.context={...this.context,...a},this.cache.clear()}getRecommendations(a=5){let b=this.getCacheKey(),c=this.cache.get(b);if(c&&Date.now()-c.timestamp<this.CACHE_DURATION)return c.recommendations.slice(0,a);let d=this.calculateRecommendations().sort((a,b)=>b.score-a.score).slice(0,a);return this.cache.set(b,{recommendations:d,timestamp:Date.now()}),d}getCacheKey(){let{tasks:a,habits:b,dailyStats:c,currentTime:d}=this.context;return`${a.length}-${b.length}-${c?.totalStudyMinutes||0}-${d.getHours()}`}calculateRecommendations(){let a=[];return a.push(...this.generateTaskRecommendations()),a.push(...this.generateHabitRecommendations()),a.push(...this.generateStudyPlanningRecommendations()),a.push(...this.generateFocusRecommendations()),a}generateTaskRecommendations(){let a=[],b=this.context.currentTime;for(let c of(b.getFullYear(),b.getMonth(),b.getDate(),this.context.tasks)){if("done"===c.status)continue;let d=c.dueDate?new Date(c.dueDate):null,e=this.calculateUrgency(d,b),f=this.calculateTaskImportance(c),g=this.calculateStreakImpact(c),h=.4*e+.4*f+.2*g;if(h>.3){let b=[];e>.7&&b.push("Due soon"),f>.7&&b.push("High priority"),g>.5&&b.push("Maintains study streak"),a.push({id:`task-${c.id}`,type:"task",title:`Complete: ${c.title}`,description:c.description||"Focus on this important task",score:h,urgency:e,importance:f,streakImpact:g,reasoning:b,action:{type:"navigate",data:{path:"/planner",filter:"task",taskId:c.id}}})}}return a}generateHabitRecommendations(){let a=[],b=this.context.currentTime,c=new Date(b.getFullYear(),b.getMonth(),b.getDate());for(let b of this.context.habits){if(b.completions.filter(a=>a.date===c.toISOString().split("T")[0]&&a.completed).length>0)continue;let d=b.currentStreak>0?Math.min(b.currentStreak/7,1):0,e="daily"===b.frequency?.8:.6,f=this.calculateHabitUrgency(b,c),g=.3*f+.3*e+.4*d;if(g>.4){let c=[];d>.7&&c.push(`${b.currentStreak} day streak at risk`),f>.8&&c.push("Due today"),e>.7&&c.push("Daily habit"),a.push({id:`habit-${b.id}`,type:"habit",title:`Complete: ${b.name}`,description:b.description||"Build consistency with this habit",score:g,urgency:f,importance:e,streakImpact:d,reasoning:c,action:{type:"toggle_habit",data:{habitId:b.id}}})}}return a}generateStudyPlanningRecommendations(){let a=[],{dailyStats:b,tasks:c,currentTime:d}=this.context,e=b?.totalStudyMinutes||0;if(e<60){let b=Math.max(0,1-e/120),c=this.context.userStreak?Math.min(this.context.userStreak/30,1):0;a.push({id:"study-planning-today",type:"study_planning",title:"Plan study session for today",description:`You've studied ${Math.round(e/60*10)/10}h today. Aim for 2h total.`,score:.4*b+.32000000000000006+.2*c,urgency:b,importance:.8,streakImpact:c,reasoning:[0===e?"No study time logged today":"Below daily study target","Consistent study builds better retention"],action:{type:"navigate",data:{path:"/planner",action:"schedule_study"}}})}let f=c.filter(a=>{if(!a.dueDate)return!1;let b=Math.ceil((new Date(a.dueDate).getTime()-d.getTime())/864e5);return b<=7&&b>0});return f.length>0&&a.push({id:"upcoming-deadlines",type:"study_planning",title:"Review upcoming deadlines",description:`${f.length} task${f.length>1?"s":""} due in the next week`,score:.7,urgency:.6,importance:.8,streakImpact:.3,reasoning:["Prepare ahead for better performance",`${f.length} deadline${f.length>1?"s":""} approaching`],action:{type:"navigate",data:{path:"/planner",filter:"upcoming"}}}),a}generateFocusRecommendations(){let a=[],{dailyStats:b,currentTime:c}=this.context,d=b?.totalStudyMinutes||0;return b?.pomodoroCompleted,d<180&&a.push({id:"focus-session",type:"focus_session",title:"Start a focus session",description:"25 minutes of deep, distraction-free work",score:.56,urgency:.5,importance:.7,streakImpact:.4,reasoning:["Ready for focused work","Deep work sessions improve learning efficiency"],action:{type:"start_focus",data:{duration:25}}}),a}calculateUrgency(a,b){if(!a)return .3;let c=(a.getTime()-b.getTime())/36e5;return c<0?1:c<=24?.9:c<=72?.7:c<=168?.5:.2}calculateTaskImportance(a){let b=.5;switch(a.priority){case"urgent":b+=.3;break;case"high":b+=.2;break;case"medium":b+=.1}return a.course&&(b+=.05),Math.min(b,1)}calculateStreakImpact(a){let b=this.context.userStreak||0;return b>0?Math.min(b/10,.5):0}calculateHabitUrgency(a,b){let c=b.toISOString().split("T")[0];if(a.completions.some(a=>a.date===c&&a.completed))return 0;let d="daily"===a.frequency?.8:.6;return Math.min(d+=Math.min(a.currentStreak/7,.2),1)}}let S=null;var T=a.i(54816);function U({onStartFocus:a}){let[d,e]=(0,c.useState)(null),[f,h]=(0,c.useState)(!0),{user:j}=(0,Q.useAuth)();(0,c.useEffect)(()=>{j?k():h(!1)},[j]);let k=async()=>{if(j)try{var a;h(!0);let b=await (0,g.getUserData)(j.uid),c=(a={tasks:b.tasks||[],courses:b.courses||[],habits:b.habits||[],dailyStats:b.dailyStats||void 0,currentTime:new Date,userStreak:b.userStreak||0},S?S.updateContext(a):S=new R(a),S).getRecommendations(1);e(c[0]||null)}catch(a){console.error("Failed to load recommendations:",a)}finally{h(!1)}},l=d||{id:"default-focus",type:"focus_session",title:"Start a 25-min focus session",description:"Build momentum with deep work â€” the best way to make progress.",action:{type:"start_focus"},score:.9,urgency:.8,importance:.9,streakImpact:.7,reasoning:["Focus sessions build consistency","Best time for deep work"]},m="start_focus"===l.action.type||"focus_session"===l.type,n="navigate"===l.action.type&&l.action.data?.path;if(f)return(0,b.jsx)("div",{className:"p-4 rounded-xl bg-gradient-to-br from-green-900/20 to-emerald-900/10 border border-green-500/20",children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)(O.Loader2,{className:"w-5 h-5 animate-spin text-green-400"}),(0,b.jsx)("span",{className:"text-sm text-slate-400",children:"Finding your best next move..."})]})});let o=(0,b.jsx)("div",{className:"p-4 rounded-xl bg-gradient-to-br from-green-900/20 to-emerald-900/10 border border-green-500/30 hover:border-green-400/50 transition-all",children:(0,b.jsxs)("div",{className:"flex items-start gap-4",children:[(0,b.jsx)("div",{className:"w-10 h-10 rounded-xl bg-green-500/20 flex items-center justify-center flex-shrink-0",children:(0,b.jsx)(I.Sparkles,{className:"w-5 h-5 text-green-400"})}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,b.jsx)("span",{className:"text-xs font-medium text-green-400 uppercase tracking-wide",children:"Next Best Action"}),(0,b.jsx)(T.TooltipProvider,{children:(0,b.jsxs)(T.Tooltip,{children:[(0,b.jsx)(T.TooltipTrigger,{asChild:!0,children:(0,b.jsx)("button",{className:"text-slate-500 hover:text-slate-300",children:(0,b.jsx)(P.HelpCircle,{className:"w-3.5 h-3.5"})})}),(0,b.jsx)(T.TooltipContent,{side:"top",className:"max-w-xs",children:(0,b.jsxs)("p",{className:"text-xs",children:[(0,b.jsx)("strong",{children:"Why this?"}),(0,b.jsx)("br",{}),l.reasoning?.slice(0,2).join(" â€¢ ")||"AI-ranked based on your goals and habits."]})})]})})]}),(0,b.jsx)("p",{className:"text-slate-200 font-medium mb-2",children:l.description||l.title}),(0,b.jsx)(r.Button,{size:"sm",onClick:m?a:void 0,className:"bg-green-600 hover:bg-green-500 text-white gap-2",children:m?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(i,{className:"w-4 h-4"}),"Start Focus"]}):"flashcard_review"===l.type?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(J.BookOpen,{className:"w-4 h-4"}),"Review Cards"]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(N.Target,{className:"w-4 h-4"}),l.title.split(" ").slice(0,2).join(" ")]})})]})]})});return n&&!m?(0,b.jsx)(L.default,{href:l.action.data.path,children:o}):o}var V=a.i(16106),W=a.i(83077);a.i(69387);var X=a.i(60574);function Y(){let{user:a}=(0,Q.useAuth)(),[d,e]=(0,c.useState)({currentStreak:0,longestStreak:0,totalDays:0,lastActiveDate:"",milestones:[]}),[g,h]=(0,c.useState)(!0),[i,j]=(0,c.useState)(!1);(0,c.useEffect)(()=>{a&&k()},[a]);let k=async()=>{if(a)try{let b=(0,X.doc)(f.db,"streaks",a.uid),c=await (0,X.getDoc)(b);if(c.exists()){let a=c.data();e(a),await l(a)}else{let a={currentStreak:0,longestStreak:0,totalDays:0,lastActiveDate:"",milestones:[]};await (0,X.setDoc)(b,a),e(a)}}catch(a){console.error("Error loading streak:",a)}finally{h(!1)}},l=async b=>{if(!a)return;let c=new Date().toDateString(),d=new Date(b.lastActiveDate).toDateString();if(c===d)return;let g=new Date;g.setDate(g.getDate()-1);let h=g.toDateString(),i=b.currentStreak;d===h?i=b.currentStreak+1:(b.lastActiveDate,i=1);let k=Math.max(i,b.longestStreak),l=b.totalDays+1,m=[...b.milestones];for(let a of[7,30,60,100,365])i!==a||m.includes(a)||(m.push(a),j(!0),setTimeout(()=>j(!1),5e3));let n={currentStreak:i,longestStreak:k,totalDays:l,lastActiveDate:c,milestones:m},o=(0,X.doc)(f.db,"streaks",a.uid);await (0,X.setDoc)(o,n),e(n)},m=()=>[7,30,60,100,365].find(a=>a>d.currentStreak)||365;return g||0===d.currentStreak&&0===d.totalDays?null:(0,b.jsxs)("div",{className:"relative flex items-center justify-between p-3 rounded-lg bg-gradient-to-r from-orange-500/10 to-red-500/5 border border-orange-500/20",children:[i&&(0,b.jsxs)("div",{className:"absolute inset-0 bg-gradient-to-r from-orange-500/20 to-yellow-500/20 animate-pulse rounded-lg flex items-center justify-center",children:[(0,b.jsx)(W.Trophy,{className:"w-5 h-5 text-yellow-500 animate-bounce mr-2"}),(0,b.jsx)("span",{className:"text-yellow-400 font-medium",children:"New Milestone!"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(V.Flame,{className:"w-4 h-4 text-orange-500"}),(0,b.jsxs)("span",{className:"text-sm font-medium text-orange-400",children:[d.currentStreak,"-day streak"]}),7>=m()-d.currentStreak&&(0,b.jsxs)("span",{className:"text-xs text-slate-500",children:["â€¢ ",m()-d.currentStreak,"d to ",m(),"-day milestone"]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-3 text-xs text-slate-500",children:[(0,b.jsxs)("span",{children:["Best: ",d.longestStreak]}),(0,b.jsxs)("span",{children:["Total: ",d.totalDays]})]})]})}let Z=(0,h.default)("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);var $=a.i(4975);let _=(0,h.default)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);var aa=a.i(92e3),ab=a.i(53250);function ac({onBackendStatusChange:a}){let[d,e]=(0,c.useState)(null),[f,g]=(0,c.useState)(!0),[h,i]=(0,c.useState)(!1);(0,c.useEffect)(()=>{j();let a=setInterval(j,3e4);return()=>clearInterval(a)},[]),(0,c.useEffect)(()=>{a&&a(d?.status==="healthy")},[d,a]);let j=async()=>{try{let a=await (0,ab.checkHealth)();e(a)}catch{e(null)}finally{g(!1)}},k=async()=>{i(!0),await j(),i(!1)};if(f)return(0,b.jsxs)("div",{className:"flex items-center gap-2 text-slate-500 text-sm",children:[(0,b.jsx)("div",{className:"w-2 h-2 rounded-full bg-slate-600 animate-pulse"}),(0,b.jsx)("span",{children:"Checking AI services..."})]});if(!d)return(0,b.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-lg bg-red-500/10 border border-red-500/20",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(aa.AlertCircle,{className:"w-4 h-4 text-red-400"}),(0,b.jsx)("span",{className:"text-sm text-red-400",children:"AI Offline"}),(0,b.jsx)("span",{className:"text-xs text-slate-500",children:"â€¢ Start backend for AI features"})]}),(0,b.jsx)(r.Button,{size:"sm",variant:"ghost",onClick:k,disabled:h,className:"text-slate-400 hover:text-white h-7 px-2",children:(0,b.jsx)(_,{className:`w-3.5 h-3.5 ${h?"animate-spin":""}`})})]});let l=d.services,m=l.qdrant?.connected&&l.ollama?.connected;return(0,b.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-lg bg-slate-800/30 border border-slate-700/30",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,b.jsx)("div",{className:`w-2 h-2 rounded-full ${m?"bg-green-500":"bg-yellow-500"}`}),(0,b.jsx)("span",{className:"text-sm text-slate-400",children:"AI"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-3 text-xs",children:[(0,b.jsxs)("span",{className:`flex items-center gap-1 ${l.qdrant?.connected?"text-slate-400":"text-red-400"}`,children:[(0,b.jsx)(Z,{className:"w-3 h-3"}),"Memory"]}),(0,b.jsxs)("span",{className:`flex items-center gap-1 ${l.ollama?.connected?"text-slate-400":"text-red-400"}`,children:[(0,b.jsx)(q.Brain,{className:"w-3 h-3"}),"Models"]}),(0,b.jsxs)("span",{className:`flex items-center gap-1 ${l.whisper?.loaded?"text-slate-400":"text-slate-600"}`,children:[(0,b.jsx)($.Mic,{className:"w-3 h-3"}),"Voice"]})]})]}),(0,b.jsx)(r.Button,{size:"sm",variant:"ghost",onClick:k,disabled:h,className:"text-slate-500 hover:text-white h-7 px-2",children:(0,b.jsx)(_,{className:`w-3.5 h-3.5 ${h?"animate-spin":""}`})})]})}var ad=a.i(53069),ae=a.i(16780),af=a.i(23292);function ag(){let a=(0,d.useRouter)(),[h,i]=(0,c.useState)(null),[j,k]=(0,c.useState)(!0),[l,m]=(0,c.useState)([]),[n,o]=(0,c.useState)([]),[p,q]=(0,c.useState)(null),[r,s]=(0,c.useState)([]),[t,u]=(0,c.useState)(!1),[v,w]=(0,c.useState)(null),{tasks:x,toggleTask:y}=(0,ae.usePersistentTasks)();(0,c.useEffect)(()=>{let b=(0,e.onAuthStateChanged)(f.auth,async b=>{i(b),b?await z(b.uid):a.push("/login"),k(!1)});return()=>b()},[a,x]);let z=async a=>{try{let b=new Date,c=b.toISOString().split("T")[0],d=new Date(b);d.setHours(23,59,59,999);let[e,f,h,i]=await Promise.all([(0,g.getCalendarEvents)(a,{start:b,end:d}),(0,g.getHabits)(a),(0,g.getDailyStats)(a,c),(0,g.getCourses)(a)]);m(e.slice(0,4)),o(f),q(h),s(i);let j=x.filter(a=>"done"!==a.status&&(a.scheduledDate?.toDateString()===b.toDateString()||a.dueDate?.toDateString()===b.toDateString()||"urgent"===a.priority)).slice(0,5),k=j.find(a=>"in-progress"===a.status)||j[0];k&&w(k)}catch(a){console.error("Error loading dashboard:",a)}},A=x.filter(a=>a.scheduledDate?.toDateString()===new Date().toDateString()||a.dueDate?.toDateString()===new Date().toDateString()||"urgent"===a.priority).slice(0,8),B=async(a,b)=>{try{await y(a,b),af.toast.success(b?"Task completed! ðŸŽ‰":"Task reopened")}catch{af.toast.error("Failed to update task")}},C=async a=>{if(h)try{await (0,g.toggleHabitCompletion)(h.uid,a);let b=await (0,g.getHabits)(h.uid);o(b);let c=n.find(b=>b.id===a),d=new Date().toISOString().split("T")[0],e=c?.completions?.some(a=>a.date===d&&a.completed);af.toast.success(e?"Habit unchecked":"Habit completed! ðŸ’ª")}catch(a){console.error("Error toggling habit:",a),af.toast.error("Failed to update habit")}};return j?(0,b.jsx)("div",{className:"min-h-screen bg-background flex items-center justify-center",children:(0,b.jsx)("div",{className:"animate-spin w-8 h-8 border-2 border-primary border-t-transparent rounded-full"})}):(0,b.jsxs)(E.default,{title:"Dashboard",subtitle:"Your study command center â€“ track progress, start sessions, and get AI-powered insights",children:[(0,b.jsx)(M,{tasks:A,events:l,habits:n,focusMinutes:p?.totalStudyMinutes||0,targetMinutes:120,flashcardsDue:0,onStartFocus:()=>u(!0),onTaskClick:w,onTaskToggle:B,onHabitToggle:C}),(0,b.jsx)("div",{className:"mt-4",children:(0,b.jsx)(Y,{})}),(0,b.jsx)("div",{className:"mt-4",children:(0,b.jsx)(U,{onStartFocus:()=>u(!0)})}),(0,b.jsx)("div",{className:"mt-4",children:(0,b.jsx)(ac,{})}),(0,b.jsx)(ad.JarvisAssistant,{context:{currentPage:"dashboard",todayTasks:A,courses:r,habits:n,dailyStats:p||void 0}}),t&&(0,b.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:(0,b.jsx)("div",{className:"bg-slate-800 rounded-xl border border-slate-700 shadow-2xl max-w-md w-full max-h-[90vh] overflow-y-auto",children:(0,b.jsx)(D,{task:v,onClose:()=>u(!1)})})})]})}a.s(["default",()=>ag],20731)}];

//# sourceMappingURL=app_dashboard_page_tsx_42ef5b16._.js.map