(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,78928,e=>{"use strict";var t=e.i(43476),s=e.i(71645),a=e.i(18566);e.i(51718);var r=e.i(18357),n=e.i(76009),l=e.i(71898),i=e.i(75254);let o=(0,i.default)("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]),c=(0,i.default)("Pause",[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]]);var d=e.i(67240),u=e.i(39616),m=e.i(37727);let x=(0,i.default)("Volume2",[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]]),h=(0,i.default)("VolumeX",[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15",key:"1ewh16"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15",key:"5ykzw1"}]]);var p=e.i(96139),g=e.i(55711),f=e.i(67881),b=e.i(94433),j=e.i(96556),k=e.i(70065);let y=(0,i.default)("Waves",[["path",{d:"M2 6c.6.5 1.2 1 2.5 1C7 7 7 5 9.5 5c2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"knzxuh"}],["path",{d:"M2 12c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"2jd2cc"}],["path",{d:"M2 18c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"rd2r6e"}]]),N=(0,i.default)("CloudRain",[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M16 14v6",key:"1j4efv"}],["path",{d:"M8 14v6",key:"17c4r9"}],["path",{d:"M12 16v6",key:"c8a4gj"}]]),w=(0,i.default)("Wind",[["path",{d:"M17.7 7.7a2.5 2.5 0 1 1 1.8 4.3H2",key:"1k4u03"}],["path",{d:"M9.6 4.6A2 2 0 1 1 11 8H2",key:"b7d0fd"}],["path",{d:"M12.6 19.4A2 2 0 1 0 14 16H2",key:"1p5cb3"}]]),v=(0,i.default)("Music",[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]]),S=(0,i.default)("BellOff",[["path",{d:"M8.7 3A6 6 0 0 1 18 8a21.3 21.3 0 0 0 .6 5",key:"o7mx20"}],["path",{d:"M17 17H3s3-2 3-9a4.67 4.67 0 0 1 .3-1.7",key:"16f1lm"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);var D=e.i(45423);function C({isActive:e}){let[a,r]=(0,s.useState)("none"),[n,l]=(0,s.useState)(.3),[i,o]=(0,s.useState)(!1),c=(0,s.useRef)(null);(0,s.useEffect)(()=>(c.current=new Audio,c.current.loop=!0,c.current.volume=n,()=>{c.current&&(c.current.pause(),c.current=null)}),[]),(0,s.useEffect)(()=>{c.current&&e&&("none"===a?c.current.pause():console.log(`Would play: ${{"coffee-shop":"/sounds/coffee-shop.mp3",rain:"/sounds/rain.mp3",ocean:"/sounds/ocean.mp3","white-noise":"/sounds/white-noise.mp3","lo-fi":"/sounds/lo-fi.mp3"}[a]}`))},[a,e]),(0,s.useEffect)(()=>{c.current&&(c.current.volume=n)},[n]),(0,s.useEffect)(()=>{i&&1?document.title="ðŸ”´ Focus Mode - Do Not Disturb":document.title="StudyPal"},[i]);let d=[{id:"none",label:"Silence",icon:h,color:"gray"},{id:"coffee-shop",label:"Coffee Shop",icon:p.Coffee,color:"amber"},{id:"rain",label:"Rain",icon:N,color:"blue"},{id:"ocean",label:"Ocean",icon:y,color:"cyan"},{id:"white-noise",label:"White Noise",icon:w,color:"slate"},{id:"lo-fi",label:"Lo-Fi Beats",icon:v,color:"purple"}];return e?(0,t.jsx)(k.Card,{className:"p-4 bg-gradient-to-br from-purple-500/5 to-pink-500/5 border-purple-500/20",children:(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(x,{className:"w-4 h-4 text-purple-500"}),(0,t.jsx)("h4",{className:"font-semibold",children:"Ambient Sounds"})]}),(0,t.jsxs)("button",{onClick:()=>o(!i),className:`flex items-center gap-1 px-3 py-1 rounded-full text-xs font-medium transition-all ${i?"bg-red-500 text-white":"bg-gray-100 dark:bg-gray-800 text-muted-foreground hover:bg-gray-200 dark:hover:bg-gray-700"}`,children:[i?(0,t.jsx)(S,{className:"w-3 h-3"}):(0,t.jsx)(D.Bell,{className:"w-3 h-3"}),i?"DND On":"DND Off"]})]}),(0,t.jsx)("div",{className:"grid grid-cols-3 gap-2",children:d.map(e=>{let s=e.icon,n=a===e.id;return(0,t.jsxs)("button",{onClick:()=>r(e.id),className:`flex flex-col items-center gap-1 p-3 rounded-lg border transition-all ${n?`bg-${e.color}-500/10 border-${e.color}-500 text-${e.color}-500`:"bg-background border-border hover:border-gray-400"}`,children:[(0,t.jsx)(s,{className:"w-5 h-5"}),(0,t.jsx)("span",{className:"text-xs font-medium",children:e.label})]},e.id)})}),"none"!==a&&(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between text-xs text-muted-foreground",children:[(0,t.jsx)("span",{children:"Volume"}),(0,t.jsxs)("span",{children:[Math.round(100*n),"%"]})]}),(0,t.jsx)("input",{type:"range",min:"0",max:"100",value:100*n,onChange:e=>l(Number(e.target.value)/100),className:"w-full h-2 bg-gray-200 dark:bg-gray-800 rounded-lg appearance-none cursor-pointer accent-purple-500"})]}),i&&(0,t.jsx)("div",{className:"pt-2 border-t border-purple-500/20",children:(0,t.jsxs)("p",{className:"text-xs text-muted-foreground flex items-center gap-2",children:[(0,t.jsx)(S,{className:"w-3 h-3"}),"Do Not Disturb is active. Browser notifications are suppressed."]})})]})}):null}let T={workDuration:25,shortBreakDuration:5,longBreakDuration:15,sessionsBeforeLongBreak:4,autoStartBreaks:!0,autoStartWork:!1,soundEnabled:!0,notificationsEnabled:!0};function B({task:e,onClose:a,compact:r=!1,onSessionComplete:n}){let{user:i}=(0,b.useAuthContext)(),[k,y]=(0,s.useState)(T),[N,w]=(0,s.useState)(!1),[v,S]=(0,s.useState)("work"),[D,B]=(0,s.useState)(60*T.workDuration),[M,A]=(0,s.useState)(!1),[$,E]=(0,s.useState)(0),[I,R]=(0,s.useState)(0),[F,P]=(0,s.useState)(0),z=(0,s.useRef)(null),H=(0,s.useRef)(null),[L,O]=(0,s.useState)(null);(0,s.useEffect)(()=>{i&&((0,l.getPomodoroSettings)(i.uid).then(e=>{e&&(y(e),B(60*e.workDuration))}),(0,j.generatePersonalizedContent)({learningStyle:"visual",goals:["Improve focus","Complete tasks efficiently"],currentLevel:"intermediate",preferredSubjects:["Study","Work"]},"productivity techniques","explanation").then(e=>{O({optimalWorkTime:"9:00 AM - 11:00 AM",recommendedBreakActivity:"Take a 5-minute walk or do stretching exercises",productivityTips:["Maintain consistent sleep schedule","Stay hydrated during work sessions","Use the 2-minute rule for small tasks"]})}).catch(()=>{O({optimalWorkTime:"Morning hours",recommendedBreakActivity:"Light exercise or meditation",productivityTips:["Stay focused","Take regular breaks","Track progress"]})}))},[i]),(0,s.useEffect)(()=>{let e=null;return M&&D>0?e=setInterval(()=>{B(e=>e-1)},1e3):0===D&&X(),()=>{e&&clearInterval(e)}},[M,D]);let[q,W]=(0,s.useState)(!1),[_,U]=(0,s.useState)(""),V=(0,s.useRef)(null),K=(0,s.useRef)(null);(0,s.useEffect)(()=>{"Notification"in window&&"default"===Notification.permission&&Notification.requestPermission()},[]),(0,s.useEffect)(()=>{let e=()=>{try{K.current=new(window.AudioContext||window.webkitAudioContext)}catch(e){console.warn("Audio context not supported")}document.removeEventListener("click",e),document.removeEventListener("keydown",e)};return document.addEventListener("click",e),document.addEventListener("keydown",e),()=>{document.removeEventListener("click",e),document.removeEventListener("keydown",e)}},[]);let Y=(0,s.useCallback)(()=>{if(k.soundEnabled)try{if(K.current){let e=K.current,t=e.createOscillator(),s=e.createGain();t.connect(s),s.connect(e.destination),t.frequency.setValueAtTime(800,e.currentTime),t.frequency.setValueAtTime(600,e.currentTime+.1),s.gain.setValueAtTime(.3,e.currentTime),s.gain.exponentialRampToValueAtTime(.01,e.currentTime+.5),t.start(e.currentTime),t.stop(e.currentTime+.5)}else z.current&&z.current.play().catch(()=>{})}catch(e){console.warn("Audio playback failed:",e)}},[k.soundEnabled]),G=(0,s.useCallback)(e=>{U(e),W(!0),V.current&&clearTimeout(V.current),V.current=setTimeout(()=>{W(!1)},5e3)},[]),X=(0,s.useCallback)(async()=>{if(A(!1),Y(),k.notificationsEnabled&&"Notification"in window)if("granted"===Notification.permission){let e=new Notification("work"===v?"ðŸŽ‰ Focus Session Complete!":"â˜• Break Time Over!",{body:"work"===v?`Great work! Take a ${$+1>=k.sessionsBeforeLongBreak?"long":"short"} break.`:"Time to get back to work!",icon:"/icon.svg",badge:"/icon.svg",requireInteraction:!0,silent:!1});setTimeout(()=>e.close(),1e4)}else"default"===Notification.permission&&Notification.requestPermission();if(G("work"===v?`ðŸŽ‰ Session Complete! ${$+1>=k.sessionsBeforeLongBreak?"Long break time!":"Short break earned!"}`:"âš¡ Break's over! Ready to focus?"),i&&H.current&&"work"===v){let t=k.workDuration,s={userId:i.uid,startTime:H.current,endTime:new Date,plannedDuration:t,actualDuration:t,type:v,completed:!0,interrupted:!1};e?.id&&(s.taskId=e.id),e?.course&&(s.course=e.course),await (0,l.logPomodoroSession)(s),R(e=>e+t),E(e=>e+1),P(e=>e+1),n?.({duration:t,type:"work"})}if("work"===v){let e=($+1)%k.sessionsBeforeLongBreak==0?"long-break":"short-break";S(e),B("long-break"===e?60*k.longBreakDuration:60*k.shortBreakDuration),k.autoStartBreaks&&setTimeout(()=>{A(!0),H.current=new Date},1e3)}else S("work"),B(60*k.workDuration),k.autoStartWork&&setTimeout(()=>{A(!0),H.current=new Date},1e3)},[v,k,$,i,e,n]),J=()=>{!M&&(H.current=new Date,k.notificationsEnabled&&"Notification"in window&&"default"===Notification.permission&&Notification.requestPermission()),A(!M)},Q=()=>{A(!1),B("work"===v?60*k.workDuration:"short-break"===v?60*k.shortBreakDuration:60*k.longBreakDuration),H.current=null},Z=async e=>{let t={...k,...e};y(t),i&&await (0,l.savePomodoroSettings)({...t,userId:i.uid}),!M&&(e.workDuration&&"work"===v&&B(60*e.workDuration),e.shortBreakDuration&&"short-break"===v&&B(60*e.shortBreakDuration),e.longBreakDuration&&"long-break"===v&&B(60*e.longBreakDuration))},ee=e=>{let t=Math.floor(e/60);return`${t.toString().padStart(2,"0")}:${(e%60).toString().padStart(2,"0")}`},et="work"===v?1-D/(60*k.workDuration):"short-break"===v?1-D/(60*k.shortBreakDuration):1-D/(60*k.longBreakDuration),es=()=>{switch(v){case"work":return"from-red-500 to-orange-500";case"short-break":return"from-green-500 to-emerald-500";case"long-break":return"from-blue-500 to-cyan-500"}};return r?(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("audio",{ref:z,src:"/notification.mp3",preload:"auto"}),(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(()=>{switch(v){case"work":return(0,t.jsx)(g.Brain,{className:"w-5 h-5"});case"short-break":case"long-break":return(0,t.jsx)(p.Coffee,{className:"w-5 h-5"})}})(),(0,t.jsx)("span",{className:"text-sm font-medium capitalize",children:v.replace("-"," ")})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("button",{onClick:()=>Z({soundEnabled:!k.soundEnabled}),className:"p-1 hover:bg-slate-700 rounded",children:k.soundEnabled?(0,t.jsx)(x,{className:"w-4 h-4"}):(0,t.jsx)(h,{className:"w-4 h-4"})}),a&&(0,t.jsx)("button",{onClick:a,className:"p-1 hover:bg-slate-700 rounded",children:(0,t.jsx)(m.X,{className:"w-4 h-4"})})]})]}),(0,t.jsxs)("div",{className:"text-center mb-4",children:[(0,t.jsx)("div",{className:"text-4xl font-mono font-bold text-slate-100 mb-2",children:ee(D)}),(0,t.jsx)("div",{className:"h-2 bg-muted rounded-full overflow-hidden",children:(0,t.jsx)("div",{className:`h-full bg-gradient-to-r ${es()} transition-all duration-1000`,style:{width:`${100*et}%`}})})]}),(0,t.jsxs)("div",{className:"flex justify-center gap-3",children:[(0,t.jsx)(f.Button,{size:"sm",variant:"outline",onClick:Q,children:(0,t.jsx)(d.RotateCcw,{className:"w-4 h-4"})}),(0,t.jsx)(f.Button,{size:"sm",onClick:J,className:`bg-gradient-to-r ${es()} text-white`,children:M?(0,t.jsx)(c,{className:"w-4 h-4"}):(0,t.jsx)(o,{className:"w-4 h-4"})})]}),(0,t.jsxs)("div",{className:"flex justify-center gap-4 mt-4 text-xs text-slate-400",children:[(0,t.jsxs)("span",{children:[$," sessions"]}),(0,t.jsx)("span",{children:"â€¢"}),(0,t.jsxs)("span",{children:[Math.round(I)," min focused"]}),(0,t.jsx)("span",{children:"â€¢"}),(0,t.jsxs)("span",{children:[F," day streak"]})]})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("audio",{ref:z,src:"/notification.mp3",preload:"auto"}),(0,t.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold text-slate-100",children:"Focus Timer"}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("button",{onClick:()=>w(!N),className:"p-2 hover:bg-slate-700 rounded-lg transition-colors",children:(0,t.jsx)(u.Settings,{className:"w-5 h-5"})}),a&&(0,t.jsx)("button",{onClick:a,className:"p-2 hover:bg-slate-700 rounded-lg transition-colors",children:(0,t.jsx)(m.X,{className:"w-5 h-5"})})]})]}),e&&(0,t.jsxs)("div",{className:"mb-6 p-4 rounded-xl bg-card border border-border",children:[(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Working on:"}),(0,t.jsx)("p",{className:"font-medium text-foreground",children:e.title})]}),(0,t.jsx)("div",{className:"flex gap-2 mb-6",children:[{id:"work",label:"Focus",icon:g.Brain},{id:"short-break",label:"Short Break",icon:p.Coffee},{id:"long-break",label:"Long Break",icon:p.Coffee}].map(({id:e,label:s,icon:a})=>(0,t.jsxs)("button",{onClick:()=>{A(!1),S(e),B("work"===e?60*k.workDuration:"short-break"===e?60*k.shortBreakDuration:60*k.longBreakDuration)},className:`flex-1 flex items-center justify-center gap-2 py-2 px-3 rounded-lg text-sm font-medium transition-colors ${v===e?`bg-gradient-to-r ${"work"===e?"from-red-500 to-orange-500":"short-break"===e?"from-green-500 to-emerald-500":"from-blue-500 to-cyan-500"} text-white`:"bg-slate-700 text-slate-400 hover:text-slate-100"}`,children:[(0,t.jsx)(a,{className:"w-4 h-4"}),(0,t.jsx)("span",{className:"text-xs sm:text-sm",children:s})]},e))}),(0,t.jsx)("div",{className:"flex justify-center mb-8",children:(0,t.jsxs)("div",{className:"relative w-64 h-64",children:[(0,t.jsxs)("svg",{className:"w-full h-full transform -rotate-90",children:[(0,t.jsx)("circle",{cx:"128",cy:"128",r:"120",fill:"none",stroke:"currentColor",strokeWidth:"8",className:"text-muted"}),(0,t.jsx)("circle",{cx:"128",cy:"128",r:"120",fill:"none",stroke:"url(#gradient)",strokeWidth:"8",strokeLinecap:"round",strokeDasharray:2*Math.PI*120,strokeDashoffset:2*Math.PI*120*(1-et),className:"transition-all duration-1000"}),(0,t.jsx)("defs",{children:(0,t.jsxs)("linearGradient",{id:"gradient",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:["work"===v&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("stop",{offset:"0%",stopColor:"#ef4444"}),(0,t.jsx)("stop",{offset:"100%",stopColor:"#f97316"})]}),"short-break"===v&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("stop",{offset:"0%",stopColor:"#22c55e"}),(0,t.jsx)("stop",{offset:"100%",stopColor:"#10b981"})]}),"long-break"===v&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("stop",{offset:"0%",stopColor:"#3b82f6"}),(0,t.jsx)("stop",{offset:"100%",stopColor:"#06b6d4"})]})]})})]}),(0,t.jsxs)("div",{className:"absolute inset-0 flex flex-col items-center justify-center",children:[(0,t.jsx)("span",{className:"text-5xl font-mono font-bold text-slate-100",children:ee(D)}),(0,t.jsx)("span",{className:"text-sm text-slate-400 capitalize mt-2",children:v.replace("-"," ")})]})]})}),(0,t.jsxs)("div",{className:"flex justify-center gap-4 mb-6",children:[(0,t.jsx)(f.Button,{variant:"outline",size:"lg",onClick:Q,className:"w-14 h-14 rounded-full p-0",children:(0,t.jsx)(d.RotateCcw,{className:"w-6 h-6"})}),(0,t.jsx)(f.Button,{size:"lg",onClick:J,className:`w-20 h-20 rounded-full p-0 bg-gradient-to-r ${es()} hover:opacity-90 text-white shadow-lg`,children:M?(0,t.jsx)(c,{className:"w-8 h-8"}):(0,t.jsx)(o,{className:"w-8 h-8 ml-1"})}),(0,t.jsx)(f.Button,{variant:"outline",size:"lg",onClick:()=>Z({soundEnabled:!k.soundEnabled}),className:"w-14 h-14 rounded-full p-0",children:k.soundEnabled?(0,t.jsx)(x,{className:"w-6 h-6"}):(0,t.jsx)(h,{className:"w-6 h-6"})})]}),(0,t.jsxs)("div",{className:"flex justify-center gap-8 text-center",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-2xl font-bold text-slate-100",children:$}),(0,t.jsx)("p",{className:"text-xs text-slate-400",children:"Sessions"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-2xl font-bold text-slate-100",children:Math.round(I)}),(0,t.jsx)("p",{className:"text-xs text-slate-400",children:"Minutes focused"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-2xl font-bold text-slate-100",children:F}),(0,t.jsx)("p",{className:"text-xs text-slate-400",children:"Day streak"})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("p",{className:"text-2xl font-bold text-slate-100",children:[$%k.sessionsBeforeLongBreak,"/",k.sessionsBeforeLongBreak]}),(0,t.jsx)("p",{className:"text-xs text-slate-400",children:"Until long break"})]})]}),L&&(0,t.jsxs)("div",{className:"mt-6 p-4 rounded-xl bg-gradient-to-br from-purple-500/10 to-pink-500/10 border border-purple-500/20",children:[(0,t.jsxs)("h3",{className:"font-medium text-slate-100 mb-3 flex items-center gap-2",children:[(0,t.jsx)(g.Brain,{className:"w-4 h-4 text-purple-500"}),"AI Productivity Insights"]}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Optimal work time"}),(0,t.jsx)("p",{className:"font-medium text-foreground",children:L.optimalWorkTime})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Recommended break activity"}),(0,t.jsx)("p",{className:"font-medium text-foreground",children:L.recommendedBreakActivity})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-muted-foreground mb-2",children:"Productivity tips"}),(0,t.jsx)("ul",{className:"space-y-1",children:L.productivityTips.map((e,s)=>(0,t.jsxs)("li",{className:"text-sm text-foreground flex items-start gap-2",children:[(0,t.jsx)("span",{className:"text-purple-500 mt-1",children:"â€¢"}),e]},s))})]})]})]}),(0,t.jsx)("div",{className:"mt-6",children:(0,t.jsx)(C,{isActive:M&&"work"===v})}),N&&(0,t.jsxs)("div",{className:"mt-6 p-4 rounded-xl bg-card border border-border space-y-4",children:[(0,t.jsx)("h3",{className:"font-medium text-foreground",children:"Timer Settings"}),(0,t.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-xs text-muted-foreground",children:"Focus (min)"}),(0,t.jsx)("input",{type:"number",value:k.workDuration,onChange:e=>Z({workDuration:parseInt(e.target.value)||25}),className:"w-full mt-1 px-3 py-2 rounded-lg bg-muted border border-border text-foreground text-sm",min:1,max:120})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-xs text-muted-foreground",children:"Short Break"}),(0,t.jsx)("input",{type:"number",value:k.shortBreakDuration,onChange:e=>Z({shortBreakDuration:parseInt(e.target.value)||5}),className:"w-full mt-1 px-3 py-2 rounded-lg bg-muted border border-border text-foreground text-sm",min:1,max:30})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-xs text-muted-foreground",children:"Long Break"}),(0,t.jsx)("input",{type:"number",value:k.longBreakDuration,onChange:e=>Z({longBreakDuration:parseInt(e.target.value)||15}),className:"w-full mt-1 px-3 py-2 rounded-lg bg-muted border border-border text-foreground text-sm",min:1,max:60})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("label",{className:"flex items-center gap-3 cursor-pointer",children:[(0,t.jsx)("input",{type:"checkbox",checked:k.autoStartBreaks,onChange:e=>Z({autoStartBreaks:e.target.checked}),className:"w-4 h-4 rounded"}),(0,t.jsx)("span",{className:"text-sm text-foreground",children:"Auto-start breaks"})]}),(0,t.jsxs)("label",{className:"flex items-center gap-3 cursor-pointer",children:[(0,t.jsx)("input",{type:"checkbox",checked:k.autoStartWork,onChange:e=>Z({autoStartWork:e.target.checked}),className:"w-4 h-4 rounded"}),(0,t.jsx)("span",{className:"text-sm text-foreground",children:"Auto-start focus after break"})]}),(0,t.jsxs)("label",{className:"flex items-center gap-3 cursor-pointer",children:[(0,t.jsx)("input",{type:"checkbox",checked:k.notificationsEnabled,onChange:e=>Z({notificationsEnabled:e.target.checked}),className:"w-4 h-4 rounded"}),(0,t.jsx)("span",{className:"text-sm text-foreground",children:"Desktop notifications"})]})]})]})]}),q&&(0,t.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 pointer-events-none",children:(0,t.jsxs)("div",{className:"bg-gradient-to-r from-green-500 to-blue-500 text-white px-8 py-4 rounded-2xl shadow-2xl animate-bounce max-w-md mx-4 text-center",children:[(0,t.jsx)("div",{className:"text-4xl mb-2",children:"ðŸŽ‰"}),(0,t.jsx)("p",{className:"text-lg font-semibold",children:_}),(0,t.jsx)("button",{onClick:()=>W(!1),className:"mt-3 px-4 py-2 bg-white/20 rounded-lg hover:bg-white/30 transition-colors pointer-events-auto",children:"Dismiss"})]})})]})}var M=e.i(59015),A=e.i(87316);let $=(0,i.default)("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);var E=e.i(7233),I=e.i(83086),R=e.i(10980);let F=(0,i.default)("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);var P=e.i(22016);function z({tasks:e,events:s,habits:r,focusMinutes:n=0,targetMinutes:l=120,flashcardsDue:i=0,onStartFocus:c,onTaskClick:d,onTaskToggle:u,onHabitToggle:m,onOpenJarvis:x}){let h=(0,a.useRouter)(),p=new Date().toISOString().split("T")[0],g=e.filter(e=>"done"!==e.status).length,b=r.filter(e=>e.completions?.some(e=>e.date===p&&e.completed)).length,j=r.length,y=j-b,N=e.find(e=>"done"!==e.status);return(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[(0,t.jsxs)("button",{onClick:c,className:"group p-4 rounded-xl bg-gradient-to-br from-blue-600/20 to-blue-800/10 border border-blue-500/30 hover:border-blue-400/50 hover:from-blue-600/30 transition-all text-left",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-8 h-8 rounded-lg bg-blue-500/20 flex items-center justify-center",children:(0,t.jsx)(o,{className:"w-4 h-4 text-blue-400"})}),(0,t.jsx)("span",{className:"text-sm font-medium text-slate-300",children:"Focus"})]}),(0,t.jsx)(F,{className:"w-4 h-4 text-blue-400 opacity-0 group-hover:opacity-100 transition-opacity"})]}),(0,t.jsxs)("div",{className:"flex items-baseline gap-1",children:[(0,t.jsx)("span",{className:"text-2xl font-bold text-white",children:n}),(0,t.jsxs)("span",{className:"text-slate-400 text-sm",children:["/ ",l," min"]})]}),(0,t.jsx)("p",{className:"text-xs text-blue-400 mt-1 font-medium",children:"Start 25-min session â†’"})]}),(0,t.jsxs)("button",{onClick:()=>N?d(N):h.push("/planner"),className:"group p-4 rounded-xl bg-gradient-to-br from-yellow-600/10 to-orange-800/5 border border-yellow-500/20 hover:border-yellow-400/40 transition-all text-left",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-8 h-8 rounded-lg bg-yellow-500/20 flex items-center justify-center",children:(0,t.jsx)($,{className:"w-4 h-4 text-yellow-400"})}),(0,t.jsx)("span",{className:"text-sm font-medium text-slate-300",children:"Tasks"})]}),(0,t.jsx)(F,{className:"w-4 h-4 text-yellow-400 opacity-0 group-hover:opacity-100 transition-opacity"})]}),(0,t.jsxs)("div",{className:"flex items-baseline gap-1",children:[(0,t.jsx)("span",{className:"text-2xl font-bold text-white",children:g}),(0,t.jsx)("span",{className:"text-slate-400 text-sm",children:"pending"})]}),(0,t.jsx)("p",{className:"text-xs text-yellow-400 mt-1 font-medium",children:g>0?"Do next task â†’":"Add tasks â†’"})]}),(0,t.jsx)(P.default,{href:"/flashcards",className:"block",children:(0,t.jsxs)("div",{className:"group p-4 rounded-xl bg-gradient-to-br from-purple-600/10 to-purple-800/5 border border-purple-500/20 hover:border-purple-400/40 transition-all text-left h-full",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-8 h-8 rounded-lg bg-purple-500/20 flex items-center justify-center",children:(0,t.jsx)(R.BookOpen,{className:"w-4 h-4 text-purple-400"})}),(0,t.jsx)("span",{className:"text-sm font-medium text-slate-300",children:"Cards"})]}),(0,t.jsx)(F,{className:"w-4 h-4 text-purple-400 opacity-0 group-hover:opacity-100 transition-opacity"})]}),(0,t.jsxs)("div",{className:"flex items-baseline gap-1",children:[(0,t.jsx)("span",{className:"text-2xl font-bold text-white",children:i}),(0,t.jsx)("span",{className:"text-slate-400 text-sm",children:"due"})]}),(0,t.jsx)("p",{className:"text-xs text-purple-400 mt-1 font-medium",children:i>0?"Review now â†’":"Create cards â†’"})]})})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[(0,t.jsxs)(k.Card,{className:"p-4 bg-slate-800/40 border-slate-700/50",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,t.jsx)("span",{className:"text-sm font-medium text-slate-300",children:"Today's Tasks"}),(0,t.jsx)(P.default,{href:"/planner",className:"text-xs text-blue-400 hover:text-blue-300",children:"All â†’"})]}),0===e.length?(0,t.jsxs)("div",{className:"py-4 text-center",children:[(0,t.jsx)("p",{className:"text-slate-500 text-sm mb-3",children:"No tasks scheduled"}),(0,t.jsxs)("div",{className:"flex gap-2 justify-center",children:[(0,t.jsxs)(f.Button,{size:"sm",variant:"outline",className:"text-xs h-8",onClick:()=>h.push("/planner"),children:[(0,t.jsx)(E.Plus,{className:"w-3 h-3 mr-1"}),"Add 3 tasks"]}),x&&(0,t.jsxs)(f.Button,{size:"sm",variant:"ghost",className:"text-xs h-8 text-purple-400",onClick:x,children:[(0,t.jsx)(I.Sparkles,{className:"w-3 h-3 mr-1"}),"AI plan"]})]})]}):(0,t.jsxs)("div",{className:"space-y-1.5",children:[e.slice(0,5).map(e=>(0,t.jsxs)("div",{className:`group flex items-center gap-2 p-2 rounded-lg bg-slate-700/30 hover:bg-slate-700/50 cursor-pointer border-l-2 ${(e=>{switch(e){case"urgent":return"border-l-red-500";case"high":return"border-l-orange-500";case"medium":return"border-l-yellow-500";default:return"border-l-slate-600"}})(e.priority)} transition-all`,children:[(0,t.jsx)("button",{onClick:t=>{t.stopPropagation(),u(e.id,"done"!==e.status)},className:`w-4 h-4 rounded border flex-shrink-0 ${"done"===e.status?"bg-green-500 border-green-500":"border-slate-500 hover:border-blue-400"} flex items-center justify-center`,children:"done"===e.status&&(0,t.jsx)($,{className:"w-3 h-3 text-white"})}),(0,t.jsx)("span",{onClick:()=>d(e),className:`text-sm flex-1 truncate ${"done"===e.status?"text-slate-500 line-through":"text-slate-200"}`,children:e.title}),"done"!==e.status&&(0,t.jsx)("button",{onClick:t=>{t.stopPropagation(),d(e),c()},className:"opacity-0 group-hover:opacity-100 p-1 hover:bg-blue-500/20 rounded",title:"Focus on this",children:(0,t.jsx)(o,{className:"w-3 h-3 text-blue-400"})})]},e.id)),e.length>5&&(0,t.jsxs)(P.default,{href:"/planner",className:"block text-center text-xs text-slate-400 hover:text-blue-400 py-1",children:["+",e.length-5," more"]})]})]}),(0,t.jsxs)(k.Card,{className:"p-4 bg-slate-800/40 border-slate-700/50",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,t.jsx)("span",{className:"text-sm font-medium text-slate-300",children:"Daily Habits"}),(0,t.jsx)(P.default,{href:"/habits",className:"text-xs text-blue-400 hover:text-blue-300",children:"Manage â†’"})]}),0===r.length?(0,t.jsxs)("div",{className:"py-4 text-center",children:[(0,t.jsx)("p",{className:"text-slate-500 text-sm mb-3",children:"Build consistency"}),(0,t.jsxs)(f.Button,{size:"sm",variant:"outline",className:"text-xs h-8",onClick:()=>h.push("/habits"),children:[(0,t.jsx)(E.Plus,{className:"w-3 h-3 mr-1"}),"Add first habit"]})]}):(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,t.jsx)("div",{className:"flex-1 h-2 bg-slate-700 rounded-full overflow-hidden",children:(0,t.jsx)("div",{className:"h-full bg-gradient-to-r from-orange-500 to-yellow-500 transition-all duration-500",style:{width:`${j>0?b/j*100:0}%`}})}),(0,t.jsxs)("span",{className:"text-xs text-slate-400 font-mono",children:[b,"/",j]})]}),(0,t.jsx)("div",{className:"flex flex-wrap gap-2",children:r.map(e=>{let s=e.completions?.some(e=>e.date===p&&e.completed);return(0,t.jsxs)("button",{onClick:()=>m(e.id),className:`px-3 py-1.5 rounded-full text-xs font-medium transition-all ${s?"bg-green-500/20 text-green-400 border border-green-500/30":"bg-slate-700/50 text-slate-300 border border-slate-600 hover:border-orange-500/50"}`,children:[s&&(0,t.jsx)($,{className:"w-3 h-3 inline mr-1"}),e.name]},e.id)})}),y>0&&(0,t.jsxs)("p",{className:"text-xs text-slate-500 mt-2",children:[y," remaining â€¢ Keep going!"]})]})]})]}),s.length>0&&(0,t.jsxs)("div",{className:"flex items-center gap-4 p-3 rounded-lg bg-slate-800/30 border border-slate-700/30",children:[(0,t.jsx)(A.Calendar,{className:"w-4 h-4 text-blue-400 flex-shrink-0"}),(0,t.jsx)("div",{className:"flex-1 flex items-center gap-4 overflow-x-auto",children:s.slice(0,3).map(e=>(0,t.jsxs)("div",{className:"flex items-center gap-2 text-sm whitespace-nowrap",children:[(0,t.jsx)("span",{className:"text-slate-500 font-mono text-xs",children:new Date(e.startTime).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}),(0,t.jsx)("span",{className:"text-slate-300",children:e.title})]},e.id))}),(0,t.jsx)(P.default,{href:"/calendar",className:"text-xs text-blue-400 hover:text-blue-300 flex-shrink-0",children:"Calendar â†’"})]})]})}var H=e.i(20278),L=e.i(31278),O=e.i(18348),q=e.i(19126);class W{context;cache;CACHE_DURATION=3e5;constructor(e){this.context=e,this.cache=new Map}updateContext(e){this.context={...this.context,...e},this.cache.clear()}getRecommendations(e=5){let t=this.getCacheKey(),s=this.cache.get(t);if(s&&Date.now()-s.timestamp<this.CACHE_DURATION)return s.recommendations.slice(0,e);let a=this.calculateRecommendations().sort((e,t)=>t.score-e.score).slice(0,e);return this.cache.set(t,{recommendations:a,timestamp:Date.now()}),a}getCacheKey(){let{tasks:e,habits:t,dailyStats:s,currentTime:a}=this.context;return`${e.length}-${t.length}-${s?.totalStudyMinutes||0}-${a.getHours()}`}calculateRecommendations(){let e=[];return e.push(...this.generateTaskRecommendations()),e.push(...this.generateHabitRecommendations()),e.push(...this.generateStudyPlanningRecommendations()),e.push(...this.generateFocusRecommendations()),e}generateTaskRecommendations(){let e=[],t=this.context.currentTime;for(let s of(t.getFullYear(),t.getMonth(),t.getDate(),this.context.tasks)){if("done"===s.status)continue;let a=s.dueDate?new Date(s.dueDate):null,r=this.calculateUrgency(a,t),n=this.calculateTaskImportance(s),l=this.calculateStreakImpact(s),i=.4*r+.4*n+.2*l;if(i>.3){let t=[];r>.7&&t.push("Due soon"),n>.7&&t.push("High priority"),l>.5&&t.push("Maintains study streak"),e.push({id:`task-${s.id}`,type:"task",title:`Complete: ${s.title}`,description:s.description||"Focus on this important task",score:i,urgency:r,importance:n,streakImpact:l,reasoning:t,action:{type:"navigate",data:{path:"/planner",filter:"task",taskId:s.id}}})}}return e}generateHabitRecommendations(){let e=[],t=this.context.currentTime,s=new Date(t.getFullYear(),t.getMonth(),t.getDate());for(let t of this.context.habits){if(t.completions.filter(e=>e.date===s.toISOString().split("T")[0]&&e.completed).length>0)continue;let a=t.currentStreak>0?Math.min(t.currentStreak/7,1):0,r="daily"===t.frequency?.8:.6,n=this.calculateHabitUrgency(t,s),l=.3*n+.3*r+.4*a;if(l>.4){let s=[];a>.7&&s.push(`${t.currentStreak} day streak at risk`),n>.8&&s.push("Due today"),r>.7&&s.push("Daily habit"),e.push({id:`habit-${t.id}`,type:"habit",title:`Complete: ${t.name}`,description:t.description||"Build consistency with this habit",score:l,urgency:n,importance:r,streakImpact:a,reasoning:s,action:{type:"toggle_habit",data:{habitId:t.id}}})}}return e}generateStudyPlanningRecommendations(){let e=[],{dailyStats:t,tasks:s,currentTime:a}=this.context,r=t?.totalStudyMinutes||0;if(r<60){let t=Math.max(0,1-r/120),s=this.context.userStreak?Math.min(this.context.userStreak/30,1):0;e.push({id:"study-planning-today",type:"study_planning",title:"Plan study session for today",description:`You've studied ${Math.round(r/60*10)/10}h today. Aim for 2h total.`,score:.4*t+.32000000000000006+.2*s,urgency:t,importance:.8,streakImpact:s,reasoning:[0===r?"No study time logged today":"Below daily study target","Consistent study builds better retention"],action:{type:"navigate",data:{path:"/planner",action:"schedule_study"}}})}let n=s.filter(e=>{if(!e.dueDate)return!1;let t=Math.ceil((new Date(e.dueDate).getTime()-a.getTime())/864e5);return t<=7&&t>0});return n.length>0&&e.push({id:"upcoming-deadlines",type:"study_planning",title:"Review upcoming deadlines",description:`${n.length} task${n.length>1?"s":""} due in the next week`,score:.7,urgency:.6,importance:.8,streakImpact:.3,reasoning:["Prepare ahead for better performance",`${n.length} deadline${n.length>1?"s":""} approaching`],action:{type:"navigate",data:{path:"/planner",filter:"upcoming"}}}),e}generateFocusRecommendations(){let e=[],{dailyStats:t,currentTime:s}=this.context,a=t?.totalStudyMinutes||0;return t?.pomodoroCompleted,a<180&&e.push({id:"focus-session",type:"focus_session",title:"Start a focus session",description:"25 minutes of deep, distraction-free work",score:.56,urgency:.5,importance:.7,streakImpact:.4,reasoning:["Ready for focused work","Deep work sessions improve learning efficiency"],action:{type:"start_focus",data:{duration:25}}}),e}calculateUrgency(e,t){if(!e)return .3;let s=(e.getTime()-t.getTime())/36e5;return s<0?1:s<=24?.9:s<=72?.7:s<=168?.5:.2}calculateTaskImportance(e){let t=.5;switch(e.priority){case"urgent":t+=.3;break;case"high":t+=.2;break;case"medium":t+=.1}return e.course&&(t+=.05),Math.min(t,1)}calculateStreakImpact(e){let t=this.context.userStreak||0;return t>0?Math.min(t/10,.5):0}calculateHabitUrgency(e,t){let s=t.toISOString().split("T")[0];if(e.completions.some(e=>e.date===s&&e.completed))return 0;let a="daily"===e.frequency?.8:.6;return Math.min(a+=Math.min(e.currentStreak/7,.2),1)}}let _=null;var U=e.i(28231);function V({onStartFocus:e}){let[a,r]=(0,s.useState)(null),[n,i]=(0,s.useState)(!0),{user:c}=(0,q.useAuth)();(0,s.useEffect)(()=>{c?d():i(!1)},[c]);let d=async()=>{if(c)try{var e;i(!0);let t=await (0,l.getUserData)(c.uid),s=(e={tasks:t.tasks||[],courses:t.courses||[],habits:t.habits||[],dailyStats:t.dailyStats||void 0,currentTime:new Date,userStreak:t.userStreak||0},_?_.updateContext(e):_=new W(e),_).getRecommendations(1);r(s[0]||null)}catch(e){console.error("Failed to load recommendations:",e)}finally{i(!1)}},u=a||{id:"default-focus",type:"focus_session",title:"Start a 25-min focus session",description:"Build momentum with deep work â€” the best way to make progress.",action:{type:"start_focus"},score:.9,urgency:.8,importance:.9,streakImpact:.7,reasoning:["Focus sessions build consistency","Best time for deep work"]},m="start_focus"===u.action.type||"focus_session"===u.type,x="navigate"===u.action.type&&u.action.data?.path;if(n)return(0,t.jsx)("div",{className:"p-4 rounded-xl bg-gradient-to-br from-green-900/20 to-emerald-900/10 border border-green-500/20",children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)(L.Loader2,{className:"w-5 h-5 animate-spin text-green-400"}),(0,t.jsx)("span",{className:"text-sm text-slate-400",children:"Finding your best next move..."})]})});let h=(0,t.jsx)("div",{className:"p-4 rounded-xl bg-gradient-to-br from-green-900/20 to-emerald-900/10 border border-green-500/30 hover:border-green-400/50 transition-all",children:(0,t.jsxs)("div",{className:"flex items-start gap-4",children:[(0,t.jsx)("div",{className:"w-10 h-10 rounded-xl bg-green-500/20 flex items-center justify-center flex-shrink-0",children:(0,t.jsx)(I.Sparkles,{className:"w-5 h-5 text-green-400"})}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,t.jsx)("span",{className:"text-xs font-medium text-green-400 uppercase tracking-wide",children:"Next Best Action"}),(0,t.jsx)(U.TooltipProvider,{children:(0,t.jsxs)(U.Tooltip,{children:[(0,t.jsx)(U.TooltipTrigger,{asChild:!0,children:(0,t.jsx)("button",{className:"text-slate-500 hover:text-slate-300",children:(0,t.jsx)(O.HelpCircle,{className:"w-3.5 h-3.5"})})}),(0,t.jsx)(U.TooltipContent,{side:"top",className:"max-w-xs",children:(0,t.jsxs)("p",{className:"text-xs",children:[(0,t.jsx)("strong",{children:"Why this?"}),(0,t.jsx)("br",{}),u.reasoning?.slice(0,2).join(" â€¢ ")||"AI-ranked based on your goals and habits."]})})]})})]}),(0,t.jsx)("p",{className:"text-slate-200 font-medium mb-2",children:u.description||u.title}),(0,t.jsx)(f.Button,{size:"sm",onClick:m?e:void 0,className:"bg-green-600 hover:bg-green-500 text-white gap-2",children:m?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(o,{className:"w-4 h-4"}),"Start Focus"]}):"flashcard_review"===u.type?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(R.BookOpen,{className:"w-4 h-4"}),"Review Cards"]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(H.Target,{className:"w-4 h-4"}),u.title.split(" ").slice(0,2).join(" ")]})})]})]})});return x&&!m?(0,t.jsx)(P.default,{href:u.action.data.path,children:h}):h}var K=e.i(58377),Y=e.i(64030);e.i(36180);var G=e.i(98925);function X(){let{user:e}=(0,q.useAuth)(),[a,r]=(0,s.useState)({currentStreak:0,longestStreak:0,totalDays:0,lastActiveDate:"",milestones:[]}),[l,i]=(0,s.useState)(!0),[o,c]=(0,s.useState)(!1);(0,s.useEffect)(()=>{e&&d()},[e]);let d=async()=>{if(e)try{let t=(0,G.doc)(n.db,"streaks",e.uid),s=await (0,G.getDoc)(t);if(s.exists()){let e=s.data();r(e),await u(e)}else{let e={currentStreak:0,longestStreak:0,totalDays:0,lastActiveDate:"",milestones:[]};await (0,G.setDoc)(t,e),r(e)}}catch(e){console.error("Error loading streak:",e)}finally{i(!1)}},u=async t=>{if(!e)return;let s=new Date().toDateString(),a=new Date(t.lastActiveDate).toDateString();if(s===a)return;let l=new Date;l.setDate(l.getDate()-1);let i=l.toDateString(),o=t.currentStreak;a===i?o=t.currentStreak+1:(t.lastActiveDate,o=1);let d=Math.max(o,t.longestStreak),u=t.totalDays+1,m=[...t.milestones];for(let e of[7,30,60,100,365])o!==e||m.includes(e)||(m.push(e),c(!0),setTimeout(()=>c(!1),5e3));let x={currentStreak:o,longestStreak:d,totalDays:u,lastActiveDate:s,milestones:m},h=(0,G.doc)(n.db,"streaks",e.uid);await (0,G.setDoc)(h,x),r(x)},m=()=>[7,30,60,100,365].find(e=>e>a.currentStreak)||365;return l||0===a.currentStreak&&0===a.totalDays?null:(0,t.jsxs)("div",{className:"relative flex items-center justify-between p-3 rounded-lg bg-gradient-to-r from-orange-500/10 to-red-500/5 border border-orange-500/20",children:[o&&(0,t.jsxs)("div",{className:"absolute inset-0 bg-gradient-to-r from-orange-500/20 to-yellow-500/20 animate-pulse rounded-lg flex items-center justify-center",children:[(0,t.jsx)(Y.Trophy,{className:"w-5 h-5 text-yellow-500 animate-bounce mr-2"}),(0,t.jsx)("span",{className:"text-yellow-400 font-medium",children:"New Milestone!"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(K.Flame,{className:"w-4 h-4 text-orange-500"}),(0,t.jsxs)("span",{className:"text-sm font-medium text-orange-400",children:[a.currentStreak,"-day streak"]}),7>=m()-a.currentStreak&&(0,t.jsxs)("span",{className:"text-xs text-slate-500",children:["â€¢ ",m()-a.currentStreak,"d to ",m(),"-day milestone"]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3 text-xs text-slate-500",children:[(0,t.jsxs)("span",{children:["Best: ",a.longestStreak]}),(0,t.jsxs)("span",{children:["Total: ",a.totalDays]})]})]})}let J=(0,i.default)("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);var Q=e.i(87951);let Z=(0,i.default)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);var ee=e.i(63209),et=e.i(54858);function es({onBackendStatusChange:e}){let[a,r]=(0,s.useState)(null),[n,l]=(0,s.useState)(!0),[i,o]=(0,s.useState)(!1);(0,s.useEffect)(()=>{c();let e=setInterval(c,3e4);return()=>clearInterval(e)},[]),(0,s.useEffect)(()=>{e&&e(a?.status==="healthy")},[a,e]);let c=async()=>{try{let e=await (0,et.checkHealth)();r(e)}catch{r(null)}finally{l(!1)}},d=async()=>{o(!0),await c(),o(!1)};if(n)return(0,t.jsxs)("div",{className:"flex items-center gap-2 text-slate-500 text-sm",children:[(0,t.jsx)("div",{className:"w-2 h-2 rounded-full bg-slate-600 animate-pulse"}),(0,t.jsx)("span",{children:"Checking AI services..."})]});if(!a)return(0,t.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-lg bg-red-500/10 border border-red-500/20",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(ee.AlertCircle,{className:"w-4 h-4 text-red-400"}),(0,t.jsx)("span",{className:"text-sm text-red-400",children:"AI Offline"}),(0,t.jsx)("span",{className:"text-xs text-slate-500",children:"â€¢ Start backend for AI features"})]}),(0,t.jsx)(f.Button,{size:"sm",variant:"ghost",onClick:d,disabled:i,className:"text-slate-400 hover:text-white h-7 px-2",children:(0,t.jsx)(Z,{className:`w-3.5 h-3.5 ${i?"animate-spin":""}`})})]});let u=a.services,m=u.qdrant?.connected&&u.ollama?.connected;return(0,t.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-lg bg-slate-800/30 border border-slate-700/30",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,t.jsx)("div",{className:`w-2 h-2 rounded-full ${m?"bg-green-500":"bg-yellow-500"}`}),(0,t.jsx)("span",{className:"text-sm text-slate-400",children:"AI"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3 text-xs",children:[(0,t.jsxs)("span",{className:`flex items-center gap-1 ${u.qdrant?.connected?"text-slate-400":"text-red-400"}`,children:[(0,t.jsx)(J,{className:"w-3 h-3"}),"Memory"]}),(0,t.jsxs)("span",{className:`flex items-center gap-1 ${u.ollama?.connected?"text-slate-400":"text-red-400"}`,children:[(0,t.jsx)(g.Brain,{className:"w-3 h-3"}),"Models"]}),(0,t.jsxs)("span",{className:`flex items-center gap-1 ${u.whisper?.loaded?"text-slate-400":"text-slate-600"}`,children:[(0,t.jsx)(Q.Mic,{className:"w-3 h-3"}),"Voice"]})]})]}),(0,t.jsx)(f.Button,{size:"sm",variant:"ghost",onClick:d,disabled:i,className:"text-slate-500 hover:text-white h-7 px-2",children:(0,t.jsx)(Z,{className:`w-3.5 h-3.5 ${i?"animate-spin":""}`})})]})}var ea=e.i(60171),er=e.i(45584),en=e.i(46696);function el(){let e=(0,a.useRouter)(),[i,o]=(0,s.useState)(null),[c,d]=(0,s.useState)(!0),[u,m]=(0,s.useState)([]),[x,h]=(0,s.useState)([]),[p,g]=(0,s.useState)(null),[f,b]=(0,s.useState)([]),[j,k]=(0,s.useState)(!1),[y,N]=(0,s.useState)(null),{tasks:w,toggleTask:v}=(0,er.usePersistentTasks)();(0,s.useEffect)(()=>{let t=(0,r.onAuthStateChanged)(n.auth,async t=>{o(t),t?await S(t.uid):e.push("/login"),d(!1)});return()=>t()},[e,w]);let S=async e=>{try{let t=new Date,s=t.toISOString().split("T")[0],a=new Date(t);a.setHours(23,59,59,999);let[r,n,i,o]=await Promise.all([(0,l.getCalendarEvents)(e,{start:t,end:a}),(0,l.getHabits)(e),(0,l.getDailyStats)(e,s),(0,l.getCourses)(e)]);m(r.slice(0,4)),h(n),g(i),b(o);let c=w.filter(e=>"done"!==e.status&&(e.scheduledDate?.toDateString()===t.toDateString()||e.dueDate?.toDateString()===t.toDateString()||"urgent"===e.priority)).slice(0,5),d=c.find(e=>"in-progress"===e.status)||c[0];d&&N(d)}catch(e){console.error("Error loading dashboard:",e)}},D=w.filter(e=>e.scheduledDate?.toDateString()===new Date().toDateString()||e.dueDate?.toDateString()===new Date().toDateString()||"urgent"===e.priority).slice(0,8),C=async(e,t)=>{try{await v(e,t),en.toast.success(t?"Task completed! ðŸŽ‰":"Task reopened")}catch{en.toast.error("Failed to update task")}},T=async e=>{if(i)try{await (0,l.toggleHabitCompletion)(i.uid,e);let t=await (0,l.getHabits)(i.uid);h(t);let s=x.find(t=>t.id===e),a=new Date().toISOString().split("T")[0],r=s?.completions?.some(e=>e.date===a&&e.completed);en.toast.success(r?"Habit unchecked":"Habit completed! ðŸ’ª")}catch(e){console.error("Error toggling habit:",e),en.toast.error("Failed to update habit")}};return c?(0,t.jsx)("div",{className:"min-h-screen bg-background flex items-center justify-center",children:(0,t.jsx)("div",{className:"animate-spin w-8 h-8 border-2 border-primary border-t-transparent rounded-full"})}):(0,t.jsxs)(M.default,{title:"Dashboard",subtitle:"Your study command center â€“ track progress, start sessions, and get AI-powered insights",children:[(0,t.jsx)(z,{tasks:D,events:u,habits:x,focusMinutes:p?.totalStudyMinutes||0,targetMinutes:120,flashcardsDue:0,onStartFocus:()=>k(!0),onTaskClick:N,onTaskToggle:C,onHabitToggle:T}),(0,t.jsx)("div",{className:"mt-4",children:(0,t.jsx)(X,{})}),(0,t.jsx)("div",{className:"mt-4",children:(0,t.jsx)(V,{onStartFocus:()=>k(!0)})}),(0,t.jsx)("div",{className:"mt-4",children:(0,t.jsx)(es,{})}),(0,t.jsx)(ea.JarvisAssistant,{context:{currentPage:"dashboard",todayTasks:D,courses:f,habits:x,dailyStats:p||void 0}}),j&&(0,t.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:(0,t.jsx)("div",{className:"bg-slate-800 rounded-xl border border-slate-700 shadow-2xl max-w-md w-full max-h-[90vh] overflow-y-auto",children:(0,t.jsx)(B,{task:y,onClose:()=>k(!1)})})})]})}e.s(["default",()=>el],78928)}]);