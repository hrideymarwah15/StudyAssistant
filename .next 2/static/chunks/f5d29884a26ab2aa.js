(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,16015,(e,t,s)=>{},98547,(e,t,s)=>{var a=e.i(47167);e.r(16015);var r=e.r(71645),n=r&&"object"==typeof r&&"default"in r?r:{default:r},i=void 0!==a.default&&a.default.env&&!0,o=function(e){return"[object String]"===Object.prototype.toString.call(e)},c=function(){function e(e){var t=void 0===e?{}:e,s=t.name,a=void 0===s?"stylesheet":s,r=t.optimizeForSpeed,n=void 0===r?i:r;l(o(a),"`name` must be a string"),this._name=a,this._deletedRulePlaceholder="#"+a+"-deleted-rule____{}",l("boolean"==typeof n,"`optimizeForSpeed` must be a boolean"),this._optimizeForSpeed=n,this._serverSheet=void 0,this._tags=[],this._injected=!1,this._rulesCount=0;var c="undefined"!=typeof window&&document.querySelector('meta[property="csp-nonce"]');this._nonce=c?c.getAttribute("content"):null}var t,s=e.prototype;return s.setOptimizeForSpeed=function(e){l("boolean"==typeof e,"`setOptimizeForSpeed` accepts a boolean"),l(0===this._rulesCount,"optimizeForSpeed cannot be when rules have already been inserted"),this.flush(),this._optimizeForSpeed=e,this.inject()},s.isOptimizeForSpeed=function(){return this._optimizeForSpeed},s.inject=function(){var e=this;if(l(!this._injected,"sheet already injected"),this._injected=!0,"undefined"!=typeof window&&this._optimizeForSpeed){this._tags[0]=this.makeStyleTag(this._name),this._optimizeForSpeed="insertRule"in this.getSheet(),this._optimizeForSpeed||(i||console.warn("StyleSheet: optimizeForSpeed mode not supported falling back to standard mode."),this.flush(),this._injected=!0);return}this._serverSheet={cssRules:[],insertRule:function(t,s){return"number"==typeof s?e._serverSheet.cssRules[s]={cssText:t}:e._serverSheet.cssRules.push({cssText:t}),s},deleteRule:function(t){e._serverSheet.cssRules[t]=null}}},s.getSheetForTag=function(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]},s.getSheet=function(){return this.getSheetForTag(this._tags[this._tags.length-1])},s.insertRule=function(e,t){if(l(o(e),"`insertRule` accepts only strings"),"undefined"==typeof window)return"number"!=typeof t&&(t=this._serverSheet.cssRules.length),this._serverSheet.insertRule(e,t),this._rulesCount++;if(this._optimizeForSpeed){var s=this.getSheet();"number"!=typeof t&&(t=s.cssRules.length);try{s.insertRule(e,t)}catch(t){return i||console.warn("StyleSheet: illegal rule: \n\n"+e+"\n\nSee https://stackoverflow.com/q/20007992 for more info"),-1}}else{var a=this._tags[t];this._tags.push(this.makeStyleTag(this._name,e,a))}return this._rulesCount++},s.replaceRule=function(e,t){if(this._optimizeForSpeed||"undefined"==typeof window){var s="undefined"!=typeof window?this.getSheet():this._serverSheet;if(t.trim()||(t=this._deletedRulePlaceholder),!s.cssRules[e])return e;s.deleteRule(e);try{s.insertRule(t,e)}catch(a){i||console.warn("StyleSheet: illegal rule: \n\n"+t+"\n\nSee https://stackoverflow.com/q/20007992 for more info"),s.insertRule(this._deletedRulePlaceholder,e)}}else{var a=this._tags[e];l(a,"old rule at index `"+e+"` not found"),a.textContent=t}return e},s.deleteRule=function(e){if("undefined"==typeof window)return void this._serverSheet.deleteRule(e);if(this._optimizeForSpeed)this.replaceRule(e,"");else{var t=this._tags[e];l(t,"rule at index `"+e+"` not found"),t.parentNode.removeChild(t),this._tags[e]=null}},s.flush=function(){this._injected=!1,this._rulesCount=0,"undefined"!=typeof window?(this._tags.forEach(function(e){return e&&e.parentNode.removeChild(e)}),this._tags=[]):this._serverSheet.cssRules=[]},s.cssRules=function(){var e=this;return"undefined"==typeof window?this._serverSheet.cssRules:this._tags.reduce(function(t,s){return s?t=t.concat(Array.prototype.map.call(e.getSheetForTag(s).cssRules,function(t){return t.cssText===e._deletedRulePlaceholder?null:t})):t.push(null),t},[])},s.makeStyleTag=function(e,t,s){t&&l(o(t),"makeStyleTag accepts only strings as second parameter");var a=document.createElement("style");this._nonce&&a.setAttribute("nonce",this._nonce),a.type="text/css",a.setAttribute("data-"+e,""),t&&a.appendChild(document.createTextNode(t));var r=document.head||document.getElementsByTagName("head")[0];return s?r.insertBefore(a,s):r.appendChild(a),a},t=[{key:"length",get:function(){return this._rulesCount}}],function(e,t){for(var s=0;s<t.length;s++){var a=t[s];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}(e.prototype,t),e}();function l(e,t){if(!e)throw Error("StyleSheet: "+t+".")}var d=function(e){for(var t=5381,s=e.length;s;)t=33*t^e.charCodeAt(--s);return t>>>0},u={};function m(e,t){if(!t)return"jsx-"+e;var s=String(t),a=e+s;return u[a]||(u[a]="jsx-"+d(e+"-"+s)),u[a]}function h(e,t){"undefined"==typeof window&&(t=t.replace(/\/style/gi,"\\/style"));var s=e+t;return u[s]||(u[s]=t.replace(/__jsx-style-dynamic-selector/g,e)),u[s]}var p=function(){function e(e){var t=void 0===e?{}:e,s=t.styleSheet,a=void 0===s?null:s,r=t.optimizeForSpeed,n=void 0!==r&&r;this._sheet=a||new c({name:"styled-jsx",optimizeForSpeed:n}),this._sheet.inject(),a&&"boolean"==typeof n&&(this._sheet.setOptimizeForSpeed(n),this._optimizeForSpeed=this._sheet.isOptimizeForSpeed()),this._fromServer=void 0,this._indices={},this._instancesCounts={}}var t=e.prototype;return t.add=function(e){var t=this;void 0===this._optimizeForSpeed&&(this._optimizeForSpeed=Array.isArray(e.children),this._sheet.setOptimizeForSpeed(this._optimizeForSpeed),this._optimizeForSpeed=this._sheet.isOptimizeForSpeed()),"undefined"==typeof window||this._fromServer||(this._fromServer=this.selectFromServer(),this._instancesCounts=Object.keys(this._fromServer).reduce(function(e,t){return e[t]=0,e},{}));var s=this.getIdAndRules(e),a=s.styleId,r=s.rules;if(a in this._instancesCounts){this._instancesCounts[a]+=1;return}var n=r.map(function(e){return t._sheet.insertRule(e)}).filter(function(e){return -1!==e});this._indices[a]=n,this._instancesCounts[a]=1},t.remove=function(e){var t=this,s=this.getIdAndRules(e).styleId;if(function(e,t){if(!e)throw Error("StyleSheetRegistry: "+t+".")}(s in this._instancesCounts,"styleId: `"+s+"` not found"),this._instancesCounts[s]-=1,this._instancesCounts[s]<1){var a=this._fromServer&&this._fromServer[s];a?(a.parentNode.removeChild(a),delete this._fromServer[s]):(this._indices[s].forEach(function(e){return t._sheet.deleteRule(e)}),delete this._indices[s]),delete this._instancesCounts[s]}},t.update=function(e,t){this.add(t),this.remove(e)},t.flush=function(){this._sheet.flush(),this._sheet.inject(),this._fromServer=void 0,this._indices={},this._instancesCounts={}},t.cssRules=function(){var e=this,t=this._fromServer?Object.keys(this._fromServer).map(function(t){return[t,e._fromServer[t]]}):[],s=this._sheet.cssRules();return t.concat(Object.keys(this._indices).map(function(t){return[t,e._indices[t].map(function(e){return s[e].cssText}).join(e._optimizeForSpeed?"":"\n")]}).filter(function(e){return!!e[1]}))},t.styles=function(e){var t,s;return t=this.cssRules(),void 0===(s=e)&&(s={}),t.map(function(e){var t=e[0],a=e[1];return n.default.createElement("style",{id:"__"+t,key:"__"+t,nonce:s.nonce?s.nonce:void 0,dangerouslySetInnerHTML:{__html:a}})})},t.getIdAndRules=function(e){var t=e.children,s=e.dynamic,a=e.id;if(s){var r=m(a,s);return{styleId:r,rules:Array.isArray(t)?t.map(function(e){return h(r,e)}):[h(r,t)]}}return{styleId:m(a),rules:Array.isArray(t)?t:[t]}},t.selectFromServer=function(){return Array.prototype.slice.call(document.querySelectorAll('[id^="__jsx-"]')).reduce(function(e,t){return e[t.id.slice(2)]=t,e},{})},e}(),b=r.createContext(null);function g(){return new p}function f(){return r.useContext(b)}b.displayName="StyleSheetContext";var y=n.default.useInsertionEffect||n.default.useLayoutEffect,x="undefined"!=typeof window?g():void 0;function w(e){var t=x||f();return t&&("undefined"==typeof window?t.add(e):y(function(){return t.add(e),function(){t.remove(e)}},[e.id,String(e.dynamic)])),null}w.dynamic=function(e){return e.map(function(e){return m(e[0],e[1])}).join(" ")},s.StyleRegistry=function(e){var t=e.registry,s=e.children,a=r.useContext(b),i=r.useState(function(){return a||t||g()})[0];return n.default.createElement(b.Provider,{value:i},s)},s.createStyleRegistry=g,s.style=w,s.useStyleRegistry=f},37902,(e,t,s)=>{t.exports=e.r(98547).style},60171,e=>{"use strict";var t=e.i(43476),s=e.i(37902),a=e.i(71645),r=e.i(18566),n=e.i(94433);function i(){return!!(window.SpeechRecognition||window.webkitSpeechRecognition)}function o(e,t={}){return new Promise((s,a)=>{if(!window.speechSynthesis)return void a(Error("Speech synthesis not supported"));window.speechSynthesis.cancel();let r=new SpeechSynthesisUtterance(e);if(r.rate=t.rate??1.1,r.pitch=t.pitch??1.1,r.volume=t.volume??.9,r.lang=t.lang??"en-US",t.voice)r.voice=t.voice;else{let e=window.speechSynthesis.getVoices(),t=e.find(e=>e.name.includes("Samantha")||e.name.includes("Female")||e.name.includes("Zira")||e.name.includes("Karen")||e.name.includes("Moira")||e.name.includes("Fiona")||e.name.includes("Victoria")||e.name.includes("Google UK English Female"))||e.find(e=>e.lang.startsWith("en"));t&&(r.voice=t)}r.onend=()=>s(),r.onerror=e=>{"canceled"===e.error||"interrupted"===e.error?s():a(Error(e.error))},window.speechSynthesis.speak(r)})}function c(){window.speechSynthesis&&window.speechSynthesis.cancel()}e.i(96556);var l=e.i(71898);class d{COMMAND_PATTERNS={create_task:[/(?:create|add|make|schedule)\s+(?:a\s+)?(?:new\s+)?task(?:\s+(?:called|named|titled)\s+)?["']?([^"']+)["']?/i,/(?:i\s+need\s+to|i\s+have\s+to|i\s+should)\s+(.+?)(?:\s+(?:by|before|due)\s+(.+?))?(?:\s+(?:for|in)\s+(.+?))?$/i,/(?:remind\s+me\s+to|don't\s+forget\s+to)\s+(.+?)(?:\s+(?:by|before|due)\s+(.+?))?$/i],complete_task:[/(?:complete|finish|mark\s+(?:as\s+)?done|check\s+off)\s+(?:task\s+)?["']?([^"']+)["']?/i,/(?:i\s+(?:finished|completed|done\s+with))\s+(.+)$/i],show_tasks:[/(?:show|list|display|get)\s+(?:me\s+)?(?:my\s+)?tasks?(?:\s+(?:for|in)\s+(.+?))?(?:\s+(?:due|before)\s+(.+?))?/i,/(?:what\s+(?:do\s+i\s+have\s+to\s+do|tasks\s+do\s+i\s+have|is\s+on\s+my\s+plate))\??$/i,/(?:what's\s+(?:due|coming\s+up|on\s+my\s+schedule))\??$/i],start_study:[/(?:start|begin|launch)\s+(?:a\s+)?(?:study|focus|work)\s+session(?:\s+(?:for|on)\s+(.+?))?(?:\s+(?:of|lasting)\s+(\d+)\s*(?:min|minutes?))?/i,/(?:let's\s+(?:study|focus|work))\s*(?:\s+(?:on|for)\s+(.+?))?(?:\s+(?:for|lasting)\s+(\d+)\s*(?:min|minutes?))?/i,/(?:time\s+to\s+(?:study|focus|work))\s*(?:\s+(?:on|for)\s+(.+?))?(?:\s+(?:for|lasting)\s+(\d+)\s*(?:min|minutes?))?/i],complete_habit:[/(?:i\s+(?:did|completed?|finished))\s+(.+?)(?:\s+today)?$/i,/(?:mark|check)\s+(.+?)\s+(?:as\s+)?(?:done|completed?)(?:\s+today)?$/i,/(?:completed?|finished|did)\s+(.+?)(?:\s+habit)?(?:\s+today)?$/i],show_habits:[/(?:show|list|display)\s+(?:me\s+)?(?:my\s+)?habits?$/i,/(?:what\s+habits?\s+(?:do\s+i\s+have|should\s+i\s+do))\??$/i,/(?:habit\s+(?:tracker|status|progress))\??$/i],show_course:[/(?:show|tell\s+me\s+about|what's\s+up\s+with)\s+(?:my\s+)?(.+?)\s+course$/i,/(?:course\s+info|course\s+details)\s+(?:for\s+)?(.+)$/i,/(?:how's\s+my\s+)?(.+?)\s+(?:course|class)\s+(?:going|progress)\??$/i],find_material:[/(?:find|search|get|show)\s+(?:me\s+)?(?:materials?|notes?|resources?)(?:\s+(?:for|about|on)\s+(.+?))?(?:\s+(?:in|from)\s+(.+?))?/i,/(?:where\s+(?:are|is)\s+my\s+)?(.+?)\s+(?:notes?|materials?|resources?)\??$/i,/(?:i\s+need\s+(?:materials?|notes?|resources?)\s+(?:for|about|on)\s+)?(.+)$/i],schedule_event:[/(?:schedule|plan|set\s+up)\s+(?:a\s+)?(?:meeting|event|appointment)(?:\s+(?:called|named|titled)\s+["']?([^"']+)["']?)?(?:\s+(?:for|on|at)\s+(.+?))?(?:\s+(?:with|and)\s+(.+?))?/i,/(?:add\s+to\s+(?:my\s+)?calendar|put\s+on\s+(?:my\s+)?schedule)\s+(.+?)(?:\s+(?:at|on)\s+(.+?))?(?:\s+(?:with|and)\s+(.+?))?/i],show_progress:[/(?:show|tell\s+me|get)\s+(?:my\s+)?(?:progress|stats|analytics|performance)(?:\s+(?:for|on|in)\s+(.+?))?(?:\s+(?:this\s+)?(?:week|month|year))?/i,/(?:how\s+(?:am\s+i\s+doing|is\s+my\s+progress|are\s+my\s+stats))\??(?:\s+(?:in|for|on)\s+(.+?))?/i,/(?:progress\s+report|study\s+stats|performance\s+summary)(?:\s+(?:for|on)\s+(.+?))?\??$/i],study_plan:[/(?:create|make|plan|generate)\s+(?:a\s+)?(?:study|revision|exam)\s+plan(?:\s+(?:for|exam)\s+(.+?))?(?:\s+(?:in|over)\s+(\d+)\s*(?:days?|weeks?))?/i,/(?:help\s+me\s+)?(?:plan|prepare)\s+(?:for\s+)?(?:my\s+)?(.+?)\s+(?:exam|test|quiz)(?:\s+(?:in|over)\s+(\d+)\s*(?:days?|weeks?))?/i],productivity_session:[/(?:start|begin|launch)\s+(?:a\s+)?(?:productivity|deep\s+work|focus)\s+session(?:\s+(?:for|lasting)\s+(\d+)\s*(?:min|minutes?|hours?))?/i,/(?:let's\s+(?:get|be)\s+productive|time\s+for\s+deep\s+work|focus\s+mode|do\s+not\s+disturb)$/i]};INTENT_MAPPING={create_task:"task.create",complete_task:"task.complete",show_tasks:"task.list",start_study:"study.start",complete_habit:"habit.complete",show_habits:"habit.list",show_course:"course.info",find_material:"material.search",schedule_event:"calendar.create",show_progress:"analytics.show",study_plan:"plan.create",productivity_session:"productivity.start"};parseCommand(e,t){let s=e.toLowerCase().trim();for(let[a,r]of Object.entries(this.COMMAND_PATTERNS))for(let n of r){let r=s.match(n);if(r){let s=this.buildParsedCommand(a,r,e);if(s.confidence>.3)return s.multiStep&&(s.steps=this.generateSteps(s,t)),s}}return{intent:"unknown",entities:{},confidence:.1,originalCommand:e,requiresConfirmation:!0}}buildParsedCommand(e,t,s){let a=this.INTENT_MAPPING[e]||e,r={},n=.8;switch(e){case"create_task":r.title=t[1]||t[2]||t[3],r.dueDate=this.parseDate(t[4]||t[5]),r.course=t[6];break;case"complete_task":r.taskName=t[1]||t[2];break;case"show_tasks":r.filter=t[1]||t[2]?{course:t[1],dueDate:t[2]}:null;break;case"start_study":r.task=t[1]||t[2],r.duration=t[3]||t[4]?parseInt(t[3]||t[4]):25;break;case"complete_habit":r.habitName=t[1]||t[2]||t[3];break;case"show_course":r.courseName=t[1]||t[2]||t[3];break;case"find_material":r.topic=t[1]||t[2]||t[3],r.course=t[4];break;case"schedule_event":r.title=t[1]||t[4],r.dateTime=this.parseDate(t[2]||t[5]),r.participants=t[3]||t[6];break;case"study_plan":r.examName=t[1]||t[2],r.days=t[3]||t[4]?parseInt(t[3]||t[4]):7,n=.9;break;case"productivity_session":r.duration=t[1]?this.parseDuration(t[1]):90,n=.9;break;default:n=.5}return{intent:a,entities:r,confidence:n,originalCommand:s,multiStep:["study_plan","productivity_session"].includes(e),requiresConfirmation:n<.7}}generateSteps(e,t){let s=[];switch(e.intent){case"plan.create":s.push({id:"gather_requirements",action:"analyze_course_materials",params:{examName:e.entities.examName},description:"Analyzing course materials and syllabus"},{id:"assess_current_progress",action:"check_completion_status",params:{course:e.entities.examName},description:"Checking current progress and completed topics"},{id:"calculate_study_load",action:"estimate_time_needed",params:{days:e.entities.days,course:e.entities.examName},description:"Calculating optimal study time distribution"},{id:"generate_schedule",action:"create_study_plan",params:{days:e.entities.days,course:e.entities.examName},description:"Creating detailed study schedule",dependsOn:["gather_requirements","assess_current_progress","calculate_study_load"]},{id:"create_tasks",action:"schedule_tasks",params:{planId:"{{generate_schedule.result}}"},description:"Adding study tasks to your planner",dependsOn:["generate_schedule"]});break;case"productivity.start":s.push({id:"prepare_environment",action:"setup_focus_mode",params:{duration:e.entities.duration},description:"Setting up distraction-free environment"},{id:"select_task",action:"choose_next_task",params:{},description:"Selecting the most important task to focus on",requiresUserInput:!0},{id:"start_timer",action:"begin_pomodoro",params:{taskId:"{{select_task.result}}",duration:e.entities.duration},description:"Starting focused work session",dependsOn:["prepare_environment","select_task"]},{id:"monitor_progress",action:"track_session",params:{sessionId:"{{start_timer.result}}"},description:"Monitoring your progress and providing encouragement"})}return s}parseDate(e){if(!e)return null;let t=new Date,s=e.toLowerCase();if(s.includes("tomorrow")){let e=new Date(t);return e.setDate(t.getDate()+1),e}if(s.includes("next week")){let e=new Date(t);return e.setDate(t.getDate()+7),e}if(s.includes("end of week")||s.includes("friday")){let e=new Date(t),s=(5-t.getDay()+7)%7;return e.setDate(t.getDate()+(0===s?7:s)),e}let a=new Date(e);return isNaN(a.getTime())?null:a}parseDuration(e){let t=e.match(/(\d+)\s*(min|minutes?|hours?)/i);if(t){let e=parseInt(t[1]);return t[2].toLowerCase().startsWith("hour")?60*e:e}return 25}getSuggestedCommands(e){let t=[];return e?.currentPage==="dashboard"&&t.push("Start a study session","Show my tasks","Complete a habit","Create a study plan"),e?.currentPage==="planner"&&t.push("Create a new task","Show tasks due today","Schedule an event"),e?.availableData?.tasks&&e.availableData.tasks.length>0&&t.push("Show my tasks"),e?.availableData?.habits&&e.availableData.habits.length>0&&t.push("Show my habits"),t.slice(0,4)}}let u=null;function m(){return u||(u=new d),u}class h{materials=[];userId;constructor(e){this.userId=e}async initialize(){try{this.materials=await (0,l.getMaterials)(this.userId)}catch(e){console.error("Failed to load materials for search:",e),this.materials=[]}}async search(e,t={}){let{limit:s=10,types:a,tags:r}=t;if(!e.trim())return[];0===this.materials.length&&await this.initialize();let n=e.toLowerCase(),i=[];for(let e of this.materials){if(a&&a.length>0&&!a.includes(e.type))continue;if(r&&r.length>0){let t=e.subject||"";if(!r.some(e=>t.toLowerCase().includes(e.toLowerCase())))continue}let t=0,s="";e.title.toLowerCase().includes(n)&&(t+=10,s=this.extractExcerpt(e.title,n)),e.content&&e.content.toLowerCase().includes(n)&&(t+=5,s||(s=this.extractExcerpt(e.content,n))),e.subject&&e.subject.toLowerCase().includes(n)&&(t+=3,s||(s=`Subject: ${e.subject}`)),e.title.toLowerCase()===n&&(t+=20),t>0&&i.push({id:e.id,name:e.title,type:e.type,content:e.content||"",tags:[e.subject],relevanceScore:t,excerpt:s||e.title})}return i.sort((e,t)=>t.relevanceScore-e.relevanceScore),i.slice(0,s)}extractExcerpt(e,t,s=50){let a=e.toLowerCase().indexOf(t);if(-1===a)return e.substring(0,s)+"...";let r=Math.max(0,a-s/2),n=Math.min(e.length,a+t.length+s/2),i=e.substring(r,n);return r>0&&(i="..."+i),n<e.length&&(i+="..."),i}getAvailableTypes(){return Array.from(new Set(this.materials.map(e=>e.type)))}getAvailableTags(){let e=new Set;return this.materials.forEach(t=>{t.subject&&e.add(t.subject)}),Array.from(e)}getMaterialCount(){return this.materials.length}}let p=null;class b{executionStates=new Map;API_BRIDGES={"task.create":this.createTask.bind(this),"task.complete":this.completeTask.bind(this),"task.list":this.listTasks.bind(this),"study.start":this.startStudySession.bind(this),"habit.complete":this.completeHabit.bind(this),"habit.list":this.listHabits.bind(this),"course.info":this.getCourseInfo.bind(this),"material.search":this.searchMaterials.bind(this),"calendar.create":this.createCalendarEvent.bind(this),"analytics.show":this.showAnalytics.bind(this),"plan.create":this.createStudyPlan.bind(this),"productivity.start":this.startProductivitySession.bind(this),analyze_course_materials:this.analyzeCourseMaterials.bind(this),check_completion_status:this.checkCompletionStatus.bind(this),estimate_time_needed:this.estimateTimeNeeded.bind(this),create_study_plan:this.createStudyPlanAction.bind(this),schedule_tasks:this.scheduleTasks.bind(this),setup_focus_mode:this.setupFocusMode.bind(this),choose_next_task:this.chooseNextTask.bind(this),begin_pomodoro:this.beginPomodoro.bind(this),track_session:this.trackSession.bind(this)};async executeCommand(e,t){let s=`cmd_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;return e.multiStep&&e.steps?this.executeMultiStepCommand(s,e,t):this.executeSingleCommand(e,t)}async executeSingleCommand(e,t){let s=this.API_BRIDGES[e.intent];if(!s)return{success:!1,message:`I don't know how to handle "${e.intent}" commands yet.`};try{return await s(e.entities,t)}catch(e){return console.error("Command execution error:",e),{success:!1,message:"Sorry, I encountered an error while executing that command. Please try again."}}}async executeMultiStepCommand(e,t,s){if(!t.steps)return{success:!1,message:"No steps defined for multi-step command"};let a={commandId:e,currentStep:0,totalSteps:t.steps.length,results:{},status:"running"};this.executionStates.set(e,a);try{for(let e=0;e<t.steps.length;e++){let r=t.steps[e];if(a.currentStep=e,r.dependsOn){let e=r.dependsOn.filter(e=>!a.results[e]);if(e.length>0){a.status="failed",a.error=`Missing dependencies: ${e.join(", ")}`;break}}let n=await this.executeStep(r,a.results,s);if(!n.success){a.status="failed",a.error=n.message;break}if(a.results[r.id]=n.data,n.requiresUserInput)return a.status="waiting",{success:!0,message:n.userInputPrompt||"Please provide additional information",requiresUserInput:!0,nextStep:r.id}}return a.status="completed",{success:!0,message:this.generateCompletionMessage(t,a.results),data:a.results}}catch(e){return a.status="failed",a.error=e instanceof Error?e.message:"Unknown error",{success:!1,message:"Command execution failed. Please try again."}}}async executeStep(e,t,s){let a=this.resolveTemplateVariables(e.params,t),r=this.API_BRIDGES[e.action];return r?await r(a,s):{success:!1,message:`Unknown action: ${e.action}`}}resolveTemplateVariables(e,t){let s={...e};for(let[e,a]of Object.entries(s))if("string"==typeof a&&a.startsWith("{{")&&a.endsWith("}}")){let[r,n]=a.slice(2,-2).split(".");t[r]&&(s[e]=n?t[r][n]:t[r])}return s}async createTask(e,t){try{let s={userId:t.userId,title:e.title,description:e.description||"",priority:e.priority||"medium",status:"todo",dueDate:e.dueDate,course:e.course,estimatedMinutes:e.duration||30,tags:e.tags||[],subtasks:[],links:[]},a=await (0,l.createTask)(s);return{success:!0,message:`Created task "${e.title}"${e.dueDate?` due ${e.dueDate.toLocaleDateString()}`:""}`,data:{taskId:a}}}catch(e){return{success:!1,message:"Failed to create task. Please try again."}}}async completeTask(e,t){try{let s=(await (0,l.getTasks)(t.userId)).find(t=>t.title.toLowerCase().includes(e.taskName.toLowerCase()));if(!s)return{success:!1,message:`I couldn't find a task named "${e.taskName}". Could you be more specific?`};return await (0,l.updateTask)(s.id,{status:"done",completedAt:new Date}),{success:!0,message:`Marked "${s.title}" as completed! Great job! ðŸŽ‰`,data:{taskId:s.id}}}catch(e){return{success:!1,message:"Failed to complete task. Please try again."}}}async listTasks(e,t){try{let s=await (0,l.getTasks)(t.userId);if(e.filter&&(e.filter.course&&(s=s.filter(t=>t.course?.toLowerCase().includes(e.filter.course.toLowerCase()))),e.filter.dueDate)){let t=new Date(e.filter.dueDate);s=s.filter(e=>e.dueDate&&new Date(e.dueDate)<=t)}let a=s.filter(e=>"done"!==e.status);if(0===a.length)return{success:!0,message:"You have no pending tasks! ðŸŽ‰",data:{tasks:[]}};let r=a.slice(0,5).map(e=>`- ${e.title}${e.dueDate?` (due ${new Date(e.dueDate).toLocaleDateString()})`:""}`).join("\n");return{success:!0,message:`Here are your ${e.filter?"filtered ":""}tasks:
${r}${a.length>5?`
...and ${a.length-5} more`:""}`,data:{tasks:a}}}catch(e){return{success:!1,message:"Failed to retrieve tasks. Please try again."}}}async startStudySession(e,t){return{success:!0,message:`Starting a ${e.duration||25} minute study session${e.task?` for "${e.task}"`:""}. Focus mode activated! ðŸš€`,data:{duration:e.duration||25,task:e.task}}}async completeHabit(e,t){try{let s=(await (0,l.getHabits)(t.userId)).find(t=>t.name.toLowerCase().includes(e.habitName.toLowerCase()));if(!s)return{success:!1,message:`I couldn't find a habit named "${e.habitName}". Could you be more specific?`};return await (0,l.toggleHabitCompletion)(s.id,new Date().toISOString().split("T")[0]),{success:!0,message:`Completed "${s.name}" for today! Keep up the great work! ðŸ’ª`,data:{habitId:s.id}}}catch(e){return{success:!1,message:"Failed to complete habit. Please try again."}}}async listHabits(e,t){try{let e=await (0,l.getHabits)(t.userId),s=new Date().toISOString().split("T")[0],a=e.map(e=>{let t=e.completions.some(e=>e.date===s&&e.completed);return`- ${e.name}: ${t?"âœ… Done":"â³ Pending"} (${e.currentStreak} day streak)`}).join("\n");return{success:!0,message:`Here's your habit status:
${a}`,data:{habits:e}}}catch(e){return{success:!1,message:"Failed to retrieve habits. Please try again."}}}async getCourseInfo(e,t){try{let s=(await (0,l.getCourses)(t.userId)).find(t=>t.name.toLowerCase().includes(e.courseName.toLowerCase()));if(!s)return{success:!1,message:`I couldn't find a course named "${e.courseName}".`};let a=`Course: ${s.name}${s.code?` (${s.code})`:""}${s.professor?`
Professor: ${s.professor}`:""}${s.examDate?`
Next Exam: ${new Date(s.examDate).toLocaleDateString()}`:""}`;return{success:!0,message:a,data:{course:s}}}catch(e){return{success:!1,message:"Failed to retrieve course information."}}}async searchMaterials(e,t){try{var s;let a=(s=t.userId,p&&p.userId===s||(p=new h(s)),p);await a.initialize();let r=e.topic||e.query||"",n=await a.search(r,{limit:5,types:e.type?[e.type]:void 0,tags:e.tags?e.tags.split(",").map(e=>e.trim()):void 0});if(0===n.length)return{success:!1,message:`I couldn't find any materials related to "${r}". ${a.getMaterialCount()>0?"Try a different search term or check your materials.":"You haven't uploaded any materials yet."}`};let i=n.map(e=>`- ${e.name} (${e.type}) - ${e.excerpt}`).join("\n");return{success:!0,message:`Found ${n.length} material${n.length>1?"s":""} related to "${r}":
${i}`,data:{materials:n}}}catch(e){return console.error("Material search error:",e),{success:!1,message:"Failed to search materials. Please try again."}}}async createCalendarEvent(e,t){try{let s={userId:t.userId,title:e.title,type:"meeting",startTime:e.dateTime||new Date,endTime:new Date((e.dateTime||new Date).getTime()+36e5),isAllDay:!1,isRecurring:!1,description:e.description||"",color:"#3b82f6"},a=await (0,l.createCalendarEvent)(s);return{success:!0,message:`Scheduled "${e.title}" for ${e.dateTime?.toLocaleString()||"now"}`,data:{eventId:a}}}catch(e){return{success:!1,message:"Failed to schedule event."}}}async showAnalytics(e,t){try{let e=new Date().toISOString().split("T")[0],s=await (0,l.getDailyStats)(t.userId,e);if(!s)return{success:!0,message:"You haven't logged any study time today yet. Let's get started! ðŸ“š",data:{stats:null}};let a=`Today's Progress:
ðŸ“– Study Time: ${Math.round(s.totalStudyMinutes/60*10)/10}h
âœ… Tasks Completed: ${s.taskCompleted}
ðŸŽ¯ Pomodoro Sessions: ${s.pomodoroCompleted}
ðŸ”¥ Current Streak: ${s.streakDay} days`;return{success:!0,message:a,data:{stats:s}}}catch(e){return{success:!1,message:"Failed to retrieve analytics."}}}async createStudyPlan(e,t){return{success:!0,message:"Starting study plan creation...",data:{examName:e.examName,days:e.days}}}async startProductivitySession(e,t){return{success:!0,message:"Initiating productivity session...",data:{duration:e.duration}}}async analyzeCourseMaterials(e,t){try{let s=(await (0,l.getCourses)(t.userId)).find(t=>t.name.toLowerCase().includes(e.examName.toLowerCase()));return{success:!0,message:"Analyzed course materials",data:{course:s,materials:s?.syllabus||[]}}}catch(e){return{success:!1,message:"Failed to analyze course materials"}}}async checkCompletionStatus(e,t){try{let s=(await (0,l.getTasks)(t.userId)).filter(t=>t.course?.toLowerCase().includes(e.course.toLowerCase())),a=s.filter(e=>"done"===e.status);return{success:!0,message:"Checked completion status",data:{completed:a.length,total:s.length,progress:a.length/s.length}}}catch(e){return{success:!1,message:"Failed to check completion status"}}}async estimateTimeNeeded(e,t){let s=Math.max(2*e.days,10);return{success:!0,message:"Estimated study time needed",data:{estimatedHours:s,dailyHours:s/e.days}}}async createStudyPlanAction(e,t){try{let t={id:`plan_${Date.now()}`,examName:e.course,days:e.days,dailyTasks:Math.ceil(10/e.days),focusAreas:["Review notes","Practice problems","Take breaks","Light review"]};return{success:!0,message:"Generated study plan",data:{plan:t,planId:`plan_${Date.now()}`}}}catch(e){return{success:!1,message:"Failed to generate study plan"}}}async scheduleTasks(e,t){return{success:!0,message:"Scheduled study tasks",data:{taskCount:5}}}async setupFocusMode(e,t){return{success:!0,message:"Focus mode activated - notifications silenced, distractions minimized",data:{focusMode:!0}}}async chooseNextTask(e,t){try{let e=(await (0,l.getTasks)(t.userId)).filter(e=>"done"!==e.status).sort((e,t)=>{let s={urgent:0,high:1,medium:2,low:3};return s[e.priority]-s[t.priority]});if(0===e.length)return{success:!0,message:"No pending tasks found",data:{task:null}};return{success:!0,message:`Selected: "${e[0].title}"`,data:{task:e[0]},requiresUserInput:!0,userInputPrompt:`Would you like to work on "${e[0].title}" or choose a different task?`}}catch(e){return{success:!1,message:"Failed to select task"}}}async beginPomodoro(e,t){return{success:!0,message:`Starting ${e.duration} minute focus session on "${e.taskId?.title||"selected task"}"`,data:{sessionId:`session_${Date.now()}`,duration:e.duration}}}async trackSession(e,t){return{success:!0,message:"Session tracking active - I'll keep you motivated!",data:{tracking:!0}}}generateCompletionMessage(e,t){switch(e.intent){case"plan.create":return`âœ… Study plan created! I've scheduled ${t.schedule_tasks?.taskCount||5} study sessions over ${e.entities.days} days. Check your planner for details.`;case"productivity.start":return`ðŸš€ Productivity session started! ${e.entities.duration} minutes of focused work ahead. You've got this!`;default:return"âœ… Command completed successfully!"}}getExecutionState(e){return this.executionStates.get(e)||null}cancelExecution(e){let t=this.executionStates.get(e);t&&(t.status="failed",t.error="Cancelled by user")}}let g=null;var f=e.i(54858),y=e.i(41240),x=e.i(75254);let w=(0,x.default)("Wifi",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]]),v=(0,x.default)("WifiOff",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);var k=e.i(78894),_=e.i(46696);function j({context:e}={}){let d,u,{user:h}=(0,n.useAuthContext)(),p=(0,r.useRouter)(),x=(0,r.usePathname)(),[S,N]=(0,a.useState)(!1),[C,$]=(0,a.useState)(!1),[I,D]=(0,a.useState)([]),[T,R]=(0,a.useState)(""),[L,A]=(0,a.useState)(!1),[E,P]=(0,a.useState)({currentPage:e?.currentPage||x,conversationHistory:[],userMaterials:[],userDecks:[]}),[M,F]=(0,a.useState)(!1),[z,O]=(0,a.useState)(!1),[q,H]=(0,a.useState)([]),[B,W]=(0,a.useState)(!1),[G,U]=(0,a.useState)(""),[V,Y]=(0,a.useState)(!1),[K,Q]=(0,a.useState)(!1),[J,X]=(0,a.useState)(!1),[Z,ee]=(0,a.useState)([]),[et,es]=(0,a.useState)(null),ea=(0,a.useRef)(null),er=(0,a.useRef)(null);(0,a.useEffect)(()=>{let e=async()=>{X(await (0,f.isBackendAvailable)())};e();let t=setInterval(e,3e4);return()=>clearInterval(t)},[]);let{state:en,startListening:ei,stopListening:eo,resetTranscript:ec}=function(e={}){let{continuous:t=!1,language:s="en-US",onResult:r,onError:n,onStart:i,onEnd:o}=e,[c,l]=(0,a.useState)({isListening:!1,transcript:"",interimTranscript:"",error:null,isSupported:!1}),d=(0,a.useRef)(null),u=(0,a.useRef)(""),m=(0,a.useRef)(r),h=(0,a.useRef)(n),p=(0,a.useRef)(i),b=(0,a.useRef)(o);(0,a.useEffect)(()=>{m.current=r,h.current=n,p.current=i,b.current=o}),(0,a.useEffect)(()=>{let e=window.SpeechRecognition||window.webkitSpeechRecognition;if(!e)return void l(e=>({...e,isSupported:!1}));l(e=>({...e,isSupported:!0}));let a=new e;return a.continuous=t,a.interimResults=!0,a.lang=s,a.onstart=()=>{l(e=>({...e,isListening:!0,error:null})),p.current?.()},a.onend=()=>{l(e=>({...e,isListening:!1})),b.current?.()},a.onerror=e=>{let t=function(e){switch(e){case"no-speech":return"No speech detected. Please try again.";case"audio-capture":return"No microphone found. Please check your audio settings.";case"not-allowed":return"Microphone access denied. Please allow microphone access.";case"network":return"Network error. Please check your connection.";case"aborted":return"Speech recognition was aborted.";case"language-not-supported":return"Language not supported.";case"service-not-allowed":return"Speech recognition service not allowed.";default:return`Speech recognition error: ${e}`}}(e.error);l(e=>({...e,error:t,isListening:!1})),h.current?.(t)},a.onresult=e=>{let t="",s=u.current;for(let a=e.resultIndex;a<e.results.length;a++){let r=e.results[a],n=r[0].transcript;r.isFinal?(u.current=s+=n+" ",m.current?.(n.trim(),!0)):(t+=n,m.current?.(n,!1))}l(e=>({...e,transcript:s.trim(),interimTranscript:t}))},d.current=a,()=>{a.abort()}},[t,s]);let g=(0,a.useCallback)(()=>{if(d.current)try{u.current="",l(e=>({...e,transcript:"",interimTranscript:"",error:null})),d.current.start()}catch(e){console.error("Error starting speech recognition:",e)}},[]);return{state:c,startListening:g,stopListening:(0,a.useCallback)(()=>{if(d.current)try{d.current.stop()}catch(e){console.error("Error stopping speech recognition:",e)}},[]),resetTranscript:(0,a.useCallback)(()=>{u.current="",l(e=>({...e,transcript:"",interimTranscript:""}))},[])}}({continuous:!0,onResult:(e,t)=>{B?(U(s=>s+(t?e:"")),t&&el(`Voice note added: "${e}"`)):t&&e.trim()&&(R(e.trim()),eu(e.trim()))},onError:e=>{el(`Voice recognition error: ${e}`)}});(0,a.useEffect)(()=>{!async function(){if(h)try{let[e,t]=await Promise.all([(0,l.getMaterials)(h.uid),(0,l.getFlashcardDecks)(h.uid)]);H(t),P({userId:h.uid,currentPage:x,userMaterials:e.map(e=>({id:e.id,title:e.title,subject:e.subject})),userDecks:t.map(e=>({id:e.id,name:e.name}))})}catch(e){console.error("Error loading context:",e)}}()},[h,x]),(0,a.useEffect)(()=>{P(e=>({...e,currentPage:x}))},[x]),(0,a.useEffect)(()=>{ea.current?.scrollIntoView({behavior:"smooth"})},[I]),(0,a.useEffect)(()=>{if(!i())return;let e=null,t=()=>{e||((e=new(window.SpeechRecognition||window.webkitSpeechRecognition)).continuous=!0,e.interimResults=!1,e.lang="en-US",e.onresult=t=>{let s=t.results[t.results.length-1][0].transcript.toLowerCase().trim();(s.includes("gemini")||s.includes("jarvis")||s.includes("hey jarvis"))&&(N(!0),Q(!0),e.stop(),setTimeout(()=>{ei(),O(!0)},500))},e.onend=()=>{Q(!1),setTimeout(t,1e3)},e.start())};return S||t(),()=>{e&&e.stop()}},[S,ei]),(0,a.useEffect)(()=>()=>{c()},[]),(0,a.useEffect)(()=>{S||c()},[S]),(0,a.useEffect)(()=>{S&&!M&&(F(!0),setTimeout(()=>{let e,t,s,a,r,n,i,o,c,l;el((e=ed(),t=new Date().getHours(),s=[],(e.focus_minutes_today||0)>0&&s.push(`${e.focus_minutes_today}m focused`),(e.streak_days||0)>0&&s.push(`${e.streak_days} day streak`),a=s.length>0?`ðŸ“Š ${s.join(" â€¢ ")}`:"",r="",n=e.focus_minutes_today||0,i=e.overdue_tasks||0,o=e.urgent_task_count||0,c=e.flashcards_due||0,l=e.streak_days||0,r=i>0?`âš ï¸ ${i} overdue task${i>1?"s":""}. Let's catch up.`:o>0&&0===n?`ðŸŽ¯ ${o} urgent task${o>1?"s":""}. Start a focus session?`:e.days_until_exam&&e.days_until_exam<=7?`ðŸ“… ${e.days_until_exam} day${e.days_until_exam>1?"s":""} until exam. Need a revision plan?`:c>10?`ðŸƒ ${c} flashcards due. Review them now?`:t>=20&&0===n&&l>0?`ðŸ”¥ Your streak is at risk. 15 minutes will save it.`:0===n&&t>=8&&t<=22?"Ready to start a focus session?":"What should we work on?",`${J?"ðŸŸ¢ AI online":"ðŸŸ¡ Offline mode"}${a?` â€¢ ${a}`:""}

${r}`))},500))},[S,M,e]),(0,a.useEffect)(()=>{S&&er.current?.focus()},[S]),(0,a.useEffect)(()=>{O(en.isListening)},[en.isListening]);let el=(0,a.useCallback)((e,t)=>{let s={id:Date.now().toString(),role:"assistant",content:e,timestamp:new Date,action:t};D(e=>[...e,s]);let a=e;if(V){let t=e.split(/[.!?]/)[0];a=t&&t.length>10?t+(t.length<e.length?"...":""):e.length>100?e.substring(0,100)+"...":e}try{o(a,{rate:1,pitch:1,volume:.7}).catch(()=>{})}catch{}return s},[V]),ed=(0,a.useCallback)(()=>{let t,s,a=new Date().toISOString().split("T")[0],r=0,n=e?.habits?.length||0;e?.habits?.forEach(e=>{let t=e.completions?.find(e=>e.date===a);t?.completed&&r++});let i=0,o=0,c=new Date;return e?.todayTasks?.forEach(e=>{"done"!==e.status&&("urgent"===e.priority&&i++,e.dueDate&&(e.dueDate.toDate?e.dueDate.toDate():new Date(e.dueDate))<c&&o++)}),e?.courses?.forEach(e=>{if(e.examDate){let a=Math.ceil((new Date(e.examDate).getTime()-c.getTime())/864e5);a>0&&(void 0===t||a<t)&&(t=a,s=e.name)}}),{focus_minutes_today:e?.dailyStats?.totalStudyMinutes||0,target_focus_minutes:120,habits_completed_today:r,total_habits_today:n,flashcards_due:e?.flashcardsDue||0,streak_days:e?.dailyStats?.streakDay||0,urgent_task_count:i,overdue_tasks:o,current_course:s,days_until_exam:t,recent_failures:[]}},[e]),eu=async(t,s=!1)=>{let a=(t||T).trim();if(!a||L)return;R(""),A(!0),c(),es(null);let r={id:Date.now().toString(),role:"user",content:a,timestamp:new Date};D(e=>[...e,r]);try{if(J)try{let e=ed(),t=await (0,f.intelligentAsk)({message:a,context:e,use_memory:!0,skip_intervention:s});if(t.intervention?.should_intervene&&!s){es({message:t.intervention.message,originalRequest:a});let e={id:Date.now().toString(),role:"assistant",content:t.answer,timestamp:new Date,mode:t.mode,isIntervention:!0};D(t=>[...t,e]);try{o(t.answer,{rate:1,pitch:1,volume:.7}).catch(()=>{})}catch{}t.suggestions&&ee(t.suggestions),A(!1);return}let r=t.answer;t.memory_used&&("strong"===t.memory_quality?r+=`

ðŸ’¡ _Based on ${t.chunks_used} source${t.chunks_used>1?"s":""} from your materials_`:"weak"===t.memory_quality&&(r+=`

âš ï¸ _Limited material found on this topic. Consider adding more notes._`));let n={id:Date.now().toString(),role:"assistant",content:r,timestamp:new Date,mode:t.mode};D(e=>[...e,n]);let i=t.answer.split(/[.!?]/)[0],c=V&&i.length>10?i+"...":t.answer.length>150?t.answer.substring(0,150)+"...":t.answer;try{o(c,{rate:1,pitch:1,volume:.7}).catch(()=>{})}catch{}"flashcards"===t.mode&&t.structured_output&&Array.isArray(t.structured_output)&&_.toast.success(`Created ${t.structured_output.length} flashcards!`),t.suggestions&&ee(t.suggestions),A(!1);return}catch(e){console.warn("Intelligent AI failed, falling back to legacy:",e)}let t=a.toLowerCase(),r=t.includes("flashcard")||t.includes("flash card"),n=t.includes("study plan")||t.includes("learning plan")||t.includes("create a plan");if(J)try{if(r){let e=a.replace(/flashcard|flash card|create|generate|make|for|about|on/gi,"").trim()||"general knowledge";_.toast.loading("Generating flashcards...",{id:"flashcards"});let t=await (0,f.generateFlashcards)({topic:e,num_cards:5,use_memory:!0});_.toast.success(`Created ${t.count} flashcards!`,{id:"flashcards"}),el(`ðŸƒ Created ${t.count} flashcards on "${e}".

Preview:
${t.flashcards.slice(0,2).map(e=>`Q: ${e.question}
A: ${e.answer}`).join("\n\n")}${t.count>2?`

...and ${t.count-2} more.`:""}`,{type:"navigate",data:{path:"/flashcards"}});return}if(n){let e=a.replace(/study plan|learning plan|create|a|plan|for|about|on/gi,"").trim()||"general studies";_.toast.loading("Creating study plan...",{id:"studyplan"});let t=await (0,f.createStudyPlan)({subject:e,days:7,retrieve_materials:!0});_.toast.success("Plan created!",{id:"studyplan"}),el(`ðŸ“‹ ${t.days}-day plan for ${t.subject}:

${t.plan}${t.materials_used>0?`

_Used ${t.materials_used} of your materials._`:""}`);return}{let e=await (0,f.askAI)({question:a,use_memory:!0,top_k:5}),t=e.answer;e.context_used&&e.sources_count>0&&(t+=`

ðŸ’¡ _Based on ${e.sources_count} source${e.sources_count>1?"s":""} from your materials_`),el(t);return}}catch(e){console.error("Backend AI error:",e),_.toast.dismiss("ai-thinking"),_.toast.dismiss("flashcards"),_.toast.dismiss("studyplan")}let i=m(),c=(g||(g=new b),g),l={userId:h?.uid||"",currentPage:x,recentActions:[],userPreferences:{},availableData:{tasks:e?.todayTasks,courses:e?.courses,habits:e?.habits}},d=i.parseCommand(a,l),u=await c.executeCommand(d,l);el(u.message),u.data?.path&&setTimeout(()=>p.push(u.data.path),1e3)}catch(e){el(`Error: ${e.message}. Try again.`)}finally{A(!1)}};return(!function(e){let t=[];switch(e.currentPage){case"flashcards":t.push("Create flashcards about..."),t.push("Quiz me on my decks");break;case"materials":t.push("Summarize my notes"),t.push("Create flashcards from materials");break;case"planner":t.push("What's due this week?"),t.push("Add a study task");break;default:t.push("Create flashcards"),t.push("Quiz me"),t.push("Explain a concept")}}(E),h)?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("button",{onClick:()=>N(!S),"aria-label":"Open AI Coach",className:`jsx-97cb4c3eb5ceaed4 fixed bottom-6 right-6 z-50 group transition-all duration-300 ${S?"scale-0 opacity-0":"scale-100 opacity-100"}`,children:(0,t.jsxs)("div",{className:"jsx-97cb4c3eb5ceaed4 relative flex items-center gap-2 px-4 py-2.5 rounded-full bg-slate-800 border border-slate-700 shadow-lg hover:bg-slate-700 transition-all",children:[(0,t.jsx)("div",{className:`jsx-97cb4c3eb5ceaed4 w-2 h-2 rounded-full ${J?"bg-green-500":"bg-amber-500"}`}),(0,t.jsx)("span",{className:"jsx-97cb4c3eb5ceaed4 text-sm font-medium text-white",children:"Ask AI"})]})}),(0,t.jsx)("div",{className:`jsx-97cb4c3eb5ceaed4 fixed z-50 transition-all duration-500 ease-out ${C?"inset-4":"bottom-6 right-6 w-[420px] max-w-[calc(100vw-3rem)]"} ${S?"opacity-100 scale-100 translate-y-0":"opacity-0 scale-95 translate-y-4 pointer-events-none"}`,children:(0,t.jsxs)("div",{className:`jsx-97cb4c3eb5ceaed4 relative h-full ${C?"":"max-h-[600px]"} bg-white/95 backdrop-blur-xl rounded-2xl border border-gray-200/50 shadow-2xl overflow-hidden flex flex-col`,children:[(0,t.jsx)("div",{className:"jsx-97cb4c3eb5ceaed4 absolute inset-0 rounded-2xl overflow-hidden pointer-events-none",children:(0,t.jsx)("div",{className:"jsx-97cb4c3eb5ceaed4 absolute inset-0 bg-gradient-to-r from-cyan-500/0 via-cyan-500/20 to-cyan-500/0 animate-shimmer"})}),(0,t.jsxs)("div",{className:"jsx-97cb4c3eb5ceaed4 relative px-5 py-4 border-b border-gray-200/50 bg-gradient-to-r from-blue-50/80 via-indigo-50/60 to-blue-50/80",children:[(0,t.jsxs)("div",{className:"jsx-97cb4c3eb5ceaed4 flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"jsx-97cb4c3eb5ceaed4 flex items-center gap-3",children:[(0,t.jsxs)("div",{className:"jsx-97cb4c3eb5ceaed4 relative",children:[(0,t.jsx)("div",{className:"jsx-97cb4c3eb5ceaed4 w-10 h-10 rounded-full bg-gradient-to-br from-blue-500 to-indigo-600 flex items-center justify-center",children:(0,t.jsx)("div",{className:`jsx-97cb4c3eb5ceaed4 w-6 h-6 rounded-full bg-blue-300/80 ${L?"animate-pulse":""}`,children:(0,t.jsx)("div",{className:"jsx-97cb4c3eb5ceaed4 w-full h-full rounded-full bg-gradient-to-br from-white/60 to-transparent"})})}),L&&(0,t.jsx)("div",{className:"jsx-97cb4c3eb5ceaed4 absolute inset-0 rounded-full border-2 border-blue-400 animate-ping"})]}),(0,t.jsxs)("div",{className:"jsx-97cb4c3eb5ceaed4",children:[(0,t.jsx)("h3",{className:"jsx-97cb4c3eb5ceaed4 font-semibold text-blue-600 text-sm",children:"AI Coach"}),(0,t.jsx)("p",{className:"jsx-97cb4c3eb5ceaed4 text-[10px] text-slate-500",children:J?"Online":"Offline"})]})]}),(0,t.jsxs)("div",{className:"jsx-97cb4c3eb5ceaed4 flex items-center gap-2",children:[(0,t.jsxs)("div",{className:`jsx-97cb4c3eb5ceaed4 flex items-center gap-1.5 px-2 py-1 rounded-full ${J?"bg-green-50 border border-green-200/50":"bg-amber-50 border border-amber-200/50"}`,children:[J?(0,t.jsx)(w,{className:"w-3 h-3 text-green-500"}):(0,t.jsx)(v,{className:"w-3 h-3 text-amber-500"}),(0,t.jsx)("span",{className:`jsx-97cb4c3eb5ceaed4 text-[10px] font-mono ${J?"text-green-600":"text-amber-600"}`,children:J?"AI ONLINE":"LOCAL MODE"})]}),(0,t.jsx)("button",{onClick:()=>$(!C),title:C?"Exit fullscreen":"Enter fullscreen",className:"jsx-97cb4c3eb5ceaed4 p-2 hover:bg-blue-100 rounded-lg transition-colors text-blue-600",children:C?(0,t.jsx)("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",className:"jsx-97cb4c3eb5ceaed4 w-4 h-4",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12",className:"jsx-97cb4c3eb5ceaed4"})}):(0,t.jsx)("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",className:"jsx-97cb4c3eb5ceaed4 w-4 h-4",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4",className:"jsx-97cb4c3eb5ceaed4"})})}),(0,t.jsx)("button",{onClick:()=>N(!1),title:"Close JARVIS",className:"jsx-97cb4c3eb5ceaed4 p-2 hover:bg-red-100 rounded-lg transition-colors text-red-600",children:(0,t.jsx)("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",className:"jsx-97cb4c3eb5ceaed4 w-4 h-4",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12",className:"jsx-97cb4c3eb5ceaed4"})})})]})]}),(0,t.jsx)("div",{className:"jsx-97cb4c3eb5ceaed4 mt-2 text-xs text-slate-500 px-3 py-1.5 bg-slate-50/50 rounded-lg",children:"Ask me anything â€¢ Create flashcards â€¢ Get study help"})]}),(0,t.jsx)("div",{className:"jsx-97cb4c3eb5ceaed4 px-4 py-2 border-b border-gray-200/50 bg-slate-50/30",children:(0,t.jsxs)("div",{className:"jsx-97cb4c3eb5ceaed4 flex items-center gap-2 text-xs",children:[(0,t.jsx)("span",{className:"jsx-97cb4c3eb5ceaed4 text-slate-500",children:"Context:"}),(0,t.jsx)("span",{className:"jsx-97cb4c3eb5ceaed4 px-2 py-0.5 bg-blue-100 text-blue-600 rounded text-[10px]",children:E.currentPage||"dashboard"}),e?.todayTasks&&e.todayTasks.length>0&&(0,t.jsxs)("span",{className:"jsx-97cb4c3eb5ceaed4 px-2 py-0.5 bg-green-100 text-green-600 rounded text-[10px]",children:[e.todayTasks.length," tasks"]})]})}),(0,t.jsxs)("div",{className:`jsx-97cb4c3eb5ceaed4 flex-1 overflow-y-auto p-4 space-y-4 ${C?"max-h-none":"max-h-80"}`,children:[(0,t.jsx)("div",{className:"jsx-97cb4c3eb5ceaed4 absolute top-20 left-4 w-px h-8 bg-gradient-to-b from-blue-400/30 to-transparent"}),(0,t.jsx)("div",{className:"jsx-97cb4c3eb5ceaed4 absolute top-20 right-4 w-px h-8 bg-gradient-to-b from-blue-400/30 to-transparent"}),0===I.length&&(0,t.jsxs)("div",{className:"jsx-97cb4c3eb5ceaed4 space-y-4",children:[(0,t.jsxs)("div",{className:"jsx-97cb4c3eb5ceaed4 space-y-3",children:[(0,t.jsx)("h4",{className:"jsx-97cb4c3eb5ceaed4 text-xs font-medium text-slate-500 uppercase tracking-wide",children:"What's Next"}),(0,t.jsx)("div",{className:"jsx-97cb4c3eb5ceaed4 space-y-2",children:Z.length>0?Z.map(e=>(0,t.jsx)("button",{onClick:()=>eu(e.action),className:`jsx-97cb4c3eb5ceaed4 w-full p-3 text-left rounded-lg border transition-all group ${"urgent"===e.priority?"bg-red-50 hover:bg-red-100 border-red-200/50":"high"===e.priority?"bg-amber-50 hover:bg-amber-100 border-amber-200/50":"bg-blue-50 hover:bg-blue-100 border-blue-200/50"}`,children:(0,t.jsxs)("p",{className:`jsx-97cb4c3eb5ceaed4 text-sm font-medium ${"urgent"===e.priority?"text-red-700":"high"===e.priority?"text-amber-700":"text-slate-700"}`,children:[e.icon," ",e.message]})},e.id)):(0,t.jsxs)(t.Fragment,{children:[e?.todayTasks&&e.todayTasks.some(e=>"urgent"===e.priority||"high"===e.priority)?(0,t.jsx)("button",{onClick:()=>eu("Help me prioritize my tasks and start a focus session"),className:"jsx-97cb4c3eb5ceaed4 w-full p-3 bg-amber-50 hover:bg-amber-100 text-left rounded-lg border border-amber-200/50 transition-all",children:(0,t.jsx)("p",{className:"jsx-97cb4c3eb5ceaed4 text-sm font-medium text-amber-700",children:"ðŸŽ¯ Start focus session on priority tasks"})}):(0,t.jsx)("button",{onClick:()=>eu("Help me plan my next study session"),className:"jsx-97cb4c3eb5ceaed4 w-full p-3 bg-blue-50 hover:bg-blue-100 text-left rounded-lg border border-blue-200/50 transition-all",children:(0,t.jsx)("p",{className:"jsx-97cb4c3eb5ceaed4 text-sm text-slate-700",children:"ðŸ“‹ Plan next study session"})}),(0,t.jsx)("button",{onClick:()=>eu("Generate flashcards from my recent notes"),className:"jsx-97cb4c3eb5ceaed4 w-full p-3 bg-purple-50 hover:bg-purple-100 text-left rounded-lg border border-purple-200/50 transition-all",children:(0,t.jsx)("p",{className:"jsx-97cb4c3eb5ceaed4 text-sm text-slate-700",children:"ðŸƒ Generate flashcards"})})]})})]}),!J&&(0,t.jsxs)("div",{className:"jsx-97cb4c3eb5ceaed4 p-3 bg-amber-50 rounded-lg border border-amber-200/50 text-xs text-amber-700",children:[(0,t.jsx)("p",{className:"jsx-97cb4c3eb5ceaed4 font-medium",children:"AI features limited"}),(0,t.jsx)("p",{className:"jsx-97cb4c3eb5ceaed4 text-amber-600 mt-0.5",children:"Start the backend to enable AI-powered planning & flashcard generation."})]})]}),I.map(e=>(0,t.jsx)("div",{className:`jsx-97cb4c3eb5ceaed4 flex ${"user"===e.role?"justify-end":"justify-start"}`,children:(0,t.jsxs)("div",{className:`jsx-97cb4c3eb5ceaed4 max-w-[85%] ${"user"===e.role?"bg-gradient-to-r from-blue-500 to-indigo-600 text-white rounded-2xl rounded-br-md shadow-sm":e.isIntervention?"bg-amber-50 border border-amber-200 text-gray-800 rounded-2xl rounded-bl-md shadow-sm":"bg-white/90 border border-gray-200/50 text-gray-800 rounded-2xl rounded-bl-md shadow-sm"} px-4 py-3 relative overflow-hidden`,children:["assistant"===e.role&&(0,t.jsx)("div",{className:`jsx-97cb4c3eb5ceaed4 absolute top-0 left-0 w-full h-px bg-gradient-to-r from-transparent ${e.isIntervention?"via-amber-400/50":"via-blue-400/30"} to-transparent`}),"assistant"===e.role&&(0,t.jsxs)("div",{className:"jsx-97cb4c3eb5ceaed4 flex items-center gap-2 mb-1",children:[e.isIntervention&&(0,t.jsx)(k.AlertTriangle,{className:"w-3 h-3 text-amber-500"}),(0,t.jsx)("span",{className:`jsx-97cb4c3eb5ceaed4 text-[10px] font-mono ${e.isIntervention?"text-amber-600":"text-blue-600"}`,children:e.isIntervention?"INTERVENTION":e.mode?.toUpperCase()||"AI"}),(0,t.jsx)("span",{className:"jsx-97cb4c3eb5ceaed4 text-[10px] text-gray-500",children:e.timestamp.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),(0,t.jsx)("p",{className:"jsx-97cb4c3eb5ceaed4 text-sm whitespace-pre-wrap leading-relaxed",children:e.content}),e.action?.type==="show_flashcards"&&e.action.data?.flashcards&&(0,t.jsx)("div",{className:"jsx-97cb4c3eb5ceaed4 mt-3 pt-3 border-t border-gray-200/50",children:(0,t.jsxs)("p",{className:"jsx-97cb4c3eb5ceaed4 text-xs text-gray-600 font-mono",children:[e.action.data.flashcards.length," FLASHCARDS GENERATED"]})})]})},e.id)),et&&!L&&(0,t.jsx)("div",{className:"jsx-97cb4c3eb5ceaed4 flex justify-center",children:(0,t.jsx)("button",{onClick:()=>{et&&(eu(et.originalRequest,!0),es(null))},className:"jsx-97cb4c3eb5ceaed4 px-4 py-2 text-xs text-slate-600 bg-slate-100 hover:bg-slate-200 rounded-full transition-colors",children:"Continue with original request anyway â†’"})}),L&&(0,t.jsx)("div",{className:"jsx-97cb4c3eb5ceaed4 flex justify-start",children:(0,t.jsxs)("div",{className:"jsx-97cb4c3eb5ceaed4 bg-white/90 border border-gray-200/50 rounded-2xl rounded-bl-md px-4 py-3 shadow-sm",children:[(0,t.jsx)("div",{className:"jsx-97cb4c3eb5ceaed4 flex items-center gap-2",children:(0,t.jsx)("span",{className:"jsx-97cb4c3eb5ceaed4 text-[10px] font-mono text-blue-600",children:"PROCESSING"})}),(0,t.jsxs)("div",{className:"jsx-97cb4c3eb5ceaed4 flex items-center gap-1 mt-2",children:[(0,t.jsx)("div",{style:{animationDelay:"0ms"},className:"jsx-97cb4c3eb5ceaed4 w-2 h-2 bg-blue-400 rounded-full animate-bounce"}),(0,t.jsx)("div",{style:{animationDelay:"150ms"},className:"jsx-97cb4c3eb5ceaed4 w-2 h-2 bg-blue-400 rounded-full animate-bounce"}),(0,t.jsx)("div",{style:{animationDelay:"300ms"},className:"jsx-97cb4c3eb5ceaed4 w-2 h-2 bg-blue-400 rounded-full animate-bounce"})]})]})}),(0,t.jsx)("div",{ref:ea,className:"jsx-97cb4c3eb5ceaed4"})]}),B&&(0,t.jsxs)("div",{className:"jsx-97cb4c3eb5ceaed4 p-4 border-t border-gray-200/50 bg-gray-50/50",children:[(0,t.jsxs)("div",{className:"jsx-97cb4c3eb5ceaed4 flex items-center justify-between mb-3",children:[(0,t.jsx)("h3",{className:"jsx-97cb4c3eb5ceaed4 text-sm font-mono text-blue-600",children:"VOICE NOTES"}),(0,t.jsxs)("div",{className:"jsx-97cb4c3eb5ceaed4 flex gap-2",children:[(0,t.jsx)("button",{onClick:()=>U(""),className:"jsx-97cb4c3eb5ceaed4 text-xs px-2 py-1 bg-red-100 text-red-600 rounded hover:bg-red-200",children:"CLEAR"}),(0,t.jsx)("button",{onClick:()=>W(!1),className:"jsx-97cb4c3eb5ceaed4 text-xs px-2 py-1 bg-gray-200 text-gray-700 rounded hover:bg-gray-300",children:"EXIT"})]})]}),(0,t.jsx)("div",{className:"jsx-97cb4c3eb5ceaed4 bg-white/80 border border-gray-200/50 rounded-lg p-3 min-h-[100px] text-sm text-gray-800 whitespace-pre-wrap",children:G||"Start speaking to add voice notes..."})]}),(0,t.jsxs)("div",{className:"jsx-97cb4c3eb5ceaed4 relative p-4 border-t border-gray-200/50 bg-gray-50/80",children:[(0,t.jsxs)("div",{className:"jsx-97cb4c3eb5ceaed4 mb-4",children:[(0,t.jsxs)("div",{className:"jsx-97cb4c3eb5ceaed4 flex items-center gap-2 mb-2",children:[(0,t.jsx)(y.Lightbulb,{className:"w-4 h-4 text-yellow-500"}),(0,t.jsx)("span",{className:"jsx-97cb4c3eb5ceaed4 text-xs font-medium text-gray-600 uppercase tracking-wide",children:"Suggested Commands"})]}),(0,t.jsx)("div",{className:"jsx-97cb4c3eb5ceaed4 flex flex-wrap gap-2",children:(d=m(),u={userId:h?.uid||"",currentPage:x,availableData:{tasks:e?.todayTasks,courses:e?.courses,habits:e?.habits}},d.getSuggestedCommands(u).map((e,s)=>(0,t.jsx)("button",{onClick:()=>eu(e),disabled:L,className:"jsx-97cb4c3eb5ceaed4 px-3 py-1.5 bg-gray-100 hover:bg-gray-200 text-gray-700 text-xs rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:e},s)))})]}),en.isListening&&(0,t.jsxs)("div",{className:"jsx-97cb4c3eb5ceaed4 absolute -top-12 left-1/2 -translate-x-1/2 px-4 py-2 bg-white border border-gray-300 rounded-full flex items-center gap-2 shadow-sm",children:[(0,t.jsx)("div",{className:"jsx-97cb4c3eb5ceaed4 w-3 h-3 bg-red-500 rounded-full animate-pulse"}),(0,t.jsx)("span",{className:"jsx-97cb4c3eb5ceaed4 text-xs text-gray-700 font-mono",children:en.interimTranscript||"LISTENING..."})]}),(0,t.jsxs)("form",{onSubmit:e=>{e.preventDefault(),eu()},className:"jsx-97cb4c3eb5ceaed4 flex items-center gap-3",children:[i()&&(0,t.jsx)("button",{type:"button",onClick:()=>{B?W(!1):en.isListening?eo():(W(!0),ei(),O(!0))},title:B?"Exit Voice Notes Mode":en.isListening?"Stop Listening":"Start Voice Input",className:`jsx-97cb4c3eb5ceaed4 relative p-3 rounded-xl transition-all ${B||en.isListening?"bg-red-100 text-red-600 border border-red-300":"bg-blue-50 text-blue-600 border border-blue-200 hover:bg-blue-100 hover:border-blue-300"}`,children:B||en.isListening?(0,t.jsx)("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",className:"jsx-97cb4c3eb5ceaed4 w-5 h-5",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 12a9 9 0 11-18 0 9 9 0 0118 0z M9 10a1 1 0 000 2h6a1 1 0 000-2H9z",className:"jsx-97cb4c3eb5ceaed4"})}):(0,t.jsx)("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",className:"jsx-97cb4c3eb5ceaed4 w-5 h-5",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z",className:"jsx-97cb4c3eb5ceaed4"})})}),(0,t.jsxs)("div",{className:"jsx-97cb4c3eb5ceaed4 flex-1 relative",children:[(0,t.jsx)("input",{ref:er,type:"text",value:T,onChange:e=>R(e.target.value),placeholder:"Speak or type a command...",disabled:L,className:"jsx-97cb4c3eb5ceaed4 w-full px-4 py-3 bg-white border border-gray-300 rounded-xl text-sm text-gray-800 placeholder-gray-500 focus:outline-none focus:border-blue-400 focus:ring-1 focus:ring-blue-400/30 font-mono shadow-sm"}),(0,t.jsx)("div",{className:"jsx-97cb4c3eb5ceaed4 absolute inset-0 rounded-xl pointer-events-none overflow-hidden",children:(0,t.jsx)("div",{className:"jsx-97cb4c3eb5ceaed4 absolute inset-0 bg-gradient-to-r from-blue-500/0 via-blue-500/5 to-blue-500/0 animate-shimmer"})})]}),(0,t.jsx)("button",{type:"submit",disabled:!T.trim()||L,className:"jsx-97cb4c3eb5ceaed4 p-3 bg-gradient-to-r from-blue-500 to-indigo-600 text-white rounded-xl disabled:opacity-50 disabled:cursor-not-allowed hover:from-blue-600 hover:to-indigo-700 transition-all shadow-sm",children:(0,t.jsx)("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",className:"jsx-97cb4c3eb5ceaed4 w-5 h-5",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7l5 5m0 0l-5 5m5-5H6",className:"jsx-97cb4c3eb5ceaed4"})})})]}),(0,t.jsx)("div",{className:"jsx-97cb4c3eb5ceaed4 flex items-center justify-between mt-3 text-[10px] text-gray-500 font-mono",children:(0,t.jsxs)("span",{className:"jsx-97cb4c3eb5ceaed4",children:["POWERED BY AI â€¢ ",new Date().toLocaleDateString()]})})]})]})}),(0,t.jsx)(s.default,{id:"97cb4c3eb5ceaed4",children:"@keyframes shimmer{0%{transform:translate(-100%)}to{transform:translate(100%)}}.animate-shimmer{animation:3s infinite shimmer}"})]}):null}e.s(["JarvisAssistant",()=>j],60171)}]);