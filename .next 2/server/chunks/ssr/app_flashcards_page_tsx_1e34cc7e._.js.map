{"version":3,"sources":["../../../../app/flashcards/page.tsx","../../../../lib/gemini.ts","../../../../node_modules/lucide-react/src/icons/wand-sparkles.ts"],"sourcesContent":["\"use client\"\n\nimport Layout from \"@/components/Layout\"\nimport { Button } from \"@/components/ui/button\"\nimport { Plus, RotateCcw, Loader2, X, Trash2, Sparkles, Wand2, Upload, FileText } from \"lucide-react\"\nimport { useState, useEffect, useRef } from \"react\"\nimport { useRouter } from \"next/navigation\"\nimport { onAuthStateChanged, type User } from \"firebase/auth\"\nimport { auth } from \"@/lib/firebase\"\nimport { getFlashcardDecks, createFlashcardDeck, getFlashcards, addFlashcard, getMaterials, type FlashcardDeck, type Flashcard, type Material } from \"@/lib/firestore\"\nimport { generateFlashcards as generateFlashcardsOld } from \"@/lib/ai-client\"\nimport { readFileContent } from \"@/lib/gemini\"\nimport { generateSpacedRepetitionSchedule } from \"@/lib/utils\"\nimport { toast } from \"sonner\"\nimport { generateFlashcards as generateFlashcardsAI, APIError } from \"@/lib/api\"\n\nexport default function FlashcardsPage() {\n  const router = useRouter()\n  const [user, setUser] = useState<User | null>(null)\n  const [loading, setLoading] = useState(true)\n  const [decks, setDecks] = useState<FlashcardDeck[]>([])\n  const [selectedDeck, setSelectedDeck] = useState<FlashcardDeck | null>(null)\n  const [cards, setCards] = useState<Flashcard[]>([])\n  const [currentIndex, setCurrentIndex] = useState(0)\n  const [isFlipped, setIsFlipped] = useState(false)\n  const [showCreateDeck, setShowCreateDeck] = useState(false)\n  const [showAddCard, setShowAddCard] = useState(false)\n  const [showAIGenerate, setShowAIGenerate] = useState(false)\n  const [creating, setCreating] = useState(false)\n  const [generating, setGenerating] = useState(false)\n  const [studyMode, setStudyMode] = useState<\"normal\" | \"spaced\">(\"normal\")\n  const [spacedSchedule, setSpacedSchedule] = useState<any[]>([])\n  const startSpacedRepetition = () => {\n    if (cards.length === 0) return\n    \n    const schedule = generateSpacedRepetitionSchedule(\n      cards.map(card => ({\n        id: card.id,\n        lastReviewed: card.lastReviewed || new Date(0),\n        difficulty: card.difficulty === \"easy\" ? 1 : card.difficulty === \"hard\" ? 3 : 2,\n        correctStreak: 0,\n        totalAttempts: 0\n      }))\n    )\n    \n    setSpacedSchedule(schedule)\n    setStudyMode(\"spaced\")\n    setCurrentIndex(0)\n    setIsFlipped(false)\n  }\n  const [newCard, setNewCard] = useState({ front: \"\", back: \"\", difficulty: \"medium\" as \"easy\" | \"medium\" | \"hard\" })\n  const [newDeck, setNewDeck] = useState({ name: \"\", subject: \"\" })\n  const [aiConfig, setAiConfig] = useState({ \n    topic: \"\", \n    count: 5, \n    difficulty: \"medium\" as \"easy\" | \"medium\" | \"hard\",\n    sourceType: \"topic\" as \"topic\" | \"file\" | \"material\" | \"text\",\n    sourceContent: \"\",\n    selectedMaterialId: \"\"\n  })\n  const [materials, setMaterials] = useState<Material[]>([])\n  const [uploadedFiles, setUploadedFiles] = useState<File[]>([])\n  const [fileReadProgress, setFileReadProgress] = useState(\"\")\n  const fileInputRef = useRef<HTMLInputElement>(null)\n\n  useEffect(() => {\n    const unsubscribe = onAuthStateChanged(auth, async (currentUser) => {\n      setUser(currentUser)\n      if (currentUser) {\n        try {\n          const userDecks = await getFlashcardDecks(currentUser.uid)\n          setDecks(userDecks)\n          // Also load materials for AI generation source\n          const userMaterials = await getMaterials(currentUser.uid)\n          setMaterials(userMaterials)\n        } catch (error) {\n          console.error(\"Error loading decks:\", error)\n        }\n      } else {\n        router.push(\"/login\")\n      }\n      setLoading(false)\n    })\n    return () => unsubscribe()\n  }, [router])\n\n  const handleSelectDeck = async (deck: FlashcardDeck) => {\n    setSelectedDeck(deck)\n    const deckCards = await getFlashcards(deck.id)\n    setCards(deckCards)\n    setCurrentIndex(0)\n    setIsFlipped(false)\n  }\n\n  const handleCreateDeck = async () => {\n    if (!user || !newDeck.name || !newDeck.subject) return\n    setCreating(true)\n    try {\n      await createFlashcardDeck({\n        name: newDeck.name,\n        subject: newDeck.subject,\n        userId: user.uid\n      })\n      const updatedDecks = await getFlashcardDecks(user.uid)\n      setDecks(updatedDecks)\n      setShowCreateDeck(false)\n      setNewDeck({ name: \"\", subject: \"\" })\n    } catch (error: any) {\n      console.error(\"Error creating deck:\", error)\n      alert(\"Error creating deck: \" + (error?.message || \"Unknown error\"))\n    } finally {\n      setCreating(false)\n    }\n  }\n\n  const handleAddCard = async () => {\n    if (!user || !selectedDeck || !newCard.front || !newCard.back) return\n    try {\n      await addFlashcard({\n        front: newCard.front,\n        back: newCard.back,\n        difficulty: newCard.difficulty,\n        deckId: selectedDeck.id,\n        userId: user.uid\n      })\n      const updatedCards = await getFlashcards(selectedDeck.id)\n      setCards(updatedCards)\n      setShowAddCard(false)\n      setNewCard({ front: \"\", back: \"\", difficulty: \"medium\" })\n    } catch (error) {\n      console.error(\"Error adding card:\", error)\n    }\n  }\n\n  const handleFileSelect = async (e: React.ChangeEvent<HTMLInputElement>) => {\n    const files = e.target.files\n    if (!files || files.length === 0) return\n    \n    const fileArray = Array.from(files)\n    setUploadedFiles(fileArray)\n    setFileReadProgress(\"Reading files...\")\n    \n    try {\n      // Read all files and combine their content\n      let combinedContent = \"\"\n      for (let i = 0; i < fileArray.length; i++) {\n        const file = fileArray[i]\n        setFileReadProgress(`Reading file ${i + 1}/${fileArray.length}: ${file.name}`)\n        const content = await readFileContent(file)\n        combinedContent += `\\n\\n--- Content from: ${file.name} ---\\n\\n${content}`\n      }\n      \n      setAiConfig(prev => ({ ...prev, sourceContent: combinedContent.trim(), sourceType: \"file\" }))\n      setFileReadProgress(`${fileArray.length} file(s) loaded successfully`)\n    } catch (error) {\n      console.error(\"Error reading files:\", error)\n      setFileReadProgress(\"Error reading files\")\n      alert(\"Failed to read file content\")\n    }\n  }\n\n  // AI Flashcard Generation using Gemini\n  const generateAIFlashcards = async () => {\n    if (!user || !selectedDeck) return\n    \n    // Validate based on source type\n    if (aiConfig.sourceType === \"topic\" && !aiConfig.topic) {\n      alert(\"Please enter a topic\")\n      return\n    }\n    if (aiConfig.sourceType === \"text\" && !aiConfig.sourceContent) {\n      alert(\"Please enter some text content\")\n      return\n    }\n    if (aiConfig.sourceType === \"file\" && uploadedFiles.length === 0) {\n      alert(\"Please upload at least one file\")\n      return\n    }\n    if (aiConfig.sourceType === \"file\" && !aiConfig.sourceContent) {\n      alert(\"Files are still being processed. Please wait.\")\n      return\n    }\n    \n    setGenerating(true)\n    try {\n      let generatedCards: { front: string; back: string }[]\n      \n      // Determine content source\n      let content = \"\"\n      let topic = aiConfig.topic\n      \n      if (aiConfig.sourceType === \"material\" && aiConfig.selectedMaterialId) {\n        // Get content from selected material\n        const selectedMaterial = materials.find(m => m.id === aiConfig.selectedMaterialId)\n        if (selectedMaterial && selectedMaterial.content) {\n          content = selectedMaterial.content\n          topic = topic || selectedMaterial.title || selectedMaterial.subject || \"Study Material\"\n        } else {\n          alert(\"Selected material not found or has no content.\")\n          return\n        }\n      } else if (aiConfig.sourceType === \"text\" || aiConfig.sourceType === \"file\") {\n        content = aiConfig.sourceContent\n      }\n      \n      // Fallback topic\n      if (!topic) {\n        topic = uploadedFiles.length > 0 \n          ? uploadedFiles.map(f => f.name.replace(/\\.[^/.]+$/, \"\")).join(\", \") \n          : \"Study Material\"\n      }\n      \n      console.log(\"Generating flashcards with content length:\", content.length)\n      console.log(\"Topic:\", topic)\n      \n      // Try to use AI backend first\n      try {\n        const result = await generateFlashcardsAI({\n          text: content || undefined,\n          topic: !content ? topic : undefined,\n          num_cards: aiConfig.count,\n          use_memory: !content // Use memory if no content provided\n        })\n\n        generatedCards = result.flashcards.map(card => ({\n          front: card.question,\n          back: card.answer\n        }))\n\n        toast.info(`Generated ${generatedCards.length} flashcards using AI backend`, {\n          description: result.source,\n          duration: 3000\n        })\n      } catch (error) {\n        console.warn(\"AI backend failed, using fallback:\", error)\n        \n        // Fallback to original AI client\n        generatedCards = await generateFlashcardsOld(\n          content,\n          topic,\n          aiConfig.count,\n          aiConfig.difficulty\n        )\n\n        toast.info(\"Generated flashcards using fallback AI\", {\n          duration: 2000\n        })\n      }\n      \n      // Add all generated cards to the deck\n      for (const card of generatedCards) {\n        await addFlashcard({\n          front: card.front,\n          back: card.back,\n          difficulty: aiConfig.difficulty,\n          deckId: selectedDeck.id,\n          userId: user.uid\n        })\n      }\n      \n      // Refresh cards\n      const updatedCards = await getFlashcards(selectedDeck.id)\n      setCards(updatedCards)\n\n      // Update deck in decks list\n      const updatedDecks = await getFlashcardDecks(user.uid)\n      setDecks(updatedDecks)\n\n      setShowAIGenerate(false)\n      resetAiConfig()\n\n      // Success toast with navigation\n      toast.success(`Successfully generated ${generatedCards.length} flashcards!`, {\n        description: \"Your new flashcards are ready to study.\",\n        duration: 4000,\n        action: {\n          label: \"Start Studying\",\n          onClick: () => {\n            // Stay on current deck since we added cards to selectedDeck\n            setSelectedDeck(selectedDeck)\n          }\n        }\n      })\n    } catch (error: any) {\n      console.error(\"Error generating flashcards:\", error)\n      toast.error(\"Failed to generate flashcards\", {\n        description: error?.message || \"Please try again or check your input.\",\n        duration: 5000,\n        action: {\n          label: \"Try Again\",\n          onClick: () => generateAIFlashcards()\n        }\n      })\n    } finally {\n      setGenerating(false)\n    }\n  }\n\n  const resetAiConfig = () => {\n    setAiConfig({ \n      topic: \"\", \n      count: 5, \n      difficulty: \"medium\",\n      sourceType: \"topic\",\n      sourceContent: \"\",\n      selectedMaterialId: \"\"\n    })\n    setUploadedFiles([])\n    setFileReadProgress(\"\")\n    if (fileInputRef.current) fileInputRef.current.value = \"\"\n  }\n\n  // Fallback smart flashcard generator (used when Gemini fails)\n  const generateSmartFlashcards = (topic: string, count: number, difficulty: \"easy\" | \"medium\" | \"hard\") => {\n    const topicLower = topic.toLowerCase()\n    const cards: { front: string; back: string }[] = []\n    \n    // Template-based generation system\n    const templates = {\n      definition: [\n        { front: `What is ${topic}?`, back: `${topic} is a concept/subject that involves understanding and applying related principles and knowledge.` },\n        { front: `Define ${topic} in your own words`, back: `${topic} can be defined as the study and practice of its core principles, methods, and applications.` },\n        { front: `What are the key characteristics of ${topic}?`, back: `Key characteristics include: foundational concepts, practical applications, and theoretical frameworks.` }\n      ],\n      concepts: [\n        { front: `What are the main components of ${topic}?`, back: `The main components include: core elements, supporting structures, and interconnected systems.` },\n        { front: `Explain the fundamental principles of ${topic}`, back: `Fundamental principles include systematic approaches, logical reasoning, and evidence-based methods.` },\n        { front: `What is the purpose of studying ${topic}?`, back: `Studying ${topic} helps develop understanding, critical thinking, and practical skills in the subject area.` }\n      ],\n      application: [\n        { front: `How is ${topic} applied in real life?`, back: `${topic} is applied in various fields including education, industry, research, and everyday problem-solving.` },\n        { front: `Give an example of ${topic} in practice`, back: `A practical example involves using ${topic} principles to solve problems, make decisions, or create solutions.` },\n        { front: `What problems can ${topic} help solve?`, back: `${topic} can help address challenges related to analysis, optimization, design, and understanding complex systems.` }\n      ],\n      analysis: [\n        { front: `Compare and contrast aspects of ${topic}`, back: `Different aspects share common foundations but vary in application, complexity, and scope.` },\n        { front: `What are the advantages of ${topic}?`, back: `Advantages include improved understanding, better problem-solving abilities, and practical skill development.` },\n        { front: `What challenges exist in ${topic}?`, back: `Common challenges include complexity, requiring prerequisite knowledge, and practical implementation difficulties.` }\n      ],\n      review: [\n        { front: `Summarize the key points of ${topic}`, back: `Key points: definitions, principles, applications, examples, and interconnections with other concepts.` },\n        { front: `What should you remember about ${topic}?`, back: `Remember the core definitions, main principles, practical applications, and common examples.` },\n        { front: `How does ${topic} connect to other subjects?`, back: `${topic} connects through shared principles, complementary skills, and interdisciplinary applications.` }\n      ]\n    }\n\n    // Subject-specific enhancements\n    const subjectTemplates: { [key: string]: { front: string; back: string }[] } = {\n      math: [\n        { front: \"What is a derivative?\", back: \"A derivative measures the rate of change of a function with respect to a variable. It represents the slope of the tangent line at any point.\" },\n        { front: \"What is the quadratic formula?\", back: \"x = (-b ± √(b²-4ac)) / 2a, used to solve equations of the form ax² + bx + c = 0\" },\n        { front: \"What is the Pythagorean theorem?\", back: \"In a right triangle, a² + b² = c², where c is the hypotenuse.\" },\n        { front: \"What is a limit in calculus?\", back: \"A limit describes the value a function approaches as the input approaches some value.\" },\n        { front: \"What is integration?\", back: \"Integration is the reverse of differentiation, used to find areas under curves and accumulation of quantities.\" }\n      ],\n      physics: [\n        { front: \"What is Newton's First Law?\", back: \"An object at rest stays at rest, and an object in motion stays in motion unless acted upon by an external force.\" },\n        { front: \"What is the formula for force?\", back: \"F = ma (Force equals mass times acceleration)\" },\n        { front: \"What is kinetic energy?\", back: \"KE = ½mv² - the energy an object possesses due to its motion.\" },\n        { front: \"What is potential energy?\", back: \"Energy stored in an object due to its position or configuration (e.g., gravitational PE = mgh)\" },\n        { front: \"What is the speed of light?\", back: \"Approximately 3 × 10⁸ m/s (299,792,458 meters per second)\" }\n      ],\n      chemistry: [\n        { front: \"What is an atom?\", back: \"The smallest unit of matter that retains the properties of an element, consisting of protons, neutrons, and electrons.\" },\n        { front: \"What is the periodic table?\", back: \"A tabular arrangement of chemical elements organized by atomic number, electron configuration, and recurring properties.\" },\n        { front: \"What is a covalent bond?\", back: \"A chemical bond formed by sharing electrons between atoms.\" },\n        { front: \"What is pH?\", back: \"A scale measuring acidity/basicity from 0-14, where 7 is neutral, below 7 is acidic, and above 7 is basic.\" },\n        { front: \"What is Avogadro's number?\", back: \"6.022 × 10²³ - the number of particles in one mole of a substance.\" }\n      ],\n      biology: [\n        { front: \"What is DNA?\", back: \"Deoxyribonucleic acid - a molecule carrying genetic instructions for development, functioning, and reproduction of organisms.\" },\n        { front: \"What is photosynthesis?\", back: \"The process by which plants convert light energy, water, and CO₂ into glucose and oxygen: 6CO₂ + 6H₂O → C₆H₁₂O₆ + 6O₂\" },\n        { front: \"What is mitosis?\", back: \"Cell division resulting in two identical daughter cells with the same number of chromosomes as the parent cell.\" },\n        { front: \"What is the cell membrane?\", back: \"A semipermeable lipid bilayer that surrounds cells, controlling what enters and exits.\" },\n        { front: \"What is evolution?\", back: \"The process of change in living organisms over generations through natural selection and genetic variation.\" }\n      ],\n      history: [\n        { front: \"When did World War II end?\", back: \"1945 - with Germany surrendering in May and Japan in September after atomic bombs on Hiroshima and Nagasaki.\" },\n        { front: \"What was the Renaissance?\", back: \"A cultural movement (14th-17th century) marking the transition from medieval to modern times, emphasizing art, science, and humanism.\" },\n        { front: \"What was the Industrial Revolution?\", back: \"A period of major industrialization (1760-1840) transitioning from hand production to machine manufacturing.\" },\n        { front: \"When was the Declaration of Independence signed?\", back: \"July 4, 1776 - declaring American independence from British rule.\" },\n        { front: \"What was the Cold War?\", back: \"A period of geopolitical tension (1947-1991) between the USA and USSR, characterized by political conflict without direct military engagement.\" }\n      ],\n      programming: [\n        { front: \"What is a variable?\", back: \"A named storage location in memory that holds a value which can change during program execution.\" },\n        { front: \"What is a function?\", back: \"A reusable block of code that performs a specific task and can accept inputs (parameters) and return outputs.\" },\n        { front: \"What is an array?\", back: \"A data structure that stores a collection of elements of the same type in contiguous memory locations.\" },\n        { front: \"What is Object-Oriented Programming?\", back: \"A programming paradigm based on objects containing data (attributes) and code (methods), with principles like encapsulation, inheritance, and polymorphism.\" },\n        { front: \"What is an algorithm?\", back: \"A step-by-step procedure or formula for solving a problem or completing a task.\" }\n      ]\n    }\n\n    // Check if topic matches any subject-specific templates\n    for (const [subject, subjectCards] of Object.entries(subjectTemplates)) {\n      if (topicLower.includes(subject) || subject.includes(topicLower)) {\n        const selectedCards = subjectCards.slice(0, count)\n        return selectedCards\n      }\n    }\n\n    // Generate from general templates\n    const allTemplates = [...templates.definition, ...templates.concepts, ...templates.application, ...templates.analysis, ...templates.review]\n    \n    // Shuffle and select\n    const shuffled = allTemplates.sort(() => Math.random() - 0.5)\n    \n    // Add difficulty-based variations\n    for (let i = 0; i < Math.min(count, shuffled.length); i++) {\n      let card = { ...shuffled[i] }\n      \n      if (difficulty === \"hard\") {\n        card.front = card.front.replace(\"What is\", \"Explain in detail\")\n        card.front = card.front.replace(\"Define\", \"Critically analyze and define\")\n      } else if (difficulty === \"easy\") {\n        card.back = card.back.split('.')[0] + \".\"  // Shorter answers for easy\n      }\n      \n      cards.push(card)\n    }\n\n    return cards\n  }\n\n  const nextCard = () => {\n    setCurrentIndex((currentIndex + 1) % cards.length)\n    setIsFlipped(false)\n  }\n\n  const prevCard = () => {\n    setCurrentIndex(currentIndex === 0 ? cards.length - 1 : currentIndex - 1)\n    setIsFlipped(false)\n  }\n\n  // Keyboard navigation\n  useEffect(() => {\n    const handleKeyPress = (e: KeyboardEvent) => {\n      // Only handle keyboard when not typing in inputs\n      if (e.target instanceof HTMLInputElement || e.target instanceof HTMLTextAreaElement) {\n        return\n      }\n\n      switch (e.key) {\n        case ' ':\n          e.preventDefault()\n          setIsFlipped(!isFlipped)\n          break\n        case 'ArrowRight':\n          e.preventDefault()\n          nextCard()\n          break\n        case 'ArrowLeft':\n          e.preventDefault()\n          prevCard()\n          break\n        case 'r':\n        case 'R':\n          e.preventDefault()\n          setCurrentIndex(0)\n          setIsFlipped(false)\n          break\n      }\n    }\n\n    window.addEventListener('keydown', handleKeyPress)\n    return () => window.removeEventListener('keydown', handleKeyPress)\n  }, [currentIndex, isFlipped, cards.length])\n\n  if (loading) {\n    return (\n      <main className=\"min-h-screen bg-slate-900 flex items-center justify-center\">\n        <Loader2 className=\"w-8 h-8 animate-spin text-primary\" />\n      </main>\n    )\n  }\n\n  if (!user) return null\n\n  return (\n    <Layout \n      title=\"Flashcards\" \n      subtitle=\"Create and review flashcards to master key concepts\"\n    >\n      <div className=\"mb-12\">\n        <p className=\"text-slate-400\">Study with flashcards</p>\n      </div>\n\n        {!selectedDeck ? (\n          <>\n            {/* Deck List */}\n            <div className=\"grid md:grid-cols-2 lg:grid-cols-3 gap-4 mb-8\">\n              {decks.map((deck) => (\n                <div\n                  key={deck.id}\n                  onClick={() => handleSelectDeck(deck)}\n                  className=\"p-6 rounded-lg bg-slate-800/50 border border-slate-700 hover:border-primary/50 cursor-pointer transition-all\"\n                >\n                  <h3 className=\"font-semibold text-slate-100 mb-2\">{deck.name}</h3>\n                  <p className=\"text-sm text-slate-400 mb-2\">{deck.subject}</p>\n                  <p className=\"text-xs text-primary\">{deck.cardCount} cards</p>\n                </div>\n              ))}\n            </div>\n\n            {/* Create New Deck */}\n            <div className=\"p-8 rounded-lg bg-slate-800/50 border border-slate-700 text-center\">\n              <Plus className=\"w-8 h-8 text-primary mx-auto mb-4\" />\n              <h3 className=\"text-lg font-semibold text-slate-100 mb-2\">Create New Deck</h3>\n              <p className=\"text-slate-400 mb-6\">Create a new flashcard deck</p>\n              <Button onClick={() => setShowCreateDeck(true)}>Create Deck</Button>\n            </div>\n          </>\n        ) : (\n          <>\n            {/* Back Button */}\n            <Button variant=\"outline\" onClick={() => setSelectedDeck(null)} className=\"mb-6\">\n              ← Back to Decks\n            </Button>\n\n            <div className=\"flex justify-between items-center mb-6\">\n              <h2 className=\"text-2xl font-semibold text-slate-100\">{selectedDeck.name}</h2>\n              <div className=\"flex gap-2\">\n                <Button variant=\"outline\" onClick={() => setShowAIGenerate(true)} className=\"border-primary/50 text-primary hover:bg-primary/10\">\n                  <Sparkles className=\"w-4 h-4 mr-2\" /> AI Generate\n                </Button>\n                <Button onClick={() => setShowAddCard(true)}>\n                  <Plus className=\"w-4 h-4 mr-2\" /> Add Card\n                </Button>\n              </div>\n            </div>\n\n            {cards.length === 0 ? (\n              <div className=\"text-center py-16\">\n                <p className=\"text-slate-400 mb-4\">No cards in this deck yet</p>\n                <Button onClick={() => setShowAddCard(true)}>Add First Card</Button>\n              </div>\n            ) : (\n              <>\n                {/* Flashcard Display */}\n                <div className=\"mb-12\">\n                  <div\n                    onClick={() => setIsFlipped(!isFlipped)}\n                    className=\"min-h-80 max-h-[500px] rounded-2xl bg-gradient-to-br from-primary/20 to-accent/20 border-2 border-primary/30 cursor-pointer flex items-center justify-center p-8 hover:shadow-lg transition-all overflow-hidden\"\n                  >\n                    <div className=\"text-center w-full max-w-3xl\">\n                      <p className=\"text-sm text-slate-400 mb-4\">\n                        {isFlipped ? \"Answer\" : \"Question\"} ({currentIndex + 1}/{cards.length})\n                      </p>\n                      <div className=\"max-h-60 overflow-y-auto px-4\">\n                        <p className=\"text-xl md:text-2xl lg:text-3xl font-serif font-bold text-slate-100 leading-relaxed\">\n                          {isFlipped ? cards[currentIndex].back : cards[currentIndex].front}\n                        </p>\n                      </div>\n                      <p className=\"text-xs text-muted-foreground mt-6\">\n                        Click to flip • Space to flip • ← → to navigate • R to reset\n                      </p>\n                    </div>\n                  </div>\n                </div>\n\n                {/* Controls */}\n                <div className=\"flex justify-center gap-4 mb-4\">\n                  <Button \n                    variant={studyMode === \"normal\" ? \"default\" : \"outline\"} \n                    onClick={() => setStudyMode(\"normal\")}\n                  >\n                    Normal\n                  </Button>\n                  <Button \n                    variant={studyMode === \"spaced\" ? \"default\" : \"outline\"} \n                    onClick={startSpacedRepetition}\n                  >\n                    Spaced Repetition\n                  </Button>\n                </div>\n                <div className=\"flex justify-center gap-4\">\n                  <Button variant=\"outline\" onClick={prevCard}>Previous</Button>\n                  <Button onClick={nextCard}>Next</Button>\n                  <Button variant=\"outline\" onClick={() => { setCurrentIndex(0); setIsFlipped(false); }}>\n                    <RotateCcw className=\"w-4 h-4 mr-2\" /> Reset\n                  </Button>\n                </div>\n              </>\n            )}\n          </>\n        )}\n\n      {/* Create Deck Modal */}\n      {showCreateDeck && (\n        <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\">\n          <div className=\"bg-card rounded-xl p-6 w-full max-w-md border border-border\">\n            <div className=\"flex justify-between items-center mb-6\">\n              <h2 className=\"text-xl font-semibold\">Create Deck</h2>\n              <button onClick={() => setShowCreateDeck(false)}><X className=\"w-5 h-5\" /></button>\n            </div>\n            <div className=\"space-y-4\">\n              <input\n                type=\"text\"\n                placeholder=\"Deck Name\"\n                value={newDeck.name}\n                onChange={(e) => setNewDeck({ ...newDeck, name: e.target.value })}\n                className=\"w-full px-4 py-2 rounded-lg bg-background border border-border\"\n              />\n              <input\n                type=\"text\"\n                placeholder=\"Subject\"\n                value={newDeck.subject}\n                onChange={(e) => setNewDeck({ ...newDeck, subject: e.target.value })}\n                className=\"w-full px-4 py-2 rounded-lg bg-background border border-border\"\n              />\n              <Button className=\"w-full\" onClick={handleCreateDeck} disabled={creating || !newDeck.name || !newDeck.subject}>\n                {creating ? <><Loader2 className=\"w-4 h-4 mr-2 animate-spin\" /> Creating...</> : \"Create\"}\n              </Button>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Add Card Modal */}\n      {showAddCard && (\n        <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\">\n          <div className=\"bg-card rounded-xl p-6 w-full max-w-md border border-border\">\n            <div className=\"flex justify-between items-center mb-6\">\n              <h2 className=\"text-xl font-semibold\">Add Card</h2>\n              <button onClick={() => setShowAddCard(false)}><X className=\"w-5 h-5\" /></button>\n            </div>\n            <div className=\"space-y-4\">\n              <textarea\n                placeholder=\"Question (Front)\"\n                value={newCard.front}\n                onChange={(e) => setNewCard({ ...newCard, front: e.target.value })}\n                className=\"w-full px-4 py-2 rounded-lg bg-background border border-border resize-none\"\n                rows={3}\n              />\n              <textarea\n                placeholder=\"Answer (Back)\"\n                value={newCard.back}\n                onChange={(e) => setNewCard({ ...newCard, back: e.target.value })}\n                className=\"w-full px-4 py-2 rounded-lg bg-background border border-border resize-none\"\n                rows={3}\n              />\n              <select\n                value={newCard.difficulty}\n                onChange={(e) => setNewCard({ ...newCard, difficulty: e.target.value as \"easy\" | \"medium\" | \"hard\" })}\n                className=\"w-full px-4 py-2 rounded-lg bg-background border border-border\"\n              >\n                <option value=\"easy\">Easy</option>\n                <option value=\"medium\">Medium</option>\n                <option value=\"hard\">Hard</option>\n              </select>\n              <Button className=\"w-full\" onClick={handleAddCard}>Add Card</Button>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* AI Generate Modal */}\n      {showAIGenerate && (\n        <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4 overflow-y-auto\">\n          <div className=\"bg-card rounded-xl p-6 w-full max-w-lg border border-border my-8\">\n            <div className=\"flex justify-between items-center mb-6\">\n              <h2 className=\"text-xl font-semibold flex items-center gap-2\">\n                <Wand2 className=\"w-5 h-5 text-primary\" />\n                AI Generate Flashcards\n              </h2>\n              <button onClick={() => { setShowAIGenerate(false); resetAiConfig(); }}><X className=\"w-5 h-5\" /></button>\n            </div>\n            <div className=\"space-y-4\">\n              {/* Source Type Selection */}\n              <div>\n                <label className=\"text-sm text-muted-foreground mb-2 block\">Generate from:</label>\n                <div className=\"grid grid-cols-2 gap-2\">\n                  <button\n                    onClick={() => setAiConfig({ ...aiConfig, sourceType: \"topic\", sourceContent: \"\" })}\n                    className={`p-3 rounded-lg border text-sm text-left transition-all ${\n                      aiConfig.sourceType === \"topic\" \n                        ? \"border-primary bg-primary/10 text-primary\" \n                        : \"border-border hover:border-primary/50\"\n                    }`}\n                  >\n                    <Sparkles className=\"w-4 h-4 mb-1\" />\n                    Topic Only\n                  </button>\n                  <button\n                    onClick={() => setAiConfig({ ...aiConfig, sourceType: \"file\" })}\n                    className={`p-3 rounded-lg border text-sm text-left transition-all ${\n                      aiConfig.sourceType === \"file\" \n                        ? \"border-primary bg-primary/10 text-primary\" \n                        : \"border-border hover:border-primary/50\"\n                    }`}\n                  >\n                    <Upload className=\"w-4 h-4 mb-1\" />\n                    Upload File\n                  </button>\n                  <button\n                    onClick={() => setAiConfig({ ...aiConfig, sourceType: \"text\" })}\n                    className={`p-3 rounded-lg border text-sm text-left transition-all ${\n                      aiConfig.sourceType === \"text\" \n                        ? \"border-primary bg-primary/10 text-primary\" \n                        : \"border-border hover:border-primary/50\"\n                    }`}\n                  >\n                    <FileText className=\"w-4 h-4 mb-1\" />\n                    Paste Text\n                  </button>\n                  <button\n                    onClick={() => setAiConfig({ ...aiConfig, sourceType: \"material\" })}\n                    className={`p-3 rounded-lg border text-sm text-left transition-all ${\n                      aiConfig.sourceType === \"material\" \n                        ? \"border-primary bg-primary/10 text-primary\" \n                        : \"border-border hover:border-primary/50\"\n                    }`}\n                  >\n                    <FileText className=\"w-4 h-4 mb-1\" />\n                    My Materials\n                  </button>\n                </div>\n              </div>\n\n              {/* Topic Input */}\n              <div>\n                <label className=\"text-sm text-muted-foreground mb-1 block\">\n                  {aiConfig.sourceType === \"topic\" ? \"Topic / Subject *\" : \"Topic / Subject (optional)\"}\n                </label>\n                <input\n                  type=\"text\"\n                  placeholder=\"e.g., Biology, Calculus, World War II...\"\n                  value={aiConfig.topic}\n                  onChange={(e) => setAiConfig({ ...aiConfig, topic: e.target.value })}\n                  className=\"w-full px-4 py-2 rounded-lg bg-background border border-border focus:border-primary outline-none\"\n                />\n              </div>\n\n              {/* File Upload */}\n              {aiConfig.sourceType === \"file\" && (\n                <div>\n                  <label className=\"text-sm text-muted-foreground mb-1 block\">Upload Source Files</label>\n                  <input\n                    ref={fileInputRef}\n                    type=\"file\"\n                    multiple\n                    accept=\".txt,.md,.csv,.pdf,.doc,.docx,.rtf\"\n                    onChange={handleFileSelect}\n                    className=\"hidden\"\n                  />\n                  <div \n                    onClick={() => fileInputRef.current?.click()}\n                    className=\"w-full p-4 rounded-lg border-2 border-dashed border-border hover:border-primary/50 cursor-pointer text-center transition-all\"\n                  >\n                    {uploadedFiles.length > 0 ? (\n                      <div className=\"space-y-1\">\n                        <div className=\"flex items-center justify-center gap-2 text-primary\">\n                          <FileText className=\"w-5 h-5\" />\n                          <span className=\"font-medium\">{uploadedFiles.length} file(s) selected</span>\n                        </div>\n                        <div className=\"text-xs text-muted-foreground max-h-16 overflow-y-auto\">\n                          {uploadedFiles.map((f, i) => (\n                            <div key={i}>{f.name}</div>\n                          ))}\n                        </div>\n                      </div>\n                    ) : (\n                      <>\n                        <Upload className=\"w-6 h-6 mx-auto mb-2 text-muted-foreground\" />\n                        <p className=\"text-sm text-muted-foreground\">Click to upload multiple files</p>\n                        <p className=\"text-xs text-muted-foreground\">PDF, Word, TXT, MD supported</p>\n                      </>\n                    )}\n                  </div>\n                  {fileReadProgress && (\n                    <p className={`text-xs mt-1 ${fileReadProgress.includes(\"Error\") ? \"text-red-500\" : \"text-green-500\"}`}>\n                      {fileReadProgress}\n                    </p>\n                  )}\n                  {aiConfig.sourceContent && (\n                    <div className=\"mt-1\">\n                      <p className=\"text-xs text-muted-foreground\">\n                        Content loaded: {aiConfig.sourceContent.length.toLocaleString()} characters\n                      </p>\n                      {aiConfig.sourceContent.length > 500000 && (\n                        <p className=\"text-xs text-yellow-500\">\n                          ⚠️ Large content will be truncated to fit AI limits (~500k chars max)\n                        </p>\n                      )}\n                    </div>\n                  )}\n                </div>\n              )}\n\n              {/* Text Input */}\n              {aiConfig.sourceType === \"text\" && (\n                <div>\n                  <label className=\"text-sm text-muted-foreground mb-1 block\">Paste Study Content</label>\n                  <textarea\n                    placeholder=\"Paste your notes, textbook content, or any study material here...\"\n                    value={aiConfig.sourceContent}\n                    onChange={(e) => setAiConfig({ ...aiConfig, sourceContent: e.target.value })}\n                    className=\"w-full px-4 py-2 rounded-lg bg-background border border-border focus:border-primary outline-none resize-none\"\n                    rows={5}\n                  />\n                  <p className=\"text-xs text-muted-foreground mt-1\">\n                    {aiConfig.sourceContent.length.toLocaleString()} characters\n                    {aiConfig.sourceContent.length > 500000 && (\n                      <span className=\"text-yellow-500 ml-2\">⚠️ Will be truncated</span>\n                    )}\n                  </p>\n                </div>\n              )}\n\n              {/* Material Selection */}\n              {aiConfig.sourceType === \"material\" && (\n                <div>\n                  <label className=\"text-sm text-muted-foreground mb-1 block\">Select from Materials</label>\n                  {materials.length === 0 ? (\n                    <p className=\"text-sm text-muted-foreground p-4 text-center border border-dashed border-border rounded-lg\">\n                      No materials found. Upload materials first in the Materials section.\n                    </p>\n                  ) : (\n                    <select\n                      value={aiConfig.selectedMaterialId}\n                      onChange={(e) => setAiConfig({ ...aiConfig, selectedMaterialId: e.target.value })}\n                      className=\"w-full px-4 py-2 rounded-lg bg-background border border-border focus:border-primary outline-none\"\n                    >\n                      <option value=\"\">Select a material...</option>\n                      {materials.map(m => (\n                        <option key={m.id} value={m.id}>{m.title} ({m.subject})</option>\n                      ))}\n                    </select>\n                  )}\n                </div>\n              )}\n\n              {/* Number of Cards */}\n              <div>\n                <label className=\"text-sm text-muted-foreground mb-1 block\">Number of Cards</label>\n                <input\n                  type=\"number\"\n                  min=\"1\"\n                  max=\"20\"\n                  value={aiConfig.count}\n                  onChange={(e) => setAiConfig({ ...aiConfig, count: parseInt(e.target.value) || 5 })}\n                  className=\"w-full px-4 py-2 rounded-lg bg-background border border-border focus:border-primary outline-none\"\n                />\n              </div>\n\n              {/* Difficulty */}\n              <div>\n                <label className=\"text-sm text-muted-foreground mb-1 block\">Difficulty Level</label>\n                <select\n                  value={aiConfig.difficulty}\n                  onChange={(e) => setAiConfig({ ...aiConfig, difficulty: e.target.value as \"easy\" | \"medium\" | \"hard\" })}\n                  className=\"w-full px-4 py-2 rounded-lg bg-background border border-border focus:border-primary outline-none\"\n                >\n                  <option value=\"easy\">Easy - Simple, concise answers</option>\n                  <option value=\"medium\">Medium - Balanced questions</option>\n                  <option value=\"hard\">Hard - In-depth analysis</option>\n                </select>\n              </div>\n\n              {/* Gemini API Notice */}\n              <p className=\"text-xs text-muted-foreground text-center\">\n                Powered by Google Gemini AI\n              </p>\n\n              <Button \n                className=\"w-full bg-gradient-to-r from-primary to-purple-600\" \n                onClick={generateAIFlashcards}\n                disabled={generating || (aiConfig.sourceType === \"topic\" && !aiConfig.topic)}\n              >\n                {generating ? (\n                  <>\n                    <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" /> Generating with AI...\n                  </>\n                ) : (\n                  <>\n                    <Sparkles className=\"w-4 h-4 mr-2\" /> Generate Flashcards\n                  </>\n                )}\n              </Button>\n            </div>\n          </div>\n        </div>\n      )}\n    </Layout>\n  )\n}\n","\"use client\"\n\n// Gemini AI Client for flashcard generation\nconst GEMINI_API_KEY = process.env.NEXT_PUBLIC_GEMINI_API_KEY || \"\"\n\n// Max characters to send to Gemini - reduced to avoid rate limits\nconst MAX_CONTENT_CHARS = 100000  // ~25k tokens, much safer for rate limits\n\ninterface GeneratedFlashcard {\n  front: string\n  back: string\n}\n\n// Sleep helper for retry delays\nconst sleep = (ms: number) => new Promise(resolve => setTimeout(resolve, ms))\n\n// Truncate content intelligently - try to keep complete sentences/paragraphs\nfunction truncateContent(content: string, maxChars: number): string {\n  if (content.length <= maxChars) return content\n  \n  // Truncate to max chars\n  let truncated = content.slice(0, maxChars)\n  \n  // Try to end at a sentence boundary\n  const lastPeriod = truncated.lastIndexOf('. ')\n  const lastNewline = truncated.lastIndexOf('\\n')\n  const cutPoint = Math.max(lastPeriod, lastNewline)\n  \n  if (cutPoint > maxChars * 0.8) {\n    truncated = truncated.slice(0, cutPoint + 1)\n  }\n  \n  return truncated + \"\\n\\n[Content truncated due to length...]\"\n}\n\n// Fix truncated JSON arrays from incomplete API responses\nfunction fixTruncatedJson(jsonStr: string): string {\n  let fixed = jsonStr.trim()\n  \n  // If it doesn't start with [, try to find the start\n  if (!fixed.startsWith('[')) {\n    const arrayStart = fixed.indexOf('[')\n    if (arrayStart !== -1) {\n      fixed = fixed.slice(arrayStart)\n    } else {\n      throw new Error(\"No JSON array found in response\")\n    }\n  }\n  \n  // Count brackets to find where to close\n  let bracketCount = 0\n  let inString = false\n  let escapeNext = false\n  let lastCompleteObject = -1\n  \n  for (let i = 0; i < fixed.length; i++) {\n    const char = fixed[i]\n    \n    if (escapeNext) {\n      escapeNext = false\n      continue\n    }\n    \n    if (char === '\\\\') {\n      escapeNext = true\n      continue\n    }\n    \n    if (char === '\"') {\n      inString = !inString\n      continue\n    }\n    \n    if (inString) continue\n    \n    if (char === '{') bracketCount++\n    if (char === '}') {\n      bracketCount--\n      if (bracketCount === 0) {\n        lastCompleteObject = i\n      }\n    }\n  }\n  \n  // If we have complete objects, cut after the last one and close the array\n  if (lastCompleteObject > 0) {\n    fixed = fixed.slice(0, lastCompleteObject + 1)\n    // Check if there's a comma after the last object\n    const remainder = jsonStr.slice(lastCompleteObject + 1).trim()\n    if (remainder.startsWith(',')) {\n      // There was more content, just close the array\n    }\n    if (!fixed.endsWith(']')) {\n      fixed += ']'\n    }\n  }\n  \n  // Final cleanup\n  fixed = fixed.replace(/,\\s*\\]$/, ']') // Remove trailing comma before ]\n  fixed = fixed.replace(/,\\s*$/, '') + ']' // If ends with comma, close array\n  \n  // Make sure it's a valid array\n  if (!fixed.endsWith(']')) {\n    fixed += ']'\n  }\n  \n  return fixed\n}\n\nexport async function generateFlashcardsWithGemini(\n  content: string, \n  topic: string,\n  count: number = 5, \n  difficulty: \"easy\" | \"medium\" | \"hard\" = \"medium\"\n): Promise<GeneratedFlashcard[]> {\n  if (!GEMINI_API_KEY) {\n    throw new Error(\"Gemini API key not configured. Please add NEXT_PUBLIC_GEMINI_API_KEY to your environment variables.\")\n  }\n\n  // Truncate content if too large\n  const processedContent = content ? truncateContent(content.trim(), MAX_CONTENT_CHARS) : \"\"\n  \n  console.log(`Content length: ${content.length} chars, processed: ${processedContent.length} chars`)\n\n  const difficultyPrompts = {\n    easy: \"Create simple, straightforward questions with concise answers suitable for beginners.\",\n    medium: \"Create balanced questions that test understanding with moderately detailed answers.\",\n    hard: \"Create challenging questions that require deep understanding with comprehensive answers.\"\n  }\n\n  const prompt = processedContent && processedContent.length > 50 \n    ? `You are an expert educator creating flashcards for students.\n\nIMPORTANT: You MUST create flashcards based ONLY on the provided study material below. Do NOT make up information or use general knowledge. Extract key facts, definitions, concepts, and important details directly from the text.\n\nStudy Material:\n\"\"\"\n${processedContent}\n\"\"\"\n\n${topic ? `Topic/Subject: ${topic}` : \"\"}\nDifficulty: ${difficulty}\n${difficultyPrompts[difficulty]}\n\nGenerate exactly ${count} high-quality flashcards based STRICTLY on the content above. Each flashcard should:\n- Ask about specific information found in the provided text\n- Have accurate answers taken directly from the material\n- Cover different parts of the provided content\n\nReturn ONLY a valid JSON array with this exact format, no other text:\n[\n  {\"front\": \"Question about the content?\", \"back\": \"Answer from the content\"},\n  {\"front\": \"Question 2?\", \"back\": \"Answer 2\"}\n]\n\nCRITICAL: Only use information from the provided study material. Do not add external knowledge.`\n    : `You are an expert educator creating flashcards for students.\n\nTopic: ${topic}\nDifficulty: ${difficulty}\n${difficultyPrompts[difficulty]}\n\nGenerate exactly ${count} high-quality flashcards about \"${topic}\". Each flashcard should have:\n- A clear, specific question (front)\n- A comprehensive but concise answer (back)\n\nReturn ONLY a valid JSON array with this exact format, no other text:\n[\n  {\"front\": \"Question 1?\", \"back\": \"Answer 1\"},\n  {\"front\": \"Question 2?\", \"back\": \"Answer 2\"}\n]\n\nImportant:\n- Questions should test key concepts\n- Answers should be accurate and educational\n- Avoid yes/no questions\n- Make questions progressively cover different aspects of the topic`\n\n  // Retry logic with exponential backoff\n  const maxRetries = 3\n  let lastError: Error | null = null\n  \n  for (let attempt = 0; attempt < maxRetries; attempt++) {\n    try {\n      if (attempt > 0) {\n        // Wait before retry: 2s, 4s, 8s\n        const waitTime = Math.pow(2, attempt) * 1000\n        console.log(`Rate limited. Waiting ${waitTime/1000}s before retry ${attempt + 1}/${maxRetries}...`)\n        await sleep(waitTime)\n      }\n\n      const response = await fetch(\n        `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${GEMINI_API_KEY}`,\n        {\n          method: \"POST\",\n          headers: {\n            \"Content-Type\": \"application/json\",\n          },\n          body: JSON.stringify({\n            contents: [\n              {\n                parts: [\n                  {\n                    text: prompt\n                  }\n                ]\n              }\n            ],\n            generationConfig: {\n              temperature: 0.7,\n              topK: 40,\n              topP: 0.95,\n              maxOutputTokens: 8192,\n            }\n          })\n        }\n      )\n\n      if (!response.ok) {\n        const errorData = await response.json()\n        const errorMessage = errorData.error?.message || response.statusText\n        \n        // Check if it's a rate limit error (429 or \"Resource exhausted\")\n        if (response.status === 429 || errorMessage.includes(\"Resource exhausted\") || errorMessage.includes(\"rate limit\")) {\n          lastError = new Error(`Rate limited: ${errorMessage}`)\n          continue // Try again\n        }\n        \n        throw new Error(`Gemini API error: ${errorMessage}`)\n      }\n\n      const data = await response.json()\n      \n      // Extract the text content from the response\n      const textContent = data.candidates?.[0]?.content?.parts?.[0]?.text\n      \n      if (!textContent) {\n        throw new Error(\"No content returned from Gemini\")\n      }\n\n      // Parse the JSON from the response\n      // Try to extract JSON from the response (handle markdown code blocks)\n      let jsonStr = textContent\n      const jsonMatch = textContent.match(/```(?:json)?\\s*([\\s\\S]*?)```/)\n      if (jsonMatch) {\n        jsonStr = jsonMatch[1].trim()\n      } else {\n        // Try to find array directly\n        const arrayMatch = textContent.match(/\\[[\\s\\S]*\\]/)\n        if (arrayMatch) {\n          jsonStr = arrayMatch[0]\n        }\n      }\n\n      // Try to fix incomplete JSON\n      let flashcards: GeneratedFlashcard[]\n      try {\n        flashcards = JSON.parse(jsonStr)\n      } catch (parseError) {\n        // Try to fix truncated JSON\n        console.log(\"Initial parse failed, attempting to fix JSON...\")\n        jsonStr = fixTruncatedJson(jsonStr)\n        flashcards = JSON.parse(jsonStr)\n      }\n      \n      // Validate the structure\n      if (!Array.isArray(flashcards)) {\n        throw new Error(\"Invalid response format from Gemini\")\n      }\n\n      return flashcards.filter(card => card.front && card.back).slice(0, count)\n      \n    } catch (error: any) {\n      // If it's a rate limit error, store it and continue the loop\n      if (error.message?.includes(\"Rate limited\")) {\n        lastError = error\n        continue\n      }\n      // For other errors, throw immediately\n      console.error(\"Gemini API Error:\", error)\n      throw new Error(`Failed to generate flashcards: ${error.message}`)\n    }\n  }\n  \n  // If we've exhausted all retries\n  throw new Error(`Failed after ${maxRetries} attempts: ${lastError?.message || \"Rate limit exceeded\"}`)\n}\n\n// Helper to read file content\nexport async function readFileContent(file: File): Promise<string> {\n  return new Promise((resolve, reject) => {\n    const reader = new FileReader()\n    const fileName = file.name.toLowerCase()\n    \n    reader.onload = async (e) => {\n      try {\n        const result = e.target?.result\n        \n        // Handle PDF files - extract text using pdf.js or basic extraction\n        if (fileName.endsWith(\".pdf\")) {\n          if (typeof result === \"string\") {\n            // Try to extract readable text from PDF\n            const text = extractTextFromPDF(result)\n            resolve(text || `[PDF Document: ${file.name}]\\n\\nPlease copy and paste the text content from this PDF for best results, or the AI will generate flashcards based on the filename.`)\n          } else if (result instanceof ArrayBuffer) {\n            const text = await extractTextFromPDFBuffer(result)\n            resolve(text || `[PDF Document: ${file.name}]\\n\\nPlease copy and paste the text content from this PDF for best results.`)\n          }\n          return\n        }\n        \n        // Handle Word documents (.docx)\n        if (fileName.endsWith(\".docx\")) {\n          if (result instanceof ArrayBuffer) {\n            const text = await extractTextFromDocx(result)\n            resolve(text)\n            return\n          }\n        }\n        \n        // Handle plain text files\n        if (typeof result === \"string\") {\n          resolve(result)\n        } else {\n          resolve(`[Document: ${file.name}] - Could not extract text content.`)\n        }\n      } catch (error) {\n        console.error(\"Error processing file:\", error)\n        resolve(`[Document: ${file.name}] - Error reading file content.`)\n      }\n    }\n    \n    reader.onerror = () => {\n      reject(new Error(\"Failed to read file\"))\n    }\n    \n    // Read based on file type\n    if (fileName.endsWith(\".pdf\") || fileName.endsWith(\".docx\") || fileName.endsWith(\".doc\")) {\n      reader.readAsArrayBuffer(file)\n    } else {\n      // Read as text for text files\n      reader.readAsText(file)\n    }\n  })\n}\n\n// Extract text from PDF (basic extraction from ArrayBuffer)\nasync function extractTextFromPDFBuffer(buffer: ArrayBuffer): Promise<string> {\n  try {\n    // Convert ArrayBuffer to string to find text content\n    const uint8Array = new Uint8Array(buffer)\n    let text = \"\"\n    \n    // Look for text streams in PDF\n    const decoder = new TextDecoder(\"utf-8\", { fatal: false })\n    const pdfString = decoder.decode(uint8Array)\n    \n    // Extract text between stream markers (basic PDF text extraction)\n    const streamMatches = pdfString.match(/stream[\\r\\n]+([\\s\\S]*?)[\\r\\n]+endstream/g)\n    if (streamMatches) {\n      for (const match of streamMatches) {\n        // Try to find readable text\n        const readable = match.replace(/stream[\\r\\n]+/, \"\").replace(/[\\r\\n]+endstream/, \"\")\n        // Filter for printable ASCII characters\n        const cleanText = readable.replace(/[^\\x20-\\x7E\\n\\r]/g, \" \").replace(/\\s+/g, \" \").trim()\n        if (cleanText.length > 20) {\n          text += cleanText + \"\\n\"\n        }\n      }\n    }\n    \n    // Also try to extract text objects (Tj, TJ operators)\n    const textMatches = pdfString.match(/\\(([^)]+)\\)\\s*Tj/g)\n    if (textMatches) {\n      for (const match of textMatches) {\n        const content = match.match(/\\(([^)]+)\\)/)\n        if (content && content[1]) {\n          text += content[1] + \" \"\n        }\n      }\n    }\n    \n    return text.trim() || \"\"\n  } catch (error) {\n    console.error(\"PDF extraction error:\", error)\n    return \"\"\n  }\n}\n\n// Basic PDF text extraction (fallback)\nfunction extractTextFromPDF(content: string): string {\n  try {\n    // Try to find text content in PDF\n    const textMatches = content.match(/\\(([^)]+)\\)/g)\n    if (textMatches) {\n      return textMatches\n        .map(m => m.slice(1, -1))\n        .filter(t => t.length > 2 && /[a-zA-Z]/.test(t))\n        .join(\" \")\n    }\n    return \"\"\n  } catch {\n    return \"\"\n  }\n}\n\n// Extract text from DOCX (ZIP-based XML format)\nasync function extractTextFromDocx(buffer: ArrayBuffer): Promise<string> {\n  try {\n    // DOCX is a ZIP file containing XML\n    // We'll use basic extraction by looking for text content\n    const uint8Array = new Uint8Array(buffer)\n    const decoder = new TextDecoder(\"utf-8\", { fatal: false })\n    const content = decoder.decode(uint8Array)\n    \n    // Look for word/document.xml content (the main document)\n    // Extract text between <w:t> tags\n    const textMatches = content.match(/<w:t[^>]*>([^<]*)<\\/w:t>/g)\n    if (textMatches) {\n      const extractedText = textMatches\n        .map(match => {\n          const textContent = match.match(/<w:t[^>]*>([^<]*)<\\/w:t>/)\n          return textContent ? textContent[1] : \"\"\n        })\n        .filter(t => t.length > 0)\n        .join(\" \")\n      \n      if (extractedText.length > 50) {\n        return extractedText\n      }\n    }\n    \n    // Fallback: try to find any readable text\n    const readable = content.replace(/<[^>]+>/g, \" \").replace(/[^\\x20-\\x7E\\n\\r]/g, \" \").replace(/\\s+/g, \" \").trim()\n    \n    // Filter to only substantial text\n    const words = readable.split(\" \").filter(w => w.length > 2 && /^[a-zA-Z]+$/.test(w))\n    if (words.length > 20) {\n      return words.join(\" \")\n    }\n    \n    return `[Word Document] - For best results with .docx files, please copy and paste the text content directly.`\n  } catch (error) {\n    console.error(\"DOCX extraction error:\", error)\n    return `[Word Document] - Could not extract text. Please copy and paste the content.`\n  }\n}\n","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name WandSparkles\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJtMjEuNjQgMy42NC0xLjI4LTEuMjhhMS4yMSAxLjIxIDAgMCAwLTEuNzIgMEwyLjM2IDE4LjY0YTEuMjEgMS4yMSAwIDAgMCAwIDEuNzJsMS4yOCAxLjI4YTEuMiAxLjIgMCAwIDAgMS43MiAwTDIxLjY0IDUuMzZhMS4yIDEuMiAwIDAgMCAwLTEuNzIiIC8+CiAgPHBhdGggZD0ibTE0IDcgMyAzIiAvPgogIDxwYXRoIGQ9Ik01IDZ2NCIgLz4KICA8cGF0aCBkPSJNMTkgMTR2NCIgLz4KICA8cGF0aCBkPSJNMTAgMnYyIiAvPgogIDxwYXRoIGQ9Ik03IDhIMyIgLz4KICA8cGF0aCBkPSJNMjEgMTZoLTQiIC8+CiAgPHBhdGggZD0iTTExIDNIOSIgLz4KPC9zdmc+Cg==) - https://lucide.dev/icons/wand-sparkles\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst WandSparkles = createLucideIcon('WandSparkles', [\n  [\n    'path',\n    {\n      d: 'm21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72',\n      key: 'ul74o6',\n    },\n  ],\n  ['path', { d: 'm14 7 3 3', key: '1r5n42' }],\n  ['path', { d: 'M5 6v4', key: 'ilb8ba' }],\n  ['path', { d: 'M19 14v4', key: 'blhpug' }],\n  ['path', { d: 'M10 2v2', key: '7u0qdc' }],\n  ['path', { d: 'M7 8H3', key: 'zfb6yr' }],\n  ['path', { d: 'M21 16h-4', key: '1cnmox' }],\n  ['path', { d: 'M11 3H9', key: '1obp7u' }],\n]);\n\nexport default WandSparkles;\n"],"names":[],"mappings":"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","ignoreList":[2]}