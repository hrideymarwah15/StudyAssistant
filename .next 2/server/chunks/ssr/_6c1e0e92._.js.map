{"version":3,"sources":["../../../../node_modules/styled-jsx/dist/index/index.js","../../../../node_modules/styled-jsx/style.js","../../../../lib/assistant.ts","../../../../lib/voice.ts","../../../../lib/jarvis/materials-integration.ts","../../../../lib/jarvis/commandExecutor.ts","../../../../components/jarvis-assistant.tsx","../../../../node_modules/lucide-react/src/icons/wifi-off.ts","../../../../node_modules/lucide-react/src/icons/wifi.ts","../../../../lib/jarvis/commandParser.ts"],"sourcesContent":["require('client-only');\nvar React = require('react');\n\nfunction _interopDefaultLegacy (e) { return e && typeof e === 'object' && 'default' in e ? e : { 'default': e }; }\n\nvar React__default = /*#__PURE__*/_interopDefaultLegacy(React);\n\n/*\nBased on Glamor's sheet\nhttps://github.com/threepointone/glamor/blob/667b480d31b3721a905021b26e1290ce92ca2879/src/sheet.js\n*/ function _defineProperties(target, props) {\n    for(var i = 0; i < props.length; i++){\n        var descriptor = props[i];\n        descriptor.enumerable = descriptor.enumerable || false;\n        descriptor.configurable = true;\n        if (\"value\" in descriptor) descriptor.writable = true;\n        Object.defineProperty(target, descriptor.key, descriptor);\n    }\n}\nfunction _createClass(Constructor, protoProps, staticProps) {\n    if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) _defineProperties(Constructor, staticProps);\n    return Constructor;\n}\nvar isProd = typeof process !== \"undefined\" && process.env && process.env.NODE_ENV === \"production\";\nvar isString = function(o) {\n    return Object.prototype.toString.call(o) === \"[object String]\";\n};\nvar StyleSheet = /*#__PURE__*/ function() {\n    function StyleSheet(param) {\n        var ref = param === void 0 ? {} : param, _name = ref.name, name = _name === void 0 ? \"stylesheet\" : _name, _optimizeForSpeed = ref.optimizeForSpeed, optimizeForSpeed = _optimizeForSpeed === void 0 ? isProd : _optimizeForSpeed;\n        invariant$1(isString(name), \"`name` must be a string\");\n        this._name = name;\n        this._deletedRulePlaceholder = \"#\" + name + \"-deleted-rule____{}\";\n        invariant$1(typeof optimizeForSpeed === \"boolean\", \"`optimizeForSpeed` must be a boolean\");\n        this._optimizeForSpeed = optimizeForSpeed;\n        this._serverSheet = undefined;\n        this._tags = [];\n        this._injected = false;\n        this._rulesCount = 0;\n        var node = typeof window !== \"undefined\" && document.querySelector('meta[property=\"csp-nonce\"]');\n        this._nonce = node ? node.getAttribute(\"content\") : null;\n    }\n    var _proto = StyleSheet.prototype;\n    _proto.setOptimizeForSpeed = function setOptimizeForSpeed(bool) {\n        invariant$1(typeof bool === \"boolean\", \"`setOptimizeForSpeed` accepts a boolean\");\n        invariant$1(this._rulesCount === 0, \"optimizeForSpeed cannot be when rules have already been inserted\");\n        this.flush();\n        this._optimizeForSpeed = bool;\n        this.inject();\n    };\n    _proto.isOptimizeForSpeed = function isOptimizeForSpeed() {\n        return this._optimizeForSpeed;\n    };\n    _proto.inject = function inject() {\n        var _this = this;\n        invariant$1(!this._injected, \"sheet already injected\");\n        this._injected = true;\n        if (typeof window !== \"undefined\" && this._optimizeForSpeed) {\n            this._tags[0] = this.makeStyleTag(this._name);\n            this._optimizeForSpeed = \"insertRule\" in this.getSheet();\n            if (!this._optimizeForSpeed) {\n                if (!isProd) {\n                    console.warn(\"StyleSheet: optimizeForSpeed mode not supported falling back to standard mode.\");\n                }\n                this.flush();\n                this._injected = true;\n            }\n            return;\n        }\n        this._serverSheet = {\n            cssRules: [],\n            insertRule: function(rule, index) {\n                if (typeof index === \"number\") {\n                    _this._serverSheet.cssRules[index] = {\n                        cssText: rule\n                    };\n                } else {\n                    _this._serverSheet.cssRules.push({\n                        cssText: rule\n                    });\n                }\n                return index;\n            },\n            deleteRule: function(index) {\n                _this._serverSheet.cssRules[index] = null;\n            }\n        };\n    };\n    _proto.getSheetForTag = function getSheetForTag(tag) {\n        if (tag.sheet) {\n            return tag.sheet;\n        }\n        // this weirdness brought to you by firefox\n        for(var i = 0; i < document.styleSheets.length; i++){\n            if (document.styleSheets[i].ownerNode === tag) {\n                return document.styleSheets[i];\n            }\n        }\n    };\n    _proto.getSheet = function getSheet() {\n        return this.getSheetForTag(this._tags[this._tags.length - 1]);\n    };\n    _proto.insertRule = function insertRule(rule, index) {\n        invariant$1(isString(rule), \"`insertRule` accepts only strings\");\n        if (typeof window === \"undefined\") {\n            if (typeof index !== \"number\") {\n                index = this._serverSheet.cssRules.length;\n            }\n            this._serverSheet.insertRule(rule, index);\n            return this._rulesCount++;\n        }\n        if (this._optimizeForSpeed) {\n            var sheet = this.getSheet();\n            if (typeof index !== \"number\") {\n                index = sheet.cssRules.length;\n            }\n            // this weirdness for perf, and chrome's weird bug\n            // https://stackoverflow.com/questions/20007992/chrome-suddenly-stopped-accepting-insertrule\n            try {\n                sheet.insertRule(rule, index);\n            } catch (error) {\n                if (!isProd) {\n                    console.warn(\"StyleSheet: illegal rule: \\n\\n\" + rule + \"\\n\\nSee https://stackoverflow.com/q/20007992 for more info\");\n                }\n                return -1;\n            }\n        } else {\n            var insertionPoint = this._tags[index];\n            this._tags.push(this.makeStyleTag(this._name, rule, insertionPoint));\n        }\n        return this._rulesCount++;\n    };\n    _proto.replaceRule = function replaceRule(index, rule) {\n        if (this._optimizeForSpeed || typeof window === \"undefined\") {\n            var sheet = typeof window !== \"undefined\" ? this.getSheet() : this._serverSheet;\n            if (!rule.trim()) {\n                rule = this._deletedRulePlaceholder;\n            }\n            if (!sheet.cssRules[index]) {\n                // @TBD Should we throw an error?\n                return index;\n            }\n            sheet.deleteRule(index);\n            try {\n                sheet.insertRule(rule, index);\n            } catch (error) {\n                if (!isProd) {\n                    console.warn(\"StyleSheet: illegal rule: \\n\\n\" + rule + \"\\n\\nSee https://stackoverflow.com/q/20007992 for more info\");\n                }\n                // In order to preserve the indices we insert a deleteRulePlaceholder\n                sheet.insertRule(this._deletedRulePlaceholder, index);\n            }\n        } else {\n            var tag = this._tags[index];\n            invariant$1(tag, \"old rule at index `\" + index + \"` not found\");\n            tag.textContent = rule;\n        }\n        return index;\n    };\n    _proto.deleteRule = function deleteRule(index) {\n        if (typeof window === \"undefined\") {\n            this._serverSheet.deleteRule(index);\n            return;\n        }\n        if (this._optimizeForSpeed) {\n            this.replaceRule(index, \"\");\n        } else {\n            var tag = this._tags[index];\n            invariant$1(tag, \"rule at index `\" + index + \"` not found\");\n            tag.parentNode.removeChild(tag);\n            this._tags[index] = null;\n        }\n    };\n    _proto.flush = function flush() {\n        this._injected = false;\n        this._rulesCount = 0;\n        if (typeof window !== \"undefined\") {\n            this._tags.forEach(function(tag) {\n                return tag && tag.parentNode.removeChild(tag);\n            });\n            this._tags = [];\n        } else {\n            // simpler on server\n            this._serverSheet.cssRules = [];\n        }\n    };\n    _proto.cssRules = function cssRules() {\n        var _this = this;\n        if (typeof window === \"undefined\") {\n            return this._serverSheet.cssRules;\n        }\n        return this._tags.reduce(function(rules, tag) {\n            if (tag) {\n                rules = rules.concat(Array.prototype.map.call(_this.getSheetForTag(tag).cssRules, function(rule) {\n                    return rule.cssText === _this._deletedRulePlaceholder ? null : rule;\n                }));\n            } else {\n                rules.push(null);\n            }\n            return rules;\n        }, []);\n    };\n    _proto.makeStyleTag = function makeStyleTag(name, cssString, relativeToTag) {\n        if (cssString) {\n            invariant$1(isString(cssString), \"makeStyleTag accepts only strings as second parameter\");\n        }\n        var tag = document.createElement(\"style\");\n        if (this._nonce) tag.setAttribute(\"nonce\", this._nonce);\n        tag.type = \"text/css\";\n        tag.setAttribute(\"data-\" + name, \"\");\n        if (cssString) {\n            tag.appendChild(document.createTextNode(cssString));\n        }\n        var head = document.head || document.getElementsByTagName(\"head\")[0];\n        if (relativeToTag) {\n            head.insertBefore(tag, relativeToTag);\n        } else {\n            head.appendChild(tag);\n        }\n        return tag;\n    };\n    _createClass(StyleSheet, [\n        {\n            key: \"length\",\n            get: function get() {\n                return this._rulesCount;\n            }\n        }\n    ]);\n    return StyleSheet;\n}();\nfunction invariant$1(condition, message) {\n    if (!condition) {\n        throw new Error(\"StyleSheet: \" + message + \".\");\n    }\n}\n\nfunction hash(str) {\n    var _$hash = 5381, i = str.length;\n    while(i){\n        _$hash = _$hash * 33 ^ str.charCodeAt(--i);\n    }\n    /* JavaScript does bitwise operations (like XOR, above) on 32-bit signed\n   * integers. Since we want the results to be always positive, convert the\n   * signed int to an unsigned by doing an unsigned bitshift. */ return _$hash >>> 0;\n}\nvar stringHash = hash;\n\nvar sanitize = function(rule) {\n    return rule.replace(/\\/style/gi, \"\\\\/style\");\n};\nvar cache = {};\n/**\n * computeId\n *\n * Compute and memoize a jsx id from a basedId and optionally props.\n */ function computeId(baseId, props) {\n    if (!props) {\n        return \"jsx-\" + baseId;\n    }\n    var propsToString = String(props);\n    var key = baseId + propsToString;\n    if (!cache[key]) {\n        cache[key] = \"jsx-\" + stringHash(baseId + \"-\" + propsToString);\n    }\n    return cache[key];\n}\n/**\n * computeSelector\n *\n * Compute and memoize dynamic selectors.\n */ function computeSelector(id, css) {\n    var selectoPlaceholderRegexp = /__jsx-style-dynamic-selector/g;\n    // Sanitize SSR-ed CSS.\n    // Client side code doesn't need to be sanitized since we use\n    // document.createTextNode (dev) and the CSSOM api sheet.insertRule (prod).\n    if (typeof window === \"undefined\") {\n        css = sanitize(css);\n    }\n    var idcss = id + css;\n    if (!cache[idcss]) {\n        cache[idcss] = css.replace(selectoPlaceholderRegexp, id);\n    }\n    return cache[idcss];\n}\n\nfunction mapRulesToStyle(cssRules, options) {\n    if (options === void 0) options = {};\n    return cssRules.map(function(args) {\n        var id = args[0];\n        var css = args[1];\n        return /*#__PURE__*/ React__default[\"default\"].createElement(\"style\", {\n            id: \"__\" + id,\n            // Avoid warnings upon render with a key\n            key: \"__\" + id,\n            nonce: options.nonce ? options.nonce : undefined,\n            dangerouslySetInnerHTML: {\n                __html: css\n            }\n        });\n    });\n}\nvar StyleSheetRegistry = /*#__PURE__*/ function() {\n    function StyleSheetRegistry(param) {\n        var ref = param === void 0 ? {} : param, _styleSheet = ref.styleSheet, styleSheet = _styleSheet === void 0 ? null : _styleSheet, _optimizeForSpeed = ref.optimizeForSpeed, optimizeForSpeed = _optimizeForSpeed === void 0 ? false : _optimizeForSpeed;\n        this._sheet = styleSheet || new StyleSheet({\n            name: \"styled-jsx\",\n            optimizeForSpeed: optimizeForSpeed\n        });\n        this._sheet.inject();\n        if (styleSheet && typeof optimizeForSpeed === \"boolean\") {\n            this._sheet.setOptimizeForSpeed(optimizeForSpeed);\n            this._optimizeForSpeed = this._sheet.isOptimizeForSpeed();\n        }\n        this._fromServer = undefined;\n        this._indices = {};\n        this._instancesCounts = {};\n    }\n    var _proto = StyleSheetRegistry.prototype;\n    _proto.add = function add(props) {\n        var _this = this;\n        if (undefined === this._optimizeForSpeed) {\n            this._optimizeForSpeed = Array.isArray(props.children);\n            this._sheet.setOptimizeForSpeed(this._optimizeForSpeed);\n            this._optimizeForSpeed = this._sheet.isOptimizeForSpeed();\n        }\n        if (typeof window !== \"undefined\" && !this._fromServer) {\n            this._fromServer = this.selectFromServer();\n            this._instancesCounts = Object.keys(this._fromServer).reduce(function(acc, tagName) {\n                acc[tagName] = 0;\n                return acc;\n            }, {});\n        }\n        var ref = this.getIdAndRules(props), styleId = ref.styleId, rules = ref.rules;\n        // Deduping: just increase the instances count.\n        if (styleId in this._instancesCounts) {\n            this._instancesCounts[styleId] += 1;\n            return;\n        }\n        var indices = rules.map(function(rule) {\n            return _this._sheet.insertRule(rule);\n        })// Filter out invalid rules\n        .filter(function(index) {\n            return index !== -1;\n        });\n        this._indices[styleId] = indices;\n        this._instancesCounts[styleId] = 1;\n    };\n    _proto.remove = function remove(props) {\n        var _this = this;\n        var styleId = this.getIdAndRules(props).styleId;\n        invariant(styleId in this._instancesCounts, \"styleId: `\" + styleId + \"` not found\");\n        this._instancesCounts[styleId] -= 1;\n        if (this._instancesCounts[styleId] < 1) {\n            var tagFromServer = this._fromServer && this._fromServer[styleId];\n            if (tagFromServer) {\n                tagFromServer.parentNode.removeChild(tagFromServer);\n                delete this._fromServer[styleId];\n            } else {\n                this._indices[styleId].forEach(function(index) {\n                    return _this._sheet.deleteRule(index);\n                });\n                delete this._indices[styleId];\n            }\n            delete this._instancesCounts[styleId];\n        }\n    };\n    _proto.update = function update(props, nextProps) {\n        this.add(nextProps);\n        this.remove(props);\n    };\n    _proto.flush = function flush() {\n        this._sheet.flush();\n        this._sheet.inject();\n        this._fromServer = undefined;\n        this._indices = {};\n        this._instancesCounts = {};\n    };\n    _proto.cssRules = function cssRules() {\n        var _this = this;\n        var fromServer = this._fromServer ? Object.keys(this._fromServer).map(function(styleId) {\n            return [\n                styleId,\n                _this._fromServer[styleId]\n            ];\n        }) : [];\n        var cssRules = this._sheet.cssRules();\n        return fromServer.concat(Object.keys(this._indices).map(function(styleId) {\n            return [\n                styleId,\n                _this._indices[styleId].map(function(index) {\n                    return cssRules[index].cssText;\n                }).join(_this._optimizeForSpeed ? \"\" : \"\\n\")\n            ];\n        })// filter out empty rules\n        .filter(function(rule) {\n            return Boolean(rule[1]);\n        }));\n    };\n    _proto.styles = function styles(options) {\n        return mapRulesToStyle(this.cssRules(), options);\n    };\n    _proto.getIdAndRules = function getIdAndRules(props) {\n        var css = props.children, dynamic = props.dynamic, id = props.id;\n        if (dynamic) {\n            var styleId = computeId(id, dynamic);\n            return {\n                styleId: styleId,\n                rules: Array.isArray(css) ? css.map(function(rule) {\n                    return computeSelector(styleId, rule);\n                }) : [\n                    computeSelector(styleId, css)\n                ]\n            };\n        }\n        return {\n            styleId: computeId(id),\n            rules: Array.isArray(css) ? css : [\n                css\n            ]\n        };\n    };\n    /**\n   * selectFromServer\n   *\n   * Collects style tags from the document with id __jsx-XXX\n   */ _proto.selectFromServer = function selectFromServer() {\n        var elements = Array.prototype.slice.call(document.querySelectorAll('[id^=\"__jsx-\"]'));\n        return elements.reduce(function(acc, element) {\n            var id = element.id.slice(2);\n            acc[id] = element;\n            return acc;\n        }, {});\n    };\n    return StyleSheetRegistry;\n}();\nfunction invariant(condition, message) {\n    if (!condition) {\n        throw new Error(\"StyleSheetRegistry: \" + message + \".\");\n    }\n}\nvar StyleSheetContext = /*#__PURE__*/ React.createContext(null);\nStyleSheetContext.displayName = \"StyleSheetContext\";\nfunction createStyleRegistry() {\n    return new StyleSheetRegistry();\n}\nfunction StyleRegistry(param) {\n    var configuredRegistry = param.registry, children = param.children;\n    var rootRegistry = React.useContext(StyleSheetContext);\n    var ref = React.useState(function() {\n        return rootRegistry || configuredRegistry || createStyleRegistry();\n    }), registry = ref[0];\n    return /*#__PURE__*/ React__default[\"default\"].createElement(StyleSheetContext.Provider, {\n        value: registry\n    }, children);\n}\nfunction useStyleRegistry() {\n    return React.useContext(StyleSheetContext);\n}\n\n// Opt-into the new `useInsertionEffect` API in React 18, fallback to `useLayoutEffect`.\n// https://github.com/reactwg/react-18/discussions/110\nvar useInsertionEffect = React__default[\"default\"].useInsertionEffect || React__default[\"default\"].useLayoutEffect;\nvar defaultRegistry = typeof window !== \"undefined\" ? createStyleRegistry() : undefined;\nfunction JSXStyle(props) {\n    var registry = defaultRegistry ? defaultRegistry : useStyleRegistry();\n    // If `registry` does not exist, we do nothing here.\n    if (!registry) {\n        return null;\n    }\n    if (typeof window === \"undefined\") {\n        registry.add(props);\n        return null;\n    }\n    useInsertionEffect(function() {\n        registry.add(props);\n        return function() {\n            registry.remove(props);\n        };\n    // props.children can be string[], will be striped since id is identical\n    }, [\n        props.id,\n        String(props.dynamic)\n    ]);\n    return null;\n}\nJSXStyle.dynamic = function(info) {\n    return info.map(function(tagInfo) {\n        var baseId = tagInfo[0];\n        var props = tagInfo[1];\n        return computeId(baseId, props);\n    }).join(\" \");\n};\n\nexports.StyleRegistry = StyleRegistry;\nexports.createStyleRegistry = createStyleRegistry;\nexports.style = JSXStyle;\nexports.useStyleRegistry = useStyleRegistry;\n","module.exports = require('./dist/index').style\n","\"use client\"\n\nimport { chat, generateFlashcards, generateQuiz, summarizeContent, explainConcept, Message } from \"./ai-client\"\nimport { getMaterials } from \"./firestore\"\n\n// ==================== INTENT DETECTION ====================\nexport type Intent =\n  | \"create_flashcards\"\n  | \"quiz_me\"\n  | \"explain\"\n  | \"summarize\"\n  | \"navigate\"\n  | \"add_task\"\n  | \"remember\"\n  | \"search_materials\"\n  | \"general_question\"\n  | \"greeting\"\n  | \"help\"\n  | \"unknown\"\n\nexport interface ParsedCommand {\n  intent: Intent\n  entities: {\n    topic?: string\n    count?: number\n    difficulty?: \"easy\" | \"medium\" | \"hard\"\n    destination?: string\n    date?: string\n    content?: string\n    query?: string\n  }\n  originalText: string\n  confidence: number\n}\n\n// Intent patterns for quick local detection\nconst intentPatterns: { intent: Intent; patterns: RegExp[] }[] = [\n  {\n    intent: \"create_flashcards\",\n    patterns: [\n      /create\\s+(\\d+\\s+)?flashcards?\\s+(about|on|for)\\s+(.+)/i,\n      /make\\s+(\\d+\\s+)?flashcards?\\s+(about|on|for)\\s+(.+)/i,\n      /generate\\s+(\\d+\\s+)?flashcards?\\s+(about|on|for)\\s+(.+)/i,\n      /flashcards?\\s+(about|on|for)\\s+(.+)/i\n    ]\n  },\n  {\n    intent: \"quiz_me\",\n    patterns: [\n      /quiz\\s+me\\s+(on|about)\\s+(.+)/i,\n      /test\\s+me\\s+(on|about)\\s+(.+)/i,\n      /ask\\s+me\\s+questions?\\s+(about|on)\\s+(.+)/i\n    ]\n  },\n  {\n    intent: \"explain\",\n    patterns: [\n      /explain\\s+(.+)/i,\n      /what\\s+is\\s+(.+)/i,\n      /what\\s+are\\s+(.+)/i,\n      /tell\\s+me\\s+about\\s+(.+)/i,\n      /how\\s+does\\s+(.+)\\s+work/i\n    ]\n  },\n  {\n    intent: \"summarize\",\n    patterns: [\n      /summarize\\s+(.+)/i,\n      /summary\\s+of\\s+(.+)/i,\n      /give\\s+me\\s+a\\s+summary\\s+of\\s+(.+)/i\n    ]\n  },\n  {\n    intent: \"navigate\",\n    patterns: [\n      /go\\s+to\\s+(.+)/i,\n      /open\\s+(.+)/i,\n      /show\\s+me\\s+(.+)/i,\n      /take\\s+me\\s+to\\s+(.+)/i\n    ]\n  },\n  {\n    intent: \"add_task\",\n    patterns: [\n      /add\\s+task\\s+(.+)/i,\n      /create\\s+task\\s+(.+)/i,\n      /remind\\s+me\\s+to\\s+(.+)/i,\n      /schedule\\s+(.+)/i\n    ]\n  },\n  {\n    intent: \"remember\",\n    patterns: [\n      /remember\\s+that\\s+(.+)/i,\n      /note\\s+that\\s+(.+)/i,\n      /save\\s+this:\\s*(.+)/i,\n      /keep\\s+in\\s+mind\\s+(.+)/i\n    ]\n  },\n  {\n    intent: \"search_materials\",\n    patterns: [\n      /search\\s+(for\\s+)?(.+)\\s+in\\s+materials/i,\n      /find\\s+(.+)\\s+in\\s+my\\s+(notes|materials)/i,\n      /do\\s+i\\s+have\\s+(notes|materials)\\s+on\\s+(.+)/i,\n      /what\\s+do\\s+i\\s+have\\s+on\\s+(.+)/i\n    ]\n  },\n  {\n    intent: \"greeting\",\n    patterns: [\n      /^(hi|hello|hey|good\\s+(morning|afternoon|evening)|howdy|yo)[\\s!?.]*$/i\n    ]\n  },\n  {\n    intent: \"help\",\n    patterns: [\n      /^(help|what\\s+can\\s+you\\s+do|commands|how\\s+do\\s+i)[\\s?]*$/i,\n      /show\\s+(me\\s+)?help/i\n    ]\n  }\n]\n\n// Page name mappings for navigation\nconst pageAliases: { [key: string]: string } = {\n  \"flashcards\": \"/flashcards\",\n  \"flash cards\": \"/flashcards\",\n  \"cards\": \"/flashcards\",\n  \"materials\": \"/materials\",\n  \"notes\": \"/materials\",\n  \"documents\": \"/materials\",\n  \"planner\": \"/planner\",\n  \"schedule\": \"/planner\",\n  \"calendar\": \"/planner\",\n  \"tasks\": \"/planner\",\n  \"groups\": \"/groups\",\n  \"study groups\": \"/groups\",\n  \"support\": \"/support\",\n  \"help\": \"/support\",\n  \"home\": \"/\",\n  \"dashboard\": \"/\",\n  \"settings\": \"/settings\"\n}\n\n// Parse user input into a command\nexport function parseCommand(input: string): ParsedCommand {\n  const trimmedInput = input.trim()\n  \n  // Check each intent pattern\n  for (const { intent, patterns } of intentPatterns) {\n    for (const pattern of patterns) {\n      const match = trimmedInput.match(pattern)\n      if (match) {\n        const entities = extractEntities(intent, match, trimmedInput)\n        return {\n          intent,\n          entities,\n          originalText: trimmedInput,\n          confidence: 0.9\n        }\n      }\n    }\n  }\n\n  // Default to general question if no pattern matches\n  return {\n    intent: \"general_question\",\n    entities: { query: trimmedInput },\n    originalText: trimmedInput,\n    confidence: 0.5\n  }\n}\n\n// Extract entities from matched patterns\nfunction extractEntities(\n  intent: Intent,\n  match: RegExpMatchArray,\n  originalText: string\n): ParsedCommand[\"entities\"] {\n  const entities: ParsedCommand[\"entities\"] = {}\n\n  switch (intent) {\n    case \"create_flashcards\": {\n      // Extract count if present\n      const countMatch = originalText.match(/(\\d+)\\s+flashcards?/i)\n      if (countMatch) {\n        entities.count = parseInt(countMatch[1])\n      }\n      // Extract topic - last captured group\n      entities.topic = match[match.length - 1]?.trim()\n      // Extract difficulty\n      const diffMatch = originalText.match(/(easy|medium|hard)/i)\n      if (diffMatch) {\n        entities.difficulty = diffMatch[1].toLowerCase() as \"easy\" | \"medium\" | \"hard\"\n      }\n      break\n    }\n    case \"quiz_me\":\n      entities.topic = match[match.length - 1]?.trim()\n      break\n    case \"explain\":\n      entities.topic = match[1]?.trim()\n      break\n    case \"summarize\":\n      entities.content = match[1]?.trim()\n      break\n    case \"navigate\": {\n      const destination = match[1]?.toLowerCase().trim()\n      entities.destination = pageAliases[destination] || destination\n      break\n    }\n    case \"add_task\":\n      entities.content = match[1]?.trim()\n      break\n    case \"remember\":\n      entities.content = match[1]?.trim()\n      break\n    case \"search_materials\":\n      entities.query = match[match.length - 1]?.trim()\n      break\n  }\n\n  return entities\n}\n\n// ==================== COMMAND EXECUTION ====================\nexport interface AssistantContext {\n  userId?: string\n  currentPage?: string\n  conversationHistory?: Message[]\n  userMaterials?: Array<{ id: string; title: string; subject?: string }>\n  userDecks?: Array<{ id: string; name: string }>\n}\n\nexport interface CommandResult {\n  success: boolean\n  message: string\n  action?: {\n    type: \"navigate\" | \"show_flashcards\" | \"show_quiz\" | \"speak\" | \"add_memory\" | \"none\"\n    data?: any\n  }\n  followUp?: string\n}\n\nexport async function executeCommand(\n  command: ParsedCommand,\n  context: AssistantContext\n): Promise<CommandResult> {\n  switch (command.intent) {\n    case \"greeting\":\n      return {\n        success: true,\n        message: getGreeting(),\n        action: { type: \"speak\" }\n      }\n\n    case \"help\":\n      return {\n        success: true,\n        message: getHelpMessage(),\n        action: { type: \"none\" }\n      }\n\n    case \"navigate\":\n      if (command.entities.destination) {\n        return {\n          success: true,\n          message: `Taking you to ${command.entities.destination}...`,\n          action: {\n            type: \"navigate\",\n            data: { path: command.entities.destination }\n          }\n        }\n      }\n      return {\n        success: false,\n        message: \"I didn't catch where you want to go. Try saying 'go to flashcards' or 'open planner'.\"\n      }\n\n    case \"create_flashcards\":\n      if (command.entities.topic && context.userId) {\n        try {\n          const count = command.entities.count || 5\n          const difficulty = command.entities.difficulty || \"medium\"\n          \n          // Try to find relevant materials for the topic\n          const userMaterials = await getMaterials(context.userId)\n          const relevantMaterials = userMaterials.filter(m => \n            m.title?.toLowerCase().includes(command.entities.topic!.toLowerCase()) ||\n            m.subject?.toLowerCase().includes(command.entities.topic!.toLowerCase()) ||\n            m.content?.toLowerCase().includes(command.entities.topic!.toLowerCase())\n          )\n          \n          let content = \"\"\n          let topic = command.entities.topic\n          \n          if (relevantMaterials.length > 0) {\n            // Use the most relevant material's content\n            const bestMatch = relevantMaterials[0]\n            content = bestMatch.content || \"\"\n            topic = bestMatch.title || bestMatch.subject || command.entities.topic\n          }\n          \n          const flashcards = await generateFlashcards(\n            content,\n            topic,\n            count,\n            difficulty\n          )\n          return {\n            success: true,\n            message: relevantMaterials.length > 0 \n              ? `I've created ${flashcards.length} flashcards about \"${topic}\" using your study materials.`\n              : `I've created ${flashcards.length} flashcards about \"${command.entities.topic}\".`,\n            action: {\n              type: \"show_flashcards\",\n              data: { flashcards, topic: command.entities.topic }\n            }\n          }\n        } catch (error: any) {\n          return {\n            success: false,\n            message: `Sorry, I couldn't create flashcards: ${error.message}`\n          }\n        }\n      }\n      return {\n        success: false,\n        message: \"What topic would you like flashcards about?\"\n      }\n\n    case \"quiz_me\":\n      if (command.entities.topic && context.userId) {\n        try {\n          // Try to find relevant materials for the topic\n          const userMaterials = await getMaterials(context.userId)\n          const relevantMaterials = userMaterials.filter(m => \n            m.title?.toLowerCase().includes(command.entities.topic!.toLowerCase()) ||\n            m.subject?.toLowerCase().includes(command.entities.topic!.toLowerCase()) ||\n            m.content?.toLowerCase().includes(command.entities.topic!.toLowerCase())\n          )\n          \n          let content = \"\"\n          let topic = command.entities.topic\n          \n          if (relevantMaterials.length > 0) {\n            // Use the most relevant material's content\n            const bestMatch = relevantMaterials[0]\n            content = bestMatch.content || \"\"\n            topic = bestMatch.title || bestMatch.subject || command.entities.topic\n          }\n          \n          const quiz = await generateQuiz(content, topic, 5)\n          return {\n            success: true,\n            message: relevantMaterials.length > 0 \n              ? `Let's quiz you on \"${topic}\" using your study materials! I have ${quiz.length} questions ready.`\n              : `Let's quiz you on \"${command.entities.topic}\"! I have ${quiz.length} questions ready.`,\n            action: {\n              type: \"show_quiz\",\n              data: { quiz, topic: command.entities.topic }\n            }\n          }\n        } catch (error: any) {\n          return {\n            success: false,\n            message: `Sorry, I couldn't create a quiz: ${error.message}`\n          }\n        }\n      }\n      return {\n        success: false,\n        message: \"What topic would you like me to quiz you on?\"\n      }\n\n    case \"explain\":\n      if (command.entities.topic) {\n        try {\n          const explanation = await explainConcept(command.entities.topic)\n          return {\n            success: true,\n            message: explanation,\n            action: { type: \"speak\" }\n          }\n        } catch (error: any) {\n          return {\n            success: false,\n            message: `Sorry, I couldn't explain that: ${error.message}`\n          }\n        }\n      }\n      return {\n        success: false,\n        message: \"What would you like me to explain?\"\n      }\n\n    case \"summarize\":\n      if (command.entities.content) {\n        try {\n          const summary = await summarizeContent(command.entities.content)\n          return {\n            success: true,\n            message: summary,\n            action: { type: \"speak\" }\n          }\n        } catch (error: any) {\n          return {\n            success: false,\n            message: `Sorry, I couldn't summarize that: ${error.message}`\n          }\n        }\n      }\n      return {\n        success: false,\n        message: \"What would you like me to summarize?\"\n      }\n\n    case \"remember\":\n      if (command.entities.content) {\n        return {\n          success: true,\n          message: `Got it! I'll remember: \"${command.entities.content}\"`,\n          action: {\n            type: \"add_memory\",\n            data: { content: command.entities.content, category: \"note\" }\n          }\n        }\n      }\n      return {\n        success: false,\n        message: \"What would you like me to remember?\"\n      }\n\n    case \"search_materials\":\n      if (command.entities.query && context.userMaterials) {\n        const matches = context.userMaterials.filter(m =>\n          m.title.toLowerCase().includes(command.entities.query!.toLowerCase()) ||\n          m.subject?.toLowerCase().includes(command.entities.query!.toLowerCase())\n        )\n        if (matches.length > 0) {\n          return {\n            success: true,\n            message: `I found ${matches.length} material(s) related to \"${command.entities.query}\": ${matches.map(m => m.title).join(\", \")}`\n          }\n        }\n        return {\n          success: true,\n          message: `I didn't find any materials about \"${command.entities.query}\" in your library.`\n        }\n      }\n      return {\n        success: false,\n        message: \"What are you looking for in your materials?\"\n      }\n\n    case \"add_task\":\n      return {\n        success: true,\n        message: `I'll add \"${command.entities.content}\" to your planner. You can refine it there.`,\n        action: {\n          type: \"navigate\",\n          data: { path: \"/planner\", prefill: command.entities.content }\n        }\n      }\n\n    case \"general_question\":\n    default:\n      try {\n        const response = await chat([\n          { role: \"user\", content: command.originalText }\n        ], {\n          systemPrompt: `You are JARVIS (Just A Rather Very Intelligent System), an advanced AI assistant for students. \nSpeak in a polite, sophisticated manner like the AI assistant from Iron Man - helpful, slightly witty, and professional.\nBe concise and educational. Use phrases like \"Certainly, sir/madam\", \"Right away\", \"I've analyzed...\", \"May I suggest...\"\n${context.currentPage ? `User is currently viewing: ${context.currentPage}` : \"\"}\n${context.userMaterials?.length ? `User's study materials include: ${context.userMaterials.map(m => m.title).join(\", \")}` : \"\"}`\n        })\n        return {\n          success: true,\n          message: response,\n          action: { type: \"speak\" }\n        }\n      } catch (error: any) {\n        return {\n          success: false,\n          message: \"I apologize, but I'm experiencing a temporary disruption. Shall I try again?\"\n        }\n      }\n  }\n}\n\n// ==================== HELPERS ====================\nfunction getGreeting(): string {\n  const hour = new Date().getHours()\n  let timeGreeting = \"Good day\"\n  if (hour < 12) timeGreeting = \"Good morning\"\n  else if (hour < 17) timeGreeting = \"Good afternoon\"\n  else timeGreeting = \"Good evening\"\n  \n  const greetings = [\n    `${timeGreeting}. JARVIS at your service. How may I assist with your studies today?`,\n    `${timeGreeting}. All systems operational. What shall we work on?`,\n    `${timeGreeting}. I'm ready to help optimize your learning experience.`\n  ]\n  return greetings[Math.floor(Math.random() * greetings.length)]\n}\n\nfunction getHelpMessage(): string {\n  return `Certainly. Here are my capabilities:\n\nðŸ“š **Flashcard Generation**: \"Create 10 flashcards about photosynthesis\"\nðŸ§  **Knowledge Testing**: \"Quiz me on World War 2\"\nðŸ’¡ **Concept Explanation**: \"Explain quantum entanglement\"\nðŸ“ **Content Summarization**: \"Summarize [paste content]\"\nðŸ“ **App Navigation**: \"Go to planner\" or \"Open materials\"\nâœ… **Task Management**: \"Add task: Study for math exam\"\nðŸ”– **Memory Storage**: \"Remember that the test is on Friday\"\nðŸ” **Material Search**: \"What do I have on biology?\"\n\nSimply state your request naturally, and I shall endeavor to assist.`\n}\n\n// Quick action suggestions based on context\nexport function getSuggestedActions(context: AssistantContext): string[] {\n  const suggestions: string[] = []\n  \n  switch (context.currentPage) {\n    case \"flashcards\":\n      suggestions.push(\"Create flashcards about...\")\n      suggestions.push(\"Quiz me on my decks\")\n      break\n    case \"materials\":\n      suggestions.push(\"Summarize my notes\")\n      suggestions.push(\"Create flashcards from materials\")\n      break\n    case \"planner\":\n      suggestions.push(\"What's due this week?\")\n      suggestions.push(\"Add a study task\")\n      break\n    default:\n      suggestions.push(\"Create flashcards\")\n      suggestions.push(\"Quiz me\")\n      suggestions.push(\"Explain a concept\")\n  }\n  \n  return suggestions\n}\n","\"use client\"\n\nimport { useState, useEffect, useCallback, useRef } from \"react\"\n\n// Web Speech API types\ninterface SpeechRecognitionEvent extends Event {\n  results: SpeechRecognitionResultList\n  resultIndex: number\n}\n\ninterface SpeechRecognitionResultList {\n  length: number\n  item(index: number): SpeechRecognitionResult\n  [index: number]: SpeechRecognitionResult\n}\n\ninterface SpeechRecognitionResult {\n  isFinal: boolean\n  length: number\n  item(index: number): SpeechRecognitionAlternative\n  [index: number]: SpeechRecognitionAlternative\n}\n\ninterface SpeechRecognitionAlternative {\n  transcript: string\n  confidence: number\n}\n\ninterface SpeechRecognition extends EventTarget {\n  continuous: boolean\n  interimResults: boolean\n  lang: string\n  start(): void\n  stop(): void\n  abort(): void\n  onerror: ((event: Event & { error: string }) => void) | null\n  onresult: ((event: SpeechRecognitionEvent) => void) | null\n  onstart: (() => void) | null\n  onend: (() => void) | null\n  onspeechend: (() => void) | null\n}\n\ndeclare global {\n  interface Window {\n    SpeechRecognition: new () => SpeechRecognition\n    webkitSpeechRecognition: new () => SpeechRecognition\n  }\n}\n\nexport interface VoiceInputState {\n  isListening: boolean\n  transcript: string\n  interimTranscript: string\n  error: string | null\n  isSupported: boolean\n}\n\nexport interface UseVoiceInputOptions {\n  continuous?: boolean\n  language?: string\n  onResult?: (transcript: string, isFinal: boolean) => void\n  onError?: (error: string) => void\n  onStart?: () => void\n  onEnd?: () => void\n}\n\n// Check if speech recognition is supported\nexport function isSpeechRecognitionSupported(): boolean {\n  if (typeof window === \"undefined\") return false\n  return !!(window.SpeechRecognition || window.webkitSpeechRecognition)\n}\n\n// Main hook for voice input\nexport function useVoiceInput(options: UseVoiceInputOptions = {}): {\n  state: VoiceInputState\n  startListening: () => void\n  stopListening: () => void\n  resetTranscript: () => void\n} {\n  const {\n    continuous = false,\n    language = \"en-US\",\n    onResult,\n    onError,\n    onStart,\n    onEnd\n  } = options\n\n  const [state, setState] = useState<VoiceInputState>({\n    isListening: false,\n    transcript: \"\",\n    interimTranscript: \"\",\n    error: null,\n    isSupported: false\n  })\n\n  const recognitionRef = useRef<SpeechRecognition | null>(null)\n  const transcriptRef = useRef(\"\")\n  \n  // Store callbacks in refs to avoid re-running useEffect\n  const onResultRef = useRef(onResult)\n  const onErrorRef = useRef(onError)\n  const onStartRef = useRef(onStart)\n  const onEndRef = useRef(onEnd)\n  \n  // Update refs when callbacks change\n  useEffect(() => {\n    onResultRef.current = onResult\n    onErrorRef.current = onError\n    onStartRef.current = onStart\n    onEndRef.current = onEnd\n  })\n\n  // Initialize speech recognition - only run once\n  useEffect(() => {\n    if (typeof window === \"undefined\") return\n\n    const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition\n    \n    if (!SpeechRecognition) {\n      setState(prev => ({ ...prev, isSupported: false }))\n      return\n    }\n\n    setState(prev => ({ ...prev, isSupported: true }))\n\n    const recognition = new SpeechRecognition()\n    recognition.continuous = continuous\n    recognition.interimResults = true\n    recognition.lang = language\n\n    recognition.onstart = () => {\n      setState(prev => ({ ...prev, isListening: true, error: null }))\n      onStartRef.current?.()\n    }\n\n    recognition.onend = () => {\n      setState(prev => ({ ...prev, isListening: false }))\n      onEndRef.current?.()\n    }\n\n    recognition.onerror = (event) => {\n      const errorMessage = getErrorMessage(event.error)\n      setState(prev => ({ ...prev, error: errorMessage, isListening: false }))\n      onErrorRef.current?.(errorMessage)\n    }\n\n    recognition.onresult = (event) => {\n      let interimTranscript = \"\"\n      let finalTranscript = transcriptRef.current\n\n      for (let i = event.resultIndex; i < event.results.length; i++) {\n        const result = event.results[i]\n        const transcript = result[0].transcript\n\n        if (result.isFinal) {\n          finalTranscript += transcript + \" \"\n          transcriptRef.current = finalTranscript\n          onResultRef.current?.(transcript.trim(), true)\n        } else {\n          interimTranscript += transcript\n          onResultRef.current?.(transcript, false)\n        }\n      }\n\n      setState(prev => ({\n        ...prev,\n        transcript: finalTranscript.trim(),\n        interimTranscript\n      }))\n    }\n\n    recognitionRef.current = recognition\n\n    return () => {\n      recognition.abort()\n    }\n  }, [continuous, language]) // Only re-run when these change, not callbacks\n\n  const startListening = useCallback(() => {\n    if (!recognitionRef.current) return\n    \n    try {\n      transcriptRef.current = \"\"\n      setState(prev => ({ ...prev, transcript: \"\", interimTranscript: \"\", error: null }))\n      recognitionRef.current.start()\n    } catch (error) {\n      console.error(\"Error starting speech recognition:\", error)\n    }\n  }, [])\n\n  const stopListening = useCallback(() => {\n    if (!recognitionRef.current) return\n    \n    try {\n      recognitionRef.current.stop()\n    } catch (error) {\n      console.error(\"Error stopping speech recognition:\", error)\n    }\n  }, [])\n\n  const resetTranscript = useCallback(() => {\n    transcriptRef.current = \"\"\n    setState(prev => ({ ...prev, transcript: \"\", interimTranscript: \"\" }))\n  }, [])\n\n  return {\n    state,\n    startListening,\n    stopListening,\n    resetTranscript\n  }\n}\n\n// Helper to get human-readable error messages\nfunction getErrorMessage(error: string): string {\n  switch (error) {\n    case \"no-speech\":\n      return \"No speech detected. Please try again.\"\n    case \"audio-capture\":\n      return \"No microphone found. Please check your audio settings.\"\n    case \"not-allowed\":\n      return \"Microphone access denied. Please allow microphone access.\"\n    case \"network\":\n      return \"Network error. Please check your connection.\"\n    case \"aborted\":\n      return \"Speech recognition was aborted.\"\n    case \"language-not-supported\":\n      return \"Language not supported.\"\n    case \"service-not-allowed\":\n      return \"Speech recognition service not allowed.\"\n    default:\n      return `Speech recognition error: ${error}`\n  }\n}\n\n// Text-to-Speech utility\nexport interface SpeakOptions {\n  rate?: number // 0.1 to 10, default 1\n  pitch?: number // 0 to 2, default 1\n  volume?: number // 0 to 1, default 1\n  voice?: SpeechSynthesisVoice | null\n  lang?: string\n}\n\nexport function speak(text: string, options: SpeakOptions = {}): Promise<void> {\n  return new Promise((resolve, reject) => {\n    if (typeof window === \"undefined\" || !window.speechSynthesis) {\n      reject(new Error(\"Speech synthesis not supported\"))\n      return\n    }\n\n    // Cancel any ongoing speech\n    window.speechSynthesis.cancel()\n\n    const utterance = new SpeechSynthesisUtterance(text)\n    utterance.rate = options.rate ?? 1.1\n    utterance.pitch = options.pitch ?? 1.1\n    utterance.volume = options.volume ?? 0.9\n    utterance.lang = options.lang ?? \"en-US\"\n\n    // Try to find a female voice for smoother sound\n    if (!options.voice) {\n      const voices = window.speechSynthesis.getVoices()\n      // Prefer: Samantha (macOS), Google UK Female, Microsoft Zira, any female voice\n      const femaleVoice = voices.find(v => \n        v.name.includes(\"Samantha\") || \n        v.name.includes(\"Female\") || \n        v.name.includes(\"Zira\") ||\n        v.name.includes(\"Karen\") ||\n        v.name.includes(\"Moira\") ||\n        v.name.includes(\"Fiona\") ||\n        v.name.includes(\"Victoria\") ||\n        v.name.includes(\"Google UK English Female\")\n      ) || voices.find(v => v.lang.startsWith(\"en\"))\n      \n      if (femaleVoice) {\n        utterance.voice = femaleVoice\n      }\n    } else {\n      utterance.voice = options.voice\n    }\n\n    utterance.onend = () => resolve()\n    utterance.onerror = (event) => {\n      // Don't reject on cancel - it's expected behavior\n      if (event.error === 'canceled' || event.error === 'interrupted') {\n        resolve()\n      } else {\n        reject(new Error(event.error))\n      }\n    }\n\n    window.speechSynthesis.speak(utterance)\n  })\n}\n\n// Get available voices\nexport function getVoices(): SpeechSynthesisVoice[] {\n  if (typeof window === \"undefined\" || !window.speechSynthesis) return []\n  return window.speechSynthesis.getVoices()\n}\n\n// Stop speaking\nexport function stopSpeaking(): void {\n  if (typeof window === \"undefined\" || !window.speechSynthesis) return\n  window.speechSynthesis.cancel()\n}\n\n// Check if currently speaking\nexport function isSpeaking(): boolean {\n  if (typeof window === \"undefined\" || !window.speechSynthesis) return false\n  return window.speechSynthesis.speaking\n}\n","\"use client\"\n\nimport { getMaterials, type Material } from '@/lib/firestore'\nimport { useAuthContext } from '@/components/auth-provider'\n\nexport interface MaterialSearchResult {\n  id: string\n  name: string\n  type: string\n  content: string\n  tags: string[]\n  relevanceScore: number\n  excerpt: string\n}\n\nexport class MaterialSearchIntegration {\n  private materials: Material[] = []\n  private userId: string\n\n  constructor(userId: string) {\n    this.userId = userId\n  }\n\n  async initialize(): Promise<void> {\n    try {\n      this.materials = await getMaterials(this.userId)\n    } catch (error) {\n      console.error('Failed to load materials for search:', error)\n      this.materials = []\n    }\n  }\n\n  async search(query: string, options: {\n    limit?: number\n    types?: string[]\n    tags?: string[]\n  } = {}): Promise<MaterialSearchResult[]> {\n    const { limit = 10, types, tags } = options\n\n    if (!query.trim()) {\n      return []\n    }\n\n    // Ensure materials are loaded\n    if (this.materials.length === 0) {\n      await this.initialize()\n    }\n\n    const queryLower = query.toLowerCase()\n    const results: MaterialSearchResult[] = []\n\n    for (const material of this.materials) {\n      // Filter by type if specified\n      if (types && types.length > 0 && !types.includes(material.type)) {\n        continue\n      }\n\n      // Filter by subject/tags if specified\n      if (tags && tags.length > 0) {\n        const materialSubject = material.subject || ''\n        if (!tags.some(tag => materialSubject.toLowerCase().includes(tag.toLowerCase()))) {\n          continue\n        }\n      }\n\n      let relevanceScore = 0\n      let excerpt = ''\n\n      // Search in title (highest weight)\n      if (material.title.toLowerCase().includes(queryLower)) {\n        relevanceScore += 10\n        excerpt = this.extractExcerpt(material.title, queryLower)\n      }\n\n      // Search in content\n      if (material.content && material.content.toLowerCase().includes(queryLower)) {\n        relevanceScore += 5\n        if (!excerpt) {\n          excerpt = this.extractExcerpt(material.content, queryLower)\n        }\n      }\n\n      // Search in subject\n      if (material.subject && material.subject.toLowerCase().includes(queryLower)) {\n        relevanceScore += 3\n        if (!excerpt) {\n          excerpt = `Subject: ${material.subject}`\n        }\n      }\n      // Boost score for exact matches\n      if (material.title.toLowerCase() === queryLower) {\n        relevanceScore += 20\n      }\n\n      if (relevanceScore > 0) {\n        results.push({\n          id: material.id,\n          name: material.title,\n          type: material.type,\n          content: material.content || '',\n          tags: [material.subject],\n          relevanceScore,\n          excerpt: excerpt || material.title\n        })\n      }\n    }\n\n    // Sort by relevance score (descending)\n    results.sort((a, b) => b.relevanceScore - a.relevanceScore)\n\n    return results.slice(0, limit)\n  }\n\n  private extractExcerpt(text: string, query: string, contextLength: number = 50): string {\n    const index = text.toLowerCase().indexOf(query)\n    if (index === -1) return text.substring(0, contextLength) + '...'\n\n    const start = Math.max(0, index - contextLength / 2)\n    const end = Math.min(text.length, index + query.length + contextLength / 2)\n\n    let excerpt = text.substring(start, end)\n    if (start > 0) excerpt = '...' + excerpt\n    if (end < text.length) excerpt = excerpt + '...'\n\n    return excerpt\n  }\n\n  getAvailableTypes(): string[] {\n    const types = new Set(this.materials.map(m => m.type))\n    return Array.from(types)\n  }\n\n  getAvailableTags(): string[] {\n    const tags = new Set<string>()\n    this.materials.forEach(material => {\n      if (material.subject) {\n        tags.add(material.subject)\n      }\n    })\n    return Array.from(tags)\n  }\n\n  getMaterialCount(): number {\n    return this.materials.length\n  }\n}\n\n// Singleton instance for the current user\nlet materialSearchInstance: MaterialSearchIntegration | null = null\n\nexport function getMaterialSearchIntegration(userId: string): MaterialSearchIntegration {\n  if (!materialSearchInstance || materialSearchInstance['userId'] !== userId) {\n    materialSearchInstance = new MaterialSearchIntegration(userId)\n  }\n  return materialSearchInstance\n}\n\nexport function useMaterialSearch() {\n  const { user } = useAuthContext()\n\n  const searchMaterials = async (query: string, options?: {\n    limit?: number\n    types?: string[]\n    tags?: string[]\n  }): Promise<MaterialSearchResult[]> => {\n    if (!user) return []\n\n    const searchIntegration = getMaterialSearchIntegration(user.uid)\n    return await searchIntegration.search(query, options)\n  }\n\n  const initializeSearch = async (): Promise<void> => {\n    if (!user) return\n\n    const searchIntegration = getMaterialSearchIntegration(user.uid)\n    await searchIntegration.initialize()\n  }\n\n  return {\n    searchMaterials,\n    initializeSearch\n  }\n}","\"use client\"\n\nimport { ParsedCommand, CommandStep, CommandContext } from './commandParser'\nimport { getTasks, createTask, updateTask, getHabits, toggleHabitCompletion, getCourses, getCalendarEvents, createCalendarEvent, getMaterials, logStudySession, getDailyStats } from '@/lib/firestore'\nimport { analyzeLearningPatterns } from '@/lib/ai-client'\nimport { getMaterialSearchIntegration } from './materials-integration'\n\nexport interface ExecutionResult {\n  success: boolean\n  message: string\n  data?: any\n  nextStep?: string\n  requiresUserInput?: boolean\n  userInputPrompt?: string\n}\n\nexport interface ExecutionState {\n  commandId: string\n  currentStep: number\n  totalSteps: number\n  results: Record<string, any>\n  status: 'running' | 'waiting' | 'completed' | 'failed'\n  error?: string\n}\n\nexport class JarvisCommandExecutor {\n  private executionStates: Map<string, ExecutionState> = new Map()\n  private readonly API_BRIDGES = {\n    // Task Management\n    'task.create': this.createTask.bind(this),\n    'task.complete': this.completeTask.bind(this),\n    'task.list': this.listTasks.bind(this),\n\n    // Study Sessions\n    'study.start': this.startStudySession.bind(this),\n\n    // Habit Management\n    'habit.complete': this.completeHabit.bind(this),\n    'habit.list': this.listHabits.bind(this),\n\n    // Course Information\n    'course.info': this.getCourseInfo.bind(this),\n\n    // Material Search\n    'material.search': this.searchMaterials.bind(this),\n\n    // Calendar\n    'calendar.create': this.createCalendarEvent.bind(this),\n\n    // Analytics\n    'analytics.show': this.showAnalytics.bind(this),\n\n    // Multi-step Operations\n    'plan.create': this.createStudyPlan.bind(this),\n    'productivity.start': this.startProductivitySession.bind(this),\n\n    // Sub-actions for multi-step commands\n    'analyze_course_materials': this.analyzeCourseMaterials.bind(this),\n    'check_completion_status': this.checkCompletionStatus.bind(this),\n    'estimate_time_needed': this.estimateTimeNeeded.bind(this),\n    'create_study_plan': this.createStudyPlanAction.bind(this),\n    'schedule_tasks': this.scheduleTasks.bind(this),\n    'setup_focus_mode': this.setupFocusMode.bind(this),\n    'choose_next_task': this.chooseNextTask.bind(this),\n    'begin_pomodoro': this.beginPomodoro.bind(this),\n    'track_session': this.trackSession.bind(this)\n  }\n\n  async executeCommand(command: ParsedCommand, context: CommandContext): Promise<ExecutionResult> {\n    const commandId = `cmd_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`\n\n    if (command.multiStep && command.steps) {\n      return this.executeMultiStepCommand(commandId, command, context)\n    } else {\n      return this.executeSingleCommand(command, context)\n    }\n  }\n\n  private async executeSingleCommand(command: ParsedCommand, context: CommandContext): Promise<ExecutionResult> {\n    const bridge = this.API_BRIDGES[command.intent as keyof typeof this.API_BRIDGES]\n\n    if (!bridge) {\n      return {\n        success: false,\n        message: `I don't know how to handle \"${command.intent}\" commands yet.`\n      }\n    }\n\n    try {\n      return await bridge(command.entities, context)\n    } catch (error) {\n      console.error('Command execution error:', error)\n      return {\n        success: false,\n        message: `Sorry, I encountered an error while executing that command. Please try again.`\n      }\n    }\n  }\n\n  private async executeMultiStepCommand(commandId: string, command: ParsedCommand, context: CommandContext): Promise<ExecutionResult> {\n    if (!command.steps) {\n      return { success: false, message: 'No steps defined for multi-step command' }\n    }\n\n    const state: ExecutionState = {\n      commandId,\n      currentStep: 0,\n      totalSteps: command.steps.length,\n      results: {},\n      status: 'running'\n    }\n\n    this.executionStates.set(commandId, state)\n\n    try {\n      for (let i = 0; i < command.steps.length; i++) {\n        const step = command.steps[i]\n        state.currentStep = i\n\n        // Check dependencies\n        if (step.dependsOn) {\n          const missingDeps = step.dependsOn.filter(dep => !state.results[dep])\n          if (missingDeps.length > 0) {\n            state.status = 'failed'\n            state.error = `Missing dependencies: ${missingDeps.join(', ')}`\n            break\n          }\n        }\n\n        // Execute step\n        const stepResult = await this.executeStep(step, state.results, context)\n\n        if (!stepResult.success) {\n          state.status = 'failed'\n          state.error = stepResult.message\n          break\n        }\n\n        state.results[step.id] = stepResult.data\n\n        // Handle user input requirements\n        if (stepResult.requiresUserInput) {\n          state.status = 'waiting'\n          return {\n            success: true,\n            message: stepResult.userInputPrompt || 'Please provide additional information',\n            requiresUserInput: true,\n            nextStep: step.id\n          }\n        }\n      }\n\n      state.status = 'completed'\n      return {\n        success: true,\n        message: this.generateCompletionMessage(command, state.results),\n        data: state.results\n      }\n\n    } catch (error) {\n      state.status = 'failed'\n      state.error = error instanceof Error ? error.message : 'Unknown error'\n      return {\n        success: false,\n        message: 'Command execution failed. Please try again.'\n      }\n    }\n  }\n\n  private async executeStep(step: CommandStep, previousResults: Record<string, any>, context: CommandContext): Promise<ExecutionResult> {\n    // Replace template variables\n    const params = this.resolveTemplateVariables(step.params, previousResults)\n\n    const bridge = this.API_BRIDGES[step.action as keyof typeof this.API_BRIDGES]\n\n    if (!bridge) {\n      return {\n        success: false,\n        message: `Unknown action: ${step.action}`\n      }\n    }\n\n    return await bridge(params, context)\n  }\n\n  private resolveTemplateVariables(params: Record<string, any>, results: Record<string, any>): Record<string, any> {\n    const resolved = { ...params }\n\n    for (const [key, value] of Object.entries(resolved)) {\n      if (typeof value === 'string' && value.startsWith('{{') && value.endsWith('}}')) {\n        const templateKey = value.slice(2, -2)\n        const [resultKey, property] = templateKey.split('.')\n\n        if (results[resultKey]) {\n          resolved[key] = property ? results[resultKey][property] : results[resultKey]\n        }\n      }\n    }\n\n    return resolved\n  }\n\n  // API Bridge Implementations\n\n  private async createTask(entities: Record<string, any>, context: CommandContext): Promise<ExecutionResult> {\n    try {\n      const taskData = {\n        userId: context.userId,\n        title: entities.title,\n        description: entities.description || '',\n        priority: entities.priority || 'medium',\n        status: 'todo' as const,\n        dueDate: entities.dueDate,\n        course: entities.course,\n        estimatedMinutes: entities.duration || 30,\n        tags: entities.tags || [],\n        subtasks: [],\n        links: []\n      }\n\n      const taskId = await createTask(taskData)\n\n      return {\n        success: true,\n        message: `Created task \"${entities.title}\"${entities.dueDate ? ` due ${entities.dueDate.toLocaleDateString()}` : ''}`,\n        data: { taskId }\n      }\n    } catch (error) {\n      return {\n        success: false,\n        message: 'Failed to create task. Please try again.'\n      }\n    }\n  }\n\n  private async completeTask(entities: Record<string, any>, context: CommandContext): Promise<ExecutionResult> {\n    try {\n      const tasks = await getTasks(context.userId)\n      const task = tasks.find(t => t.title.toLowerCase().includes(entities.taskName.toLowerCase()))\n\n      if (!task) {\n        return {\n          success: false,\n          message: `I couldn't find a task named \"${entities.taskName}\". Could you be more specific?`\n        }\n      }\n\n      await updateTask(task.id, { status: 'done', completedAt: new Date() })\n\n      return {\n        success: true,\n        message: `Marked \"${task.title}\" as completed! Great job! ðŸŽ‰`,\n        data: { taskId: task.id }\n      }\n    } catch (error) {\n      return {\n        success: false,\n        message: 'Failed to complete task. Please try again.'\n      }\n    }\n  }\n\n  private async listTasks(entities: Record<string, any>, context: CommandContext): Promise<ExecutionResult> {\n    try {\n      const tasks = await getTasks(context.userId)\n      let filteredTasks = tasks\n\n      if (entities.filter) {\n        if (entities.filter.course) {\n          filteredTasks = filteredTasks.filter(t => t.course?.toLowerCase().includes(entities.filter.course.toLowerCase()))\n        }\n        if (entities.filter.dueDate) {\n          const filterDate = new Date(entities.filter.dueDate)\n          filteredTasks = filteredTasks.filter(t => t.dueDate && new Date(t.dueDate) <= filterDate)\n        }\n      }\n\n      const pendingTasks = filteredTasks.filter(t => t.status !== 'done')\n\n      if (pendingTasks.length === 0) {\n        return {\n          success: true,\n          message: 'You have no pending tasks! ðŸŽ‰',\n          data: { tasks: [] }\n        }\n      }\n\n      const taskList = pendingTasks.slice(0, 5).map(t => `- ${t.title}${t.dueDate ? ` (due ${new Date(t.dueDate).toLocaleDateString()})` : ''}`).join('\\n')\n\n      return {\n        success: true,\n        message: `Here are your ${entities.filter ? 'filtered ' : ''}tasks:\\n${taskList}${pendingTasks.length > 5 ? `\\n...and ${pendingTasks.length - 5} more` : ''}`,\n        data: { tasks: pendingTasks }\n      }\n    } catch (error) {\n      return {\n        success: false,\n        message: 'Failed to retrieve tasks. Please try again.'\n      }\n    }\n  }\n\n  private async startStudySession(entities: Record<string, any>, context: CommandContext): Promise<ExecutionResult> {\n    // This would integrate with the Pomodoro timer\n    return {\n      success: true,\n      message: `Starting a ${entities.duration || 25} minute study session${entities.task ? ` for \"${entities.task}\"` : ''}. Focus mode activated! ðŸš€`,\n      data: { duration: entities.duration || 25, task: entities.task }\n    }\n  }\n\n  private async completeHabit(entities: Record<string, any>, context: CommandContext): Promise<ExecutionResult> {\n    try {\n      const habits = await getHabits(context.userId)\n      const habit = habits.find(h => h.name.toLowerCase().includes(entities.habitName.toLowerCase()))\n\n      if (!habit) {\n        return {\n          success: false,\n          message: `I couldn't find a habit named \"${entities.habitName}\". Could you be more specific?`\n        }\n      }\n\n      await toggleHabitCompletion(habit.id, new Date().toISOString().split('T')[0])\n\n      return {\n        success: true,\n        message: `Completed \"${habit.name}\" for today! Keep up the great work! ðŸ’ª`,\n        data: { habitId: habit.id }\n      }\n    } catch (error) {\n      return {\n        success: false,\n        message: 'Failed to complete habit. Please try again.'\n      }\n    }\n  }\n\n  private async listHabits(entities: Record<string, any>, context: CommandContext): Promise<ExecutionResult> {\n    try {\n      const habits = await getHabits(context.userId)\n      const today = new Date().toISOString().split('T')[0]\n\n      const habitStatus = habits.map(h => {\n        const completedToday = h.completions.some(c => c.date === today && c.completed)\n        return `- ${h.name}: ${completedToday ? 'âœ… Done' : 'â³ Pending'} (${h.currentStreak} day streak)`\n      }).join('\\n')\n\n      return {\n        success: true,\n        message: `Here's your habit status:\\n${habitStatus}`,\n        data: { habits }\n      }\n    } catch (error) {\n      return {\n        success: false,\n        message: 'Failed to retrieve habits. Please try again.'\n      }\n    }\n  }\n\n  private async getCourseInfo(entities: Record<string, any>, context: CommandContext): Promise<ExecutionResult> {\n    try {\n      const courses = await getCourses(context.userId)\n      const course = courses.find(c => c.name.toLowerCase().includes(entities.courseName.toLowerCase()))\n\n      if (!course) {\n        return {\n          success: false,\n          message: `I couldn't find a course named \"${entities.courseName}\".`\n        }\n      }\n\n      const info = `Course: ${course.name}${course.code ? ` (${course.code})` : ''}${course.professor ? `\\nProfessor: ${course.professor}` : ''}${course.examDate ? `\\nNext Exam: ${new Date(course.examDate).toLocaleDateString()}` : ''}`\n\n      return {\n        success: true,\n        message: info,\n        data: { course }\n      }\n    } catch (error) {\n      return {\n        success: false,\n        message: 'Failed to retrieve course information.'\n      }\n    }\n  }\n\n  private async searchMaterials(entities: Record<string, any>, context: CommandContext): Promise<ExecutionResult> {\n    try {\n      const searchIntegration = getMaterialSearchIntegration(context.userId)\n      await searchIntegration.initialize()\n\n      const query = entities.topic || entities.query || ''\n      const results = await searchIntegration.search(query, {\n        limit: 5,\n        types: entities.type ? [entities.type] : undefined,\n        tags: entities.tags ? entities.tags.split(',').map((t: string) => t.trim()) : undefined\n      })\n\n      if (results.length === 0) {\n        return {\n          success: false,\n          message: `I couldn't find any materials related to \"${query}\". ${searchIntegration.getMaterialCount() > 0 ? 'Try a different search term or check your materials.' : 'You haven\\'t uploaded any materials yet.'}`\n        }\n      }\n\n      const materialList = results.map(r =>\n        `- ${r.name} (${r.type}) - ${r.excerpt}`\n      ).join('\\n')\n\n      return {\n        success: true,\n        message: `Found ${results.length} material${results.length > 1 ? 's' : ''} related to \"${query}\":\\n${materialList}`,\n        data: { materials: results }\n      }\n    } catch (error) {\n      console.error('Material search error:', error)\n      return {\n        success: false,\n        message: 'Failed to search materials. Please try again.'\n      }\n    }\n  }\n\n  private async createCalendarEvent(entities: Record<string, any>, context: CommandContext): Promise<ExecutionResult> {\n    try {\n      const eventData = {\n        userId: context.userId,\n        title: entities.title,\n        type: 'meeting' as const,\n        startTime: entities.dateTime || new Date(),\n        endTime: new Date((entities.dateTime || new Date()).getTime() + 60 * 60 * 1000), // 1 hour default\n        isAllDay: false,\n        isRecurring: false,\n        description: entities.description || '',\n        color: '#3b82f6'\n      }\n\n      const eventId = await createCalendarEvent(eventData)\n\n      return {\n        success: true,\n        message: `Scheduled \"${entities.title}\" for ${entities.dateTime?.toLocaleString() || 'now'}`,\n        data: { eventId }\n      }\n    } catch (error) {\n      return {\n        success: false,\n        message: 'Failed to schedule event.'\n      }\n    }\n  }\n\n  private async showAnalytics(entities: Record<string, any>, context: CommandContext): Promise<ExecutionResult> {\n    try {\n      const today = new Date().toISOString().split('T')[0]\n      const dailyStats = await getDailyStats(context.userId, today)\n\n      if (!dailyStats) {\n        return {\n          success: true,\n          message: \"You haven't logged any study time today yet. Let's get started! ðŸ“š\",\n          data: { stats: null }\n        }\n      }\n\n      const message = `Today's Progress:\\n` +\n        `ðŸ“– Study Time: ${Math.round(dailyStats.totalStudyMinutes / 60 * 10) / 10}h\\n` +\n        `âœ… Tasks Completed: ${dailyStats.taskCompleted}\\n` +\n        `ðŸŽ¯ Pomodoro Sessions: ${dailyStats.pomodoroCompleted}\\n` +\n        `ðŸ”¥ Current Streak: ${dailyStats.streakDay} days`\n\n      return {\n        success: true,\n        message,\n        data: { stats: dailyStats }\n      }\n    } catch (error) {\n      return {\n        success: false,\n        message: 'Failed to retrieve analytics.'\n      }\n    }\n  }\n\n  // Multi-step command implementations\n  private async createStudyPlan(entities: Record<string, any>, context: CommandContext): Promise<ExecutionResult> {\n    // This is a multi-step command that will be handled by the multi-step executor\n    return {\n      success: true,\n      message: 'Starting study plan creation...',\n      data: { examName: entities.examName, days: entities.days }\n    }\n  }\n\n  private async startProductivitySession(entities: Record<string, any>, context: CommandContext): Promise<ExecutionResult> {\n    // This is a multi-step command that will be handled by the multi-step executor\n    return {\n      success: true,\n      message: 'Initiating productivity session...',\n      data: { duration: entities.duration }\n    }\n  }\n\n  // Sub-action implementations for multi-step commands\n  private async analyzeCourseMaterials(entities: Record<string, any>, context: CommandContext): Promise<ExecutionResult> {\n    try {\n      const courses = await getCourses(context.userId)\n      const course = courses.find(c => c.name.toLowerCase().includes(entities.examName.toLowerCase()))\n\n      return {\n        success: true,\n        message: 'Analyzed course materials',\n        data: { course, materials: course?.syllabus || [] }\n      }\n    } catch (error) {\n      return { success: false, message: 'Failed to analyze course materials' }\n    }\n  }\n\n  private async checkCompletionStatus(entities: Record<string, any>, context: CommandContext): Promise<ExecutionResult> {\n    try {\n      const tasks = await getTasks(context.userId)\n      const courseTasks = tasks.filter(t => t.course?.toLowerCase().includes(entities.course.toLowerCase()))\n      const completedTasks = courseTasks.filter(t => t.status === 'done')\n\n      return {\n        success: true,\n        message: 'Checked completion status',\n        data: { completed: completedTasks.length, total: courseTasks.length, progress: completedTasks.length / courseTasks.length }\n      }\n    } catch (error) {\n      return { success: false, message: 'Failed to check completion status' }\n    }\n  }\n\n  private async estimateTimeNeeded(entities: Record<string, any>, context: CommandContext): Promise<ExecutionResult> {\n    const estimatedHours = Math.max(entities.days * 2, 10) // At least 10 hours, or 2 hours per day\n\n    return {\n      success: true,\n      message: 'Estimated study time needed',\n      data: { estimatedHours, dailyHours: estimatedHours / entities.days }\n    }\n  }\n\n  private async createStudyPlanAction(entities: Record<string, any>, context: CommandContext): Promise<ExecutionResult> {\n    try {\n      // Generate a simple study plan structure\n      const plan = {\n        id: `plan_${Date.now()}`,\n        examName: entities.course,\n        days: entities.days,\n        dailyTasks: Math.ceil(10 / entities.days), // 10 tasks total\n        focusAreas: ['Review notes', 'Practice problems', 'Take breaks', 'Light review']\n      }\n\n      return {\n        success: true,\n        message: 'Generated study plan',\n        data: { plan, planId: `plan_${Date.now()}` }\n      }\n    } catch (error) {\n      return { success: false, message: 'Failed to generate study plan' }\n    }\n  }\n\n  private async scheduleTasks(entities: Record<string, any>, context: CommandContext): Promise<ExecutionResult> {\n    // This would create actual tasks in the system\n    return {\n      success: true,\n      message: 'Scheduled study tasks',\n      data: { taskCount: 5 } // Placeholder\n    }\n  }\n\n  private async setupFocusMode(entities: Record<string, any>, context: CommandContext): Promise<ExecutionResult> {\n    return {\n      success: true,\n      message: 'Focus mode activated - notifications silenced, distractions minimized',\n      data: { focusMode: true }\n    }\n  }\n\n  private async chooseNextTask(entities: Record<string, any>, context: CommandContext): Promise<ExecutionResult> {\n    try {\n      const tasks = await getTasks(context.userId)\n      const pendingTasks = tasks.filter(t => t.status !== 'done').sort((a, b) => {\n        const priorityOrder = { urgent: 0, high: 1, medium: 2, low: 3 }\n        return priorityOrder[a.priority] - priorityOrder[b.priority]\n      })\n\n      if (pendingTasks.length === 0) {\n        return {\n          success: true,\n          message: 'No pending tasks found',\n          data: { task: null }\n        }\n      }\n\n      return {\n        success: true,\n        message: `Selected: \"${pendingTasks[0].title}\"`,\n        data: { task: pendingTasks[0] },\n        requiresUserInput: true,\n        userInputPrompt: `Would you like to work on \"${pendingTasks[0].title}\" or choose a different task?`\n      }\n    } catch (error) {\n      return { success: false, message: 'Failed to select task' }\n    }\n  }\n\n  private async beginPomodoro(entities: Record<string, any>, context: CommandContext): Promise<ExecutionResult> {\n    return {\n      success: true,\n      message: `Starting ${entities.duration} minute focus session on \"${entities.taskId?.title || 'selected task'}\"`,\n      data: { sessionId: `session_${Date.now()}`, duration: entities.duration }\n    }\n  }\n\n  private async trackSession(entities: Record<string, any>, context: CommandContext): Promise<ExecutionResult> {\n    return {\n      success: true,\n      message: 'Session tracking active - I\\'ll keep you motivated!',\n      data: { tracking: true }\n    }\n  }\n\n  private generateCompletionMessage(command: ParsedCommand, results: Record<string, any>): string {\n    switch (command.intent) {\n      case 'plan.create':\n        return `âœ… Study plan created! I've scheduled ${results.schedule_tasks?.taskCount || 5} study sessions over ${command.entities.days} days. Check your planner for details.`\n\n      case 'productivity.start':\n        return `ðŸš€ Productivity session started! ${command.entities.duration} minutes of focused work ahead. You've got this!`\n\n      default:\n        return 'âœ… Command completed successfully!'\n    }\n  }\n\n  // Utility methods\n  getExecutionState(commandId: string): ExecutionState | null {\n    return this.executionStates.get(commandId) || null\n  }\n\n  cancelExecution(commandId: string): void {\n    const state = this.executionStates.get(commandId)\n    if (state) {\n      state.status = 'failed'\n      state.error = 'Cancelled by user'\n    }\n  }\n}\n\n// Singleton instance\nlet commandExecutor: JarvisCommandExecutor | null = null\n\nexport function getCommandExecutor(): JarvisCommandExecutor {\n  if (!commandExecutor) {\n    commandExecutor = new JarvisCommandExecutor()\n  }\n  return commandExecutor\n}","\"use client\"\n\nimport { useState, useRef, useEffect, useCallback } from \"react\"\nimport { useRouter, usePathname } from \"next/navigation\"\nimport { useAuthContext } from \"./auth-provider\"\nimport { useVoiceInput, speak, stopSpeaking, isSpeechRecognitionSupported } from \"@/lib/voice\"\nimport { parseCommand, executeCommand, getSuggestedActions, AssistantContext, CommandResult } from \"@/lib/assistant\"\nimport { getCommandParser, ParsedCommand, CommandContext } from \"@/lib/jarvis/commandParser\"\nimport { getCommandExecutor } from \"@/lib/jarvis/commandExecutor\"\nimport { Message } from \"@/lib/ai-client\"\nimport { \n  addMemory, \n  getMaterials,\n  getFlashcardDecks,\n  createFlashcardDeck,\n  addFlashcard,\n  type FlashcardDeck,\n  type Task,\n  type Course,\n  type Habit,\n  type DailyStats\n} from \"@/lib/firestore\"\nimport { \n  askAI, \n  generateFlashcards, \n  createStudyPlan, \n  isBackendAvailable, \n  intelligentAsk,\n  type AskResponse,\n  type IntelligentAskResponse,\n  type AIMode,\n  type UserStudyContext,\n  type ProactiveSuggestion\n} from \"@/lib/api\"\nimport { BookOpen, Target, Lightbulb, Navigation, Wifi, WifiOff, Zap, AlertTriangle, CheckCircle } from \"lucide-react\"\nimport { toast } from \"sonner\"\n\ninterface ChatMessage {\n  id: string\n  role: \"user\" | \"assistant\"\n  content: string\n  timestamp: Date\n  action?: CommandResult[\"action\"]\n  mode?: AIMode // Track which AI mode generated this\n  isIntervention?: boolean // Whether this was an intervention\n}\n\ninterface JarvisAssistantProps {\n  context?: {\n    currentPage?: string\n    todayTasks?: Task[]\n    courses?: Course[]\n    habits?: Habit[]\n    dailyStats?: DailyStats\n    flashcardsDue?: number\n  }\n}\n\nexport function JarvisAssistant({ context }: JarvisAssistantProps = {}) {\n  const { user } = useAuthContext()\n  const router = useRouter()\n  const pathname = usePathname()\n  \n  const [isOpen, setIsOpen] = useState(false)\n  const [isFullscreen, setIsFullscreen] = useState(false)\n  const [messages, setMessages] = useState<ChatMessage[]>([])\n  const [inputValue, setInputValue] = useState(\"\")\n  const [isProcessing, setIsProcessing] = useState(false)\n  const [userContext, setUserContext] = useState<AssistantContext>({\n    currentPage: context?.currentPage || pathname,\n    conversationHistory: [],\n    userMaterials: [],\n    userDecks: []\n  })\n  const [isInitialized, setIsInitialized] = useState(false)\n  const [showWaveform, setShowWaveform] = useState(false)\n  const [userDecks, setUserDecks] = useState<FlashcardDeck[]>([])\n  const [isVoiceNotesMode, setIsVoiceNotesMode] = useState(false)\n  const [voiceNotes, setVoiceNotes] = useState<string>(\"\")\n  const [speakOnlyIntro, setSpeakOnlyIntro] = useState(false)\n  const [globalVoiceActive, setGlobalVoiceActive] = useState(false)\n  const [backendOnline, setBackendOnline] = useState(false)\n  const [proactiveSuggestions, setProactiveSuggestions] = useState<ProactiveSuggestion[]>([])\n  const [pendingIntervention, setPendingIntervention] = useState<{message: string; originalRequest: string} | null>(null)\n  \n  const messagesEndRef = useRef<HTMLDivElement>(null)\n  const inputRef = useRef<HTMLInputElement>(null)\n\n  // Check backend status on mount\n  useEffect(() => {\n    const checkBackend = async () => {\n      const online = await isBackendAvailable()\n      setBackendOnline(online)\n    }\n    checkBackend()\n    // Check every 30 seconds\n    const interval = setInterval(checkBackend, 30000)\n    return () => clearInterval(interval)\n  }, [])\n\n  // Voice input hook\n  const { state: voiceState, startListening, stopListening, resetTranscript } = useVoiceInput({\n    continuous: true, // Changed to continuous for notes\n    onResult: (transcript, isFinal) => {\n      if (isVoiceNotesMode) {\n        setVoiceNotes(prev => prev + (isFinal ? transcript : \"\"))\n        if (isFinal) {\n          addAssistantMessage(`Voice note added: \"${transcript}\"`)\n        }\n      } else {\n        if (isFinal && transcript.trim()) {\n          setInputValue(transcript.trim())\n          handleSubmit(transcript.trim())\n        }\n      }\n    },\n    onError: (error) => {\n      addAssistantMessage(`Voice recognition error: ${error}`)\n    }\n  })\n\n  // Load user context\n  useEffect(() => {\n    async function loadContext() {\n      if (!user) return\n      \n      try {\n        const [materials, decks] = await Promise.all([\n          getMaterials(user.uid),\n          getFlashcardDecks(user.uid)\n        ])\n        \n        setUserDecks(decks)\n        setUserContext({\n          userId: user.uid,\n          currentPage: pathname,\n          userMaterials: materials.map(m => ({ id: m.id, title: m.title, subject: m.subject })),\n          userDecks: decks.map(d => ({ id: d.id, name: d.name }))\n        })\n      } catch (error) {\n        console.error(\"Error loading context:\", error)\n      }\n    }\n    \n    loadContext()\n  }, [user, pathname])\n\n  useEffect(() => {\n    setUserContext(prev => ({ ...prev, currentPage: pathname }))\n  }, [pathname])\n\n  useEffect(() => {\n    messagesEndRef.current?.scrollIntoView({ behavior: \"smooth\" })\n  }, [messages])\n\n  // Global voice activation for \"gemini\"\n  useEffect(() => {\n    if (!isSpeechRecognitionSupported()) return\n\n    let globalRecognition: any = null\n\n    const startGlobalListening = () => {\n      if (globalRecognition) return\n\n      globalRecognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)()\n      globalRecognition.continuous = true\n      globalRecognition.interimResults = false\n      globalRecognition.lang = \"en-US\"\n\n      globalRecognition.onresult = (event: any) => {\n        const transcript = event.results[event.results.length - 1][0].transcript.toLowerCase().trim()\n        \n        if (transcript.includes(\"gemini\") || transcript.includes(\"jarvis\") || transcript.includes(\"hey jarvis\")) {\n          setIsOpen(true)\n          setGlobalVoiceActive(true)\n          globalRecognition.stop()\n          \n          // Start the main voice input\n          setTimeout(() => {\n            startListening()\n            setShowWaveform(true)\n          }, 500)\n        }\n      }\n\n      globalRecognition.onend = () => {\n        setGlobalVoiceActive(false)\n        // Restart global listening if not activated\n        setTimeout(startGlobalListening, 1000)\n      }\n\n      globalRecognition.start()\n    }\n\n    if (!isOpen) {\n      startGlobalListening()\n    }\n\n    return () => {\n      if (globalRecognition) {\n        globalRecognition.stop()\n      }\n    }\n  }, [isOpen, startListening])\n\n  // Stop speaking when component unmounts or closes\n  useEffect(() => {\n    return () => {\n      stopSpeaking()\n    }\n  }, [])\n\n  useEffect(() => {\n    if (!isOpen) {\n      stopSpeaking()\n    }\n  }, [isOpen])\n\n  // Generate disciplined contextual greeting (Study Intelligence System)\n  const getContextualGreeting = () => {\n    const studyContext = buildStudyContext()\n    const hour = new Date().getHours()\n    \n    // Concise status line\n    const statusParts: string[] = []\n    if ((studyContext.focus_minutes_today || 0) > 0) {\n      statusParts.push(`${studyContext.focus_minutes_today}m focused`)\n    }\n    if ((studyContext.streak_days || 0) > 0) {\n      statusParts.push(`${studyContext.streak_days} day streak`)\n    }\n    const statusLine = statusParts.length > 0 ? `ðŸ“Š ${statusParts.join(\" â€¢ \")}` : \"\"\n    \n    // Backend status (compact)\n    const backendNote = backendOnline \n      ? \"ðŸŸ¢ AI online\"\n      : \"ðŸŸ¡ Offline mode\"\n    \n    // Single most important action\n    let action = \"\"\n    const focusMinutes = studyContext.focus_minutes_today || 0\n    const overdue = studyContext.overdue_tasks || 0\n    const urgent = studyContext.urgent_task_count || 0\n    const flashcards = studyContext.flashcards_due || 0\n    const streak = studyContext.streak_days || 0\n    \n    if (overdue > 0) {\n      action = `âš ï¸ ${overdue} overdue task${overdue > 1 ? 's' : ''}. Let's catch up.`\n    } else if (urgent > 0 && focusMinutes === 0) {\n      action = `ðŸŽ¯ ${urgent} urgent task${urgent > 1 ? 's' : ''}. Start a focus session?`\n    } else if (studyContext.days_until_exam && studyContext.days_until_exam <= 7) {\n      action = `ðŸ“… ${studyContext.days_until_exam} day${studyContext.days_until_exam > 1 ? 's' : ''} until exam. Need a revision plan?`\n    } else if (flashcards > 10) {\n      action = `ðŸƒ ${flashcards} flashcards due. Review them now?`\n    } else if (hour >= 20 && focusMinutes === 0 && streak > 0) {\n      action = `ðŸ”¥ Your streak is at risk. 15 minutes will save it.`\n    } else if (focusMinutes === 0 && hour >= 8 && hour <= 22) {\n      action = \"Ready to start a focus session?\"\n    } else {\n      action = \"What should we work on?\"\n    }\n    \n    return `${backendNote}${statusLine ? ` â€¢ ${statusLine}` : \"\"}\\n\\n${action}`\n  }\n\n  useEffect(() => {\n    if (isOpen && !isInitialized) {\n      setIsInitialized(true)\n      // Jarvis greeting with contextual awareness\n      setTimeout(() => {\n        addAssistantMessage(getContextualGreeting())\n      }, 500)\n    }\n  }, [isOpen, isInitialized, context])\n\n  useEffect(() => {\n    if (isOpen) {\n      inputRef.current?.focus()\n    }\n  }, [isOpen])\n\n  // Update waveform state based on voice\n  useEffect(() => {\n    setShowWaveform(voiceState.isListening)\n  }, [voiceState.isListening])\n\n  const getTimeOfDay = () => {\n    const hour = new Date().getHours()\n    if (hour < 12) return \"morning\"\n    if (hour < 17) return \"afternoon\"\n    return \"evening\"\n  }\n\n  const addAssistantMessage = useCallback((content: string, action?: CommandResult[\"action\"]) => {\n    const message: ChatMessage = {\n      id: Date.now().toString(),\n      role: \"assistant\",\n      content,\n      timestamp: new Date(),\n      action\n    }\n    setMessages(prev => [...prev, message])\n    \n    // Determine what to speak\n    let speakText = content\n    if (speakOnlyIntro) {\n      // Extract introduction/summary (first sentence or first 100 characters)\n      const firstSentence = content.split(/[.!?]/)[0]\n      if (firstSentence && firstSentence.length > 10) {\n        speakText = firstSentence + (firstSentence.length < content.length ? \"...\" : \"\")\n      } else {\n        // Fallback to first 100 characters\n        speakText = content.length > 100 ? content.substring(0, 100) + \"...\" : content\n      }\n    }\n    \n    // Speak the response (softer, more natural voice)\n    try {\n      speak(speakText, { rate: 1.0, pitch: 1.0, volume: 0.7 }).catch(() => {})\n    } catch {}\n    \n    return message\n  }, [speakOnlyIntro])\n\n  // Build study context for intelligent AI\n  const buildStudyContext = useCallback((): UserStudyContext => {\n    const today = new Date().toISOString().split('T')[0]\n    \n    // Calculate habits completed today\n    let habitsCompletedToday = 0\n    let totalHabitsToday = context?.habits?.length || 0\n    context?.habits?.forEach(h => {\n      const todayCompletion = h.completions?.find((c: { date: string; completed: boolean }) => c.date === today)\n      if (todayCompletion?.completed) habitsCompletedToday++\n    })\n    \n    // Calculate task metrics\n    let urgentTaskCount = 0\n    let overdueTasks = 0\n    const now = new Date()\n    context?.todayTasks?.forEach(t => {\n      if (t.status === 'done') return\n      if (t.priority === 'urgent') urgentTaskCount++\n      if (t.dueDate) {\n        const dueDate = (t.dueDate as any).toDate ? (t.dueDate as any).toDate() : new Date(t.dueDate)\n        if (dueDate < now) overdueTasks++\n      }\n    })\n    \n    // Find nearest exam\n    let daysUntilExam: number | undefined\n    let currentCourse: string | undefined\n    context?.courses?.forEach(c => {\n      if (c.examDate) {\n        const examDate = new Date(c.examDate)\n        const days = Math.ceil((examDate.getTime() - now.getTime()) / (1000 * 60 * 60 * 24))\n        if (days > 0 && (daysUntilExam === undefined || days < daysUntilExam)) {\n          daysUntilExam = days\n          currentCourse = c.name\n        }\n      }\n    })\n    \n    return {\n      focus_minutes_today: context?.dailyStats?.totalStudyMinutes || 0,\n      target_focus_minutes: 120,\n      habits_completed_today: habitsCompletedToday,\n      total_habits_today: totalHabitsToday,\n      flashcards_due: context?.flashcardsDue || 0,\n      streak_days: context?.dailyStats?.streakDay || 0,\n      urgent_task_count: urgentTaskCount,\n      overdue_tasks: overdueTasks,\n      current_course: currentCourse,\n      days_until_exam: daysUntilExam,\n      recent_failures: []\n    }\n  }, [context])\n\n  const handleSubmit = async (text?: string, skipIntervention: boolean = false) => {\n    const messageText = (text || inputValue).trim()\n    if (!messageText || isProcessing) return\n\n    setInputValue(\"\")\n    setIsProcessing(true)\n    stopSpeaking()\n    setPendingIntervention(null)\n\n    // Add user message\n    const userMessage: ChatMessage = {\n      id: Date.now().toString(),\n      role: \"user\",\n      content: messageText,\n      timestamp: new Date()\n    }\n    setMessages(prev => [...prev, userMessage])\n\n    try {\n      // ==================== INTELLIGENT AI SYSTEM ====================\n      // Try to use the new intelligent AI endpoint if backend is online\n      if (backendOnline) {\n        try {\n          const studyContext = buildStudyContext()\n          \n          // Call intelligent AI endpoint\n          const result = await intelligentAsk({\n            message: messageText,\n            context: studyContext,\n            use_memory: true,\n            skip_intervention: skipIntervention\n          })\n          \n          // Handle intervention\n          if (result.intervention?.should_intervene && !skipIntervention) {\n            // Store the intervention and original request\n            setPendingIntervention({\n              message: result.intervention.message,\n              originalRequest: messageText\n            })\n            \n            // Add intervention message\n            const interventionMessage: ChatMessage = {\n              id: Date.now().toString(),\n              role: \"assistant\",\n              content: result.answer,\n              timestamp: new Date(),\n              mode: result.mode,\n              isIntervention: true\n            }\n            setMessages(prev => [...prev, interventionMessage])\n            \n            // Speak the intervention\n            try {\n              speak(result.answer, { rate: 1.0, pitch: 1.0, volume: 0.7 }).catch(() => {})\n            } catch {}\n            \n            // Update proactive suggestions\n            if (result.suggestions) {\n              setProactiveSuggestions(result.suggestions)\n            }\n            \n            setIsProcessing(false)\n            return\n          }\n          \n          // Format response based on mode\n          let formattedResponse = result.answer\n          \n          // Add memory quality indicator\n          if (result.memory_used) {\n            if (result.memory_quality === \"strong\") {\n              formattedResponse += `\\n\\nðŸ’¡ _Based on ${result.chunks_used} source${result.chunks_used > 1 ? 's' : ''} from your materials_`\n            } else if (result.memory_quality === \"weak\") {\n              formattedResponse += `\\n\\nâš ï¸ _Limited material found on this topic. Consider adding more notes._`\n            }\n          }\n          \n          // Add mode badge\n          const modeBadges: Record<AIMode, string> = {\n            plan: \"ðŸ“‹\",\n            explain: \"ðŸ’¡\",\n            quiz: \"ðŸ“\",\n            flashcards: \"ðŸƒ\",\n            review: \"ðŸ“–\",\n            coach: \"ðŸŽ¯\"\n          }\n          \n          const assistantMessage: ChatMessage = {\n            id: Date.now().toString(),\n            role: \"assistant\",\n            content: formattedResponse,\n            timestamp: new Date(),\n            mode: result.mode\n          }\n          setMessages(prev => [...prev, assistantMessage])\n          \n          // Speak the response\n          const firstSentence = result.answer.split(/[.!?]/)[0]\n          const speakText = speakOnlyIntro && firstSentence.length > 10 \n            ? firstSentence + \"...\" \n            : result.answer.length > 150 \n              ? result.answer.substring(0, 150) + \"...\" \n              : result.answer\n          try {\n            speak(speakText, { rate: 1.0, pitch: 1.0, volume: 0.7 }).catch(() => {})\n          } catch {}\n          \n          // Handle structured output for flashcards mode\n          if (result.mode === \"flashcards\" && result.structured_output && Array.isArray(result.structured_output)) {\n            toast.success(`Created ${result.structured_output.length} flashcards!`)\n          }\n          \n          // Update proactive suggestions\n          if (result.suggestions) {\n            setProactiveSuggestions(result.suggestions)\n          }\n          \n          setIsProcessing(false)\n          return\n          \n        } catch (error: any) {\n          console.warn(\"Intelligent AI failed, falling back to legacy:\", error)\n          // Fall through to legacy processing\n        }\n      }\n\n      // ==================== LEGACY FALLBACK ====================\n      const lowerMessage = messageText.toLowerCase()\n      \n      const isFlashcardRequest = lowerMessage.includes(\"flashcard\") || \n                                  lowerMessage.includes(\"flash card\")\n\n      const isStudyPlanRequest = lowerMessage.includes(\"study plan\") || \n                                  lowerMessage.includes(\"learning plan\") ||\n                                  lowerMessage.includes(\"create a plan\")\n\n      // Try legacy backend endpoints\n      if (backendOnline) {\n        try {\n          if (isFlashcardRequest) {\n            const topic = messageText.replace(/flashcard|flash card|create|generate|make|for|about|on/gi, \"\").trim() || \"general knowledge\"\n            \n            toast.loading(\"Generating flashcards...\", { id: \"flashcards\" })\n            const result = await generateFlashcards({\n              topic,\n              num_cards: 5,\n              use_memory: true\n            })\n            toast.success(`Created ${result.count} flashcards!`, { id: \"flashcards\" })\n            \n            addAssistantMessage(`ðŸƒ Created ${result.count} flashcards on \"${topic}\".\\n\\nPreview:\\n${result.flashcards.slice(0, 2).map(f => `Q: ${f.question}\\nA: ${f.answer}`).join(\"\\n\\n\")}${result.count > 2 ? `\\n\\n...and ${result.count - 2} more.` : \"\"}`, {\n              type: \"navigate\",\n              data: { path: \"/flashcards\" }\n            })\n            return\n          } else if (isStudyPlanRequest) {\n            const subject = messageText.replace(/study plan|learning plan|create|a|plan|for|about|on/gi, \"\").trim() || \"general studies\"\n            \n            toast.loading(\"Creating study plan...\", { id: \"studyplan\" })\n            const result = await createStudyPlan({\n              subject,\n              days: 7,\n              retrieve_materials: true\n            })\n            toast.success(\"Plan created!\", { id: \"studyplan\" })\n            \n            addAssistantMessage(`ðŸ“‹ ${result.days}-day plan for ${result.subject}:\\n\\n${result.plan}${result.materials_used > 0 ? `\\n\\n_Used ${result.materials_used} of your materials._` : \"\"}`)\n            return\n          } else {\n            // General AI question\n            const result = await askAI({\n              question: messageText,\n              use_memory: true,\n              top_k: 5\n            })\n            \n            let response = result.answer\n            if (result.context_used && result.sources_count > 0) {\n              response += `\\n\\nðŸ’¡ _Based on ${result.sources_count} source${result.sources_count > 1 ? 's' : ''} from your materials_`\n            }\n            \n            addAssistantMessage(response)\n            return\n          }\n        } catch (error: any) {\n          console.error(\"Backend AI error:\", error)\n          toast.dismiss(\"ai-thinking\")\n          toast.dismiss(\"flashcards\")\n          toast.dismiss(\"studyplan\")\n        }\n      }\n\n      // ==================== LOCAL COMMAND PROCESSING ====================\n      const commandParser = getCommandParser()\n      const commandExecutor = getCommandExecutor()\n\n      const commandContext: CommandContext = {\n        userId: user?.uid || '',\n        currentPage: pathname,\n        recentActions: [],\n        userPreferences: {},\n        availableData: {\n          tasks: context?.todayTasks,\n          courses: context?.courses,\n          habits: context?.habits\n        }\n      }\n\n      const parsedCommand = commandParser.parseCommand(messageText, commandContext)\n      const result = await commandExecutor.executeCommand(parsedCommand, commandContext)\n\n      addAssistantMessage(result.message)\n\n      if (result.data?.path) {\n        setTimeout(() => router.push(result.data.path), 1000)\n      }\n\n    } catch (error: any) {\n      addAssistantMessage(`Error: ${error.message}. Try again.`)\n    } finally {\n      setIsProcessing(false)\n    }\n  }\n\n  // Handle continuing after intervention\n  const handleContinueAnyway = () => {\n    if (pendingIntervention) {\n      handleSubmit(pendingIntervention.originalRequest, true)\n      setPendingIntervention(null)\n    }\n  }\n\n  const handleVoiceToggle = () => {\n    if (voiceState.isListening) {\n      stopListening()\n    } else {\n      resetTranscript()\n      startListening()\n    }\n  }\n\n  const clearChat = () => {\n    setMessages([])\n    setPendingIntervention(null)\n    addAssistantMessage(\"Ready. What should we work on?\")\n  }\n\n  const suggestions = getSuggestedActions(userContext)\n\n  if (!user) return null\n\n  return (\n    <>\n      {/* Compact floating trigger */}\n      <button\n        onClick={() => setIsOpen(!isOpen)}\n        className={`fixed bottom-6 right-6 z-50 group transition-all duration-300 ${\n          isOpen ? \"scale-0 opacity-0\" : \"scale-100 opacity-100\"\n        }`}\n        aria-label=\"Open AI Coach\"\n      >\n        <div className=\"relative flex items-center gap-2 px-4 py-2.5 rounded-full bg-slate-800 border border-slate-700 shadow-lg hover:bg-slate-700 transition-all\">\n          {/* Status dot */}\n          <div className={`w-2 h-2 rounded-full ${backendOnline ? 'bg-green-500' : 'bg-amber-500'}`} />\n          <span className=\"text-sm font-medium text-white\">Ask AI</span>\n        </div>\n      </button>\n\n      {/* Main JARVIS Panel */}\n      <div\n        className={`fixed z-50 transition-all duration-500 ease-out ${\n          isFullscreen \n            ? \"inset-4\" \n            : \"bottom-6 right-6 w-[420px] max-w-[calc(100vw-3rem)]\"\n        } ${\n          isOpen \n            ? \"opacity-100 scale-100 translate-y-0\" \n            : \"opacity-0 scale-95 translate-y-4 pointer-events-none\"\n        }`}\n      >\n        <div className={`relative h-full ${isFullscreen ? \"\" : \"max-h-[600px]\"} bg-white/95 backdrop-blur-xl rounded-2xl border border-gray-200/50 shadow-2xl overflow-hidden flex flex-col`}>\n          \n          {/* Animated border glow */}\n          <div className=\"absolute inset-0 rounded-2xl overflow-hidden pointer-events-none\">\n            <div className=\"absolute inset-0 bg-gradient-to-r from-cyan-500/0 via-cyan-500/20 to-cyan-500/0 animate-shimmer\" />\n          </div>\n\n          {/* Enhanced Header */}\n          <div className=\"relative px-5 py-4 border-b border-gray-200/50 bg-gradient-to-r from-blue-50/80 via-indigo-50/60 to-blue-50/80\">\n            <div className=\"flex items-center justify-between\">\n              <div className=\"flex items-center gap-3\">\n                {/* JARVIS Logo */}\n                <div className=\"relative\">\n                  <div className=\"w-10 h-10 rounded-full bg-gradient-to-br from-blue-500 to-indigo-600 flex items-center justify-center\">\n                    <div className={`w-6 h-6 rounded-full bg-blue-300/80 ${isProcessing ? \"animate-pulse\" : \"\"}`}>\n                      <div className=\"w-full h-full rounded-full bg-gradient-to-br from-white/60 to-transparent\" />\n                    </div>\n                  </div>\n                  {isProcessing && (\n                    <div className=\"absolute inset-0 rounded-full border-2 border-blue-400 animate-ping\" />\n                  )}\n                </div>\n\n                <div>\n                  <h3 className=\"font-semibold text-blue-600 text-sm\">AI Coach</h3>\n                  <p className=\"text-[10px] text-slate-500\">\n                    {backendOnline ? \"Online\" : \"Offline\"}\n                  </p>\n                </div>\n              </div>\n\n              <div className=\"flex items-center gap-2\">\n                {/* Backend status indicator */}\n                <div className={`flex items-center gap-1.5 px-2 py-1 rounded-full ${backendOnline ? \"bg-green-50 border border-green-200/50\" : \"bg-amber-50 border border-amber-200/50\"}`}>\n                  {backendOnline ? (\n                    <Wifi className=\"w-3 h-3 text-green-500\" />\n                  ) : (\n                    <WifiOff className=\"w-3 h-3 text-amber-500\" />\n                  )}\n                  <span className={`text-[10px] font-mono ${backendOnline ? \"text-green-600\" : \"text-amber-600\"}`}>\n                    {backendOnline ? \"AI ONLINE\" : \"LOCAL MODE\"}\n                  </span>\n                </div>\n\n                {/* Fullscreen toggle */}\n                <button\n                  onClick={() => setIsFullscreen(!isFullscreen)}\n                  className=\"p-2 hover:bg-blue-100 rounded-lg transition-colors text-blue-600\"\n                  title={isFullscreen ? \"Exit fullscreen\" : \"Enter fullscreen\"}\n                >\n                  {isFullscreen ? (\n                    <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\n                    </svg>\n                  ) : (\n                    <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4\" />\n                    </svg>\n                  )}\n                </button>\n\n                {/* Close button */}\n                <button\n                  onClick={() => setIsOpen(false)}\n                  className=\"p-2 hover:bg-red-100 rounded-lg transition-colors text-red-600\"\n                  title=\"Close JARVIS\"\n                >\n                  <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\n                  </svg>\n                </button>\n              </div>\n            </div>\n\n            {/* Voice instruction */}\n            <div className=\"mt-2 text-xs text-slate-500 px-3 py-1.5 bg-slate-50/50 rounded-lg\">\n              Ask me anything â€¢ Create flashcards â€¢ Get study help\n            </div>\n          </div>\n\n          {/* Context indicator - more compact */}\n          <div className=\"px-4 py-2 border-b border-gray-200/50 bg-slate-50/30\">\n            <div className=\"flex items-center gap-2 text-xs\">\n              <span className=\"text-slate-500\">Context:</span>\n              <span className=\"px-2 py-0.5 bg-blue-100 text-blue-600 rounded text-[10px]\">\n                {userContext.currentPage || 'dashboard'}\n              </span>\n              {context?.todayTasks && context.todayTasks.length > 0 && (\n                <span className=\"px-2 py-0.5 bg-green-100 text-green-600 rounded text-[10px]\">\n                  {context.todayTasks.length} tasks\n                </span>\n              )}\n            </div>\n          </div>\n\n          {/* Messages area */}\n          <div className={`flex-1 overflow-y-auto p-4 space-y-4 ${isFullscreen ? \"max-h-none\" : \"max-h-80\"}`}>\n            {/* Decorative elements */}\n            <div className=\"absolute top-20 left-4 w-px h-8 bg-gradient-to-b from-blue-400/30 to-transparent\" />\n            <div className=\"absolute top-20 right-4 w-px h-8 bg-gradient-to-b from-blue-400/30 to-transparent\" />\n\n            {messages.length === 0 && (\n              <div className=\"space-y-4\">\n                {/* Proactive Suggestions - Study Intelligence System */}\n                <div className=\"space-y-3\">\n                  <h4 className=\"text-xs font-medium text-slate-500 uppercase tracking-wide\">What's Next</h4>\n                  \n                  {/* Dynamic suggestions from AI or computed locally */}\n                  <div className=\"space-y-2\">\n                    {proactiveSuggestions.length > 0 ? (\n                      // Use suggestions from intelligent AI system\n                      proactiveSuggestions.map((suggestion) => (\n                        <button\n                          key={suggestion.id}\n                          onClick={() => handleSubmit(suggestion.action)}\n                          className={`w-full p-3 text-left rounded-lg border transition-all group ${\n                            suggestion.priority === 'urgent' \n                              ? 'bg-red-50 hover:bg-red-100 border-red-200/50' \n                              : suggestion.priority === 'high'\n                                ? 'bg-amber-50 hover:bg-amber-100 border-amber-200/50'\n                                : 'bg-blue-50 hover:bg-blue-100 border-blue-200/50'\n                          }`}\n                        >\n                          <p className={`text-sm font-medium ${\n                            suggestion.priority === 'urgent' \n                              ? 'text-red-700' \n                              : suggestion.priority === 'high'\n                                ? 'text-amber-700'\n                                : 'text-slate-700'\n                          }`}>\n                            {suggestion.icon} {suggestion.message}\n                          </p>\n                        </button>\n                      ))\n                    ) : (\n                      // Fallback local suggestions\n                      <>\n                        {context?.todayTasks && context.todayTasks.some(t => t.priority === 'urgent' || t.priority === 'high') ? (\n                          <button\n                            onClick={() => handleSubmit(\"Help me prioritize my tasks and start a focus session\")}\n                            className=\"w-full p-3 bg-amber-50 hover:bg-amber-100 text-left rounded-lg border border-amber-200/50 transition-all\"\n                          >\n                            <p className=\"text-sm font-medium text-amber-700\">\n                              ðŸŽ¯ Start focus session on priority tasks\n                            </p>\n                          </button>\n                        ) : (\n                          <button\n                            onClick={() => handleSubmit(\"Help me plan my next study session\")}\n                            className=\"w-full p-3 bg-blue-50 hover:bg-blue-100 text-left rounded-lg border border-blue-200/50 transition-all\"\n                          >\n                            <p className=\"text-sm text-slate-700\">\n                              ðŸ“‹ Plan next study session\n                            </p>\n                          </button>\n                        )}\n                        \n                        <button\n                          onClick={() => handleSubmit(\"Generate flashcards from my recent notes\")}\n                          className=\"w-full p-3 bg-purple-50 hover:bg-purple-100 text-left rounded-lg border border-purple-200/50 transition-all\"\n                        >\n                          <p className=\"text-sm text-slate-700\">\n                            ðŸƒ Generate flashcards\n                          </p>\n                        </button>\n                      </>\n                    )}\n                  </div>\n                </div>\n                \n                {/* Backend offline notice */}\n                {!backendOnline && (\n                  <div className=\"p-3 bg-amber-50 rounded-lg border border-amber-200/50 text-xs text-amber-700\">\n                    <p className=\"font-medium\">AI features limited</p>\n                    <p className=\"text-amber-600 mt-0.5\">Start the backend to enable AI-powered planning & flashcard generation.</p>\n                  </div>\n                )}\n              </div>\n            )}\n\n            {messages.map((msg) => (\n              <div\n                key={msg.id}\n                className={`flex ${msg.role === \"user\" ? \"justify-end\" : \"justify-start\"}`}\n              >\n                <div\n                  className={`max-w-[85%] ${\n                    msg.role === \"user\"\n                      ? \"bg-gradient-to-r from-blue-500 to-indigo-600 text-white rounded-2xl rounded-br-md shadow-sm\"\n                      : msg.isIntervention\n                        ? \"bg-amber-50 border border-amber-200 text-gray-800 rounded-2xl rounded-bl-md shadow-sm\"\n                        : \"bg-white/90 border border-gray-200/50 text-gray-800 rounded-2xl rounded-bl-md shadow-sm\"\n                  } px-4 py-3 relative overflow-hidden`}\n                >\n                  {msg.role === \"assistant\" && (\n                    <div className={`absolute top-0 left-0 w-full h-px bg-gradient-to-r from-transparent ${msg.isIntervention ? 'via-amber-400/50' : 'via-blue-400/30'} to-transparent`} />\n                  )}\n                  \n                  {msg.role === \"assistant\" && (\n                    <div className=\"flex items-center gap-2 mb-1\">\n                      {msg.isIntervention && <AlertTriangle className=\"w-3 h-3 text-amber-500\" />}\n                      <span className={`text-[10px] font-mono ${msg.isIntervention ? 'text-amber-600' : 'text-blue-600'}`}>\n                        {msg.isIntervention ? 'INTERVENTION' : msg.mode?.toUpperCase() || 'AI'}\n                      </span>\n                      <span className=\"text-[10px] text-gray-500\">\n                        {msg.timestamp.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}\n                      </span>\n                    </div>\n                  )}\n                  \n                  <p className=\"text-sm whitespace-pre-wrap leading-relaxed\">{msg.content}</p>\n                  \n                  {msg.action?.type === \"show_flashcards\" && msg.action.data?.flashcards && (\n                    <div className=\"mt-3 pt-3 border-t border-gray-200/50\">\n                      <p className=\"text-xs text-gray-600 font-mono\">\n                        {msg.action.data.flashcards.length} FLASHCARDS GENERATED\n                      </p>\n                    </div>\n                  )}\n                </div>\n              </div>\n            ))}\n\n            {/* Intervention continue button */}\n            {pendingIntervention && !isProcessing && (\n              <div className=\"flex justify-center\">\n                <button\n                  onClick={handleContinueAnyway}\n                  className=\"px-4 py-2 text-xs text-slate-600 bg-slate-100 hover:bg-slate-200 rounded-full transition-colors\"\n                >\n                  Continue with original request anyway â†’\n                </button>\n              </div>\n            )}\n\n            {isProcessing && (\n              <div className=\"flex justify-start\">\n                <div className=\"bg-white/90 border border-gray-200/50 rounded-2xl rounded-bl-md px-4 py-3 shadow-sm\">\n                  <div className=\"flex items-center gap-2\">\n                    <span className=\"text-[10px] font-mono text-blue-600\">PROCESSING</span>\n                  </div>\n                  <div className=\"flex items-center gap-1 mt-2\">\n                    <div className=\"w-2 h-2 bg-blue-400 rounded-full animate-bounce\" style={{ animationDelay: \"0ms\" }} />\n                    <div className=\"w-2 h-2 bg-blue-400 rounded-full animate-bounce\" style={{ animationDelay: \"150ms\" }} />\n                    <div className=\"w-2 h-2 bg-blue-400 rounded-full animate-bounce\" style={{ animationDelay: \"300ms\" }} />\n                  </div>\n                </div>\n              </div>\n            )}\n\n            <div ref={messagesEndRef} />\n          </div>\n\n          {/* Voice Notes Section */}\n          {isVoiceNotesMode && (\n            <div className=\"p-4 border-t border-gray-200/50 bg-gray-50/50\">\n              <div className=\"flex items-center justify-between mb-3\">\n                <h3 className=\"text-sm font-mono text-blue-600\">VOICE NOTES</h3>\n                <div className=\"flex gap-2\">\n                  <button\n                    onClick={() => setVoiceNotes(\"\")}\n                    className=\"text-xs px-2 py-1 bg-red-100 text-red-600 rounded hover:bg-red-200\"\n                  >\n                    CLEAR\n                  </button>\n                  <button\n                    onClick={() => setIsVoiceNotesMode(false)}\n                    className=\"text-xs px-2 py-1 bg-gray-200 text-gray-700 rounded hover:bg-gray-300\"\n                  >\n                    EXIT\n                  </button>\n                </div>\n              </div>\n              <div className=\"bg-white/80 border border-gray-200/50 rounded-lg p-3 min-h-[100px] text-sm text-gray-800 whitespace-pre-wrap\">\n                {voiceNotes || \"Start speaking to add voice notes...\"}\n              </div>\n            </div>\n          )}\n\n          {/* Input area */}\n          <div className=\"relative p-4 border-t border-gray-200/50 bg-gray-50/80\">\n            {/* Suggested Commands */}\n            <div className=\"mb-4\">\n              <div className=\"flex items-center gap-2 mb-2\">\n                <Lightbulb className=\"w-4 h-4 text-yellow-500\" />\n                <span className=\"text-xs font-medium text-gray-600 uppercase tracking-wide\">Suggested Commands</span>\n              </div>\n              <div className=\"flex flex-wrap gap-2\">\n                {(() => {\n                  const commandParser = getCommandParser()\n                  const commandContext: CommandContext = {\n                    userId: user?.uid || '',\n                    currentPage: pathname,\n                    availableData: {\n                      tasks: context?.todayTasks,\n                      courses: context?.courses,\n                      habits: context?.habits\n                    }\n                  }\n                  const suggestions = commandParser.getSuggestedCommands(commandContext)\n\n                  return suggestions.map((suggestion, index) => (\n                    <button\n                      key={index}\n                      onClick={() => handleSubmit(suggestion)}\n                      disabled={isProcessing}\n                      className=\"px-3 py-1.5 bg-gray-100 hover:bg-gray-200 text-gray-700 text-xs rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed\"\n                    >\n                      {suggestion}\n                    </button>\n                  ))\n                })()}\n              </div>\n            </div>\n\n            {/* Voice listening indicator */}\n            {voiceState.isListening && (\n              <div className=\"absolute -top-12 left-1/2 -translate-x-1/2 px-4 py-2 bg-white border border-gray-300 rounded-full flex items-center gap-2 shadow-sm\">\n                <div className=\"w-3 h-3 bg-red-500 rounded-full animate-pulse\" />\n                <span className=\"text-xs text-gray-700 font-mono\">\n                  {voiceState.interimTranscript || \"LISTENING...\"}\n                </span>\n              </div>\n            )}\n\n            <form\n              onSubmit={(e) => {\n                e.preventDefault()\n                handleSubmit()\n              }}\n              className=\"flex items-center gap-3\"\n            >\n              {/* Voice toggle button */}\n              {isSpeechRecognitionSupported() && (\n                <button\n                  type=\"button\"\n                  onClick={() => {\n                    if (isVoiceNotesMode) {\n                      setIsVoiceNotesMode(false)\n                    } else if (voiceState.isListening) {\n                      stopListening()\n                    } else {\n                      setIsVoiceNotesMode(true)\n                      startListening()\n                      setShowWaveform(true)\n                    }\n                  }}\n                  className={`relative p-3 rounded-xl transition-all ${\n                    isVoiceNotesMode || voiceState.isListening\n                      ? \"bg-red-100 text-red-600 border border-red-300\"\n                      : \"bg-blue-50 text-blue-600 border border-blue-200 hover:bg-blue-100 hover:border-blue-300\"\n                  }`}\n                  title={isVoiceNotesMode ? \"Exit Voice Notes Mode\" : voiceState.isListening ? \"Stop Listening\" : \"Start Voice Input\"}\n                >\n                  {isVoiceNotesMode || voiceState.isListening ? (\n                    <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M21 12a9 9 0 11-18 0 9 9 0 0118 0z M9 10a1 1 0 000 2h6a1 1 0 000-2H9z\" />\n                    </svg>\n                  ) : (\n                    <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z\" />\n                    </svg>\n                  )}\n                </button>\n              )}\n\n              {/* Text input */}\n              <div className=\"flex-1 relative\">\n                <input\n                  ref={inputRef}\n                  type=\"text\"\n                  value={inputValue}\n                  onChange={(e) => setInputValue(e.target.value)}\n                  placeholder=\"Speak or type a command...\"\n                  className=\"w-full px-4 py-3 bg-white border border-gray-300 rounded-xl text-sm text-gray-800 placeholder-gray-500 focus:outline-none focus:border-blue-400 focus:ring-1 focus:ring-blue-400/30 font-mono shadow-sm\"\n                  disabled={isProcessing}\n                />\n                <div className=\"absolute inset-0 rounded-xl pointer-events-none overflow-hidden\">\n                  <div className=\"absolute inset-0 bg-gradient-to-r from-blue-500/0 via-blue-500/5 to-blue-500/0 animate-shimmer\" />\n                </div>\n              </div>\n\n              {/* Send button */}\n              <button\n                type=\"submit\"\n                disabled={!inputValue.trim() || isProcessing}\n                className=\"p-3 bg-gradient-to-r from-blue-500 to-indigo-600 text-white rounded-xl disabled:opacity-50 disabled:cursor-not-allowed hover:from-blue-600 hover:to-indigo-700 transition-all shadow-sm\"\n              >\n                <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M13 7l5 5m0 0l-5 5m5-5H6\" />\n                </svg>\n              </button>\n            </form>\n\n            {/* Footer info */}\n            <div className=\"flex items-center justify-between mt-3 text-[10px] text-gray-500 font-mono\">\n              <span>POWERED BY AI â€¢ {new Date().toLocaleDateString()}</span>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* Global styles for animations */}\n      <style jsx global>{`\n        @keyframes shimmer {\n          0% { transform: translateX(-100%); }\n          100% { transform: translateX(100%); }\n        }\n        .animate-shimmer {\n          animation: shimmer 3s infinite;\n        }\n      `}</style>\n    </>\n  )\n}\n","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name WifiOff\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMTIgMjBoLjAxIiAvPgogIDxwYXRoIGQ9Ik04LjUgMTYuNDI5YTUgNSAwIDAgMSA3IDAiIC8+CiAgPHBhdGggZD0iTTUgMTIuODU5YTEwIDEwIDAgMCAxIDUuMTctMi42OSIgLz4KICA8cGF0aCBkPSJNMTkgMTIuODU5YTEwIDEwIDAgMCAwLTIuMDA3LTEuNTIzIiAvPgogIDxwYXRoIGQ9Ik0yIDguODJhMTUgMTUgMCAwIDEgNC4xNzctMi42NDMiIC8+CiAgPHBhdGggZD0iTTIyIDguODJhMTUgMTUgMCAwIDAtMTEuMjg4LTMuNzY0IiAvPgogIDxwYXRoIGQ9Im0yIDIgMjAgMjAiIC8+Cjwvc3ZnPgo=) - https://lucide.dev/icons/wifi-off\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst WifiOff = createLucideIcon('WifiOff', [\n  ['path', { d: 'M12 20h.01', key: 'zekei9' }],\n  ['path', { d: 'M8.5 16.429a5 5 0 0 1 7 0', key: '1bycff' }],\n  ['path', { d: 'M5 12.859a10 10 0 0 1 5.17-2.69', key: '1dl1wf' }],\n  ['path', { d: 'M19 12.859a10 10 0 0 0-2.007-1.523', key: '4k23kn' }],\n  ['path', { d: 'M2 8.82a15 15 0 0 1 4.177-2.643', key: '1grhjp' }],\n  ['path', { d: 'M22 8.82a15 15 0 0 0-11.288-3.764', key: 'z3jwby' }],\n  ['path', { d: 'm2 2 20 20', key: '1ooewy' }],\n]);\n\nexport default WifiOff;\n","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name Wifi\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMTIgMjBoLjAxIiAvPgogIDxwYXRoIGQ9Ik0yIDguODJhMTUgMTUgMCAwIDEgMjAgMCIgLz4KICA8cGF0aCBkPSJNNSAxMi44NTlhMTAgMTAgMCAwIDEgMTQgMCIgLz4KICA8cGF0aCBkPSJNOC41IDE2LjQyOWE1IDUgMCAwIDEgNyAwIiAvPgo8L3N2Zz4K) - https://lucide.dev/icons/wifi\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Wifi = createLucideIcon('Wifi', [\n  ['path', { d: 'M12 20h.01', key: 'zekei9' }],\n  ['path', { d: 'M2 8.82a15 15 0 0 1 20 0', key: 'dnpr2z' }],\n  ['path', { d: 'M5 12.859a10 10 0 0 1 14 0', key: '1x1e6c' }],\n  ['path', { d: 'M8.5 16.429a5 5 0 0 1 7 0', key: '1bycff' }],\n]);\n\nexport default Wifi;\n","\"use client\"\n\nexport interface ParsedCommand {\n  intent: string\n  entities: Record<string, any>\n  confidence: number\n  originalCommand: string\n  requiresConfirmation?: boolean\n  multiStep?: boolean\n  steps?: CommandStep[]\n}\n\nexport interface CommandStep {\n  id: string\n  action: string\n  params: Record<string, any>\n  description: string\n  dependsOn?: string[]\n  requiresUserInput?: boolean\n}\n\nexport interface CommandContext {\n  userId: string\n  currentPage?: string\n  recentActions?: string[]\n  userPreferences?: Record<string, any>\n  availableData?: {\n    tasks?: any[]\n    courses?: any[]\n    habits?: any[]\n    materials?: any[]\n  }\n}\n\nexport class JarvisCommandParser {\n  private readonly COMMAND_PATTERNS = {\n    // Task Management\n    create_task: [\n      /(?:create|add|make|schedule)\\s+(?:a\\s+)?(?:new\\s+)?task(?:\\s+(?:called|named|titled)\\s+)?[\"']?([^\"']+)[\"']?/i,\n      /(?:i\\s+need\\s+to|i\\s+have\\s+to|i\\s+should)\\s+(.+?)(?:\\s+(?:by|before|due)\\s+(.+?))?(?:\\s+(?:for|in)\\s+(.+?))?$/i,\n      /(?:remind\\s+me\\s+to|don't\\s+forget\\s+to)\\s+(.+?)(?:\\s+(?:by|before|due)\\s+(.+?))?$/i\n    ],\n\n    complete_task: [\n      /(?:complete|finish|mark\\s+(?:as\\s+)?done|check\\s+off)\\s+(?:task\\s+)?[\"']?([^\"']+)[\"']?/i,\n      /(?:i\\s+(?:finished|completed|done\\s+with))\\s+(.+)$/i\n    ],\n\n    show_tasks: [\n      /(?:show|list|display|get)\\s+(?:me\\s+)?(?:my\\s+)?tasks?(?:\\s+(?:for|in)\\s+(.+?))?(?:\\s+(?:due|before)\\s+(.+?))?/i,\n      /(?:what\\s+(?:do\\s+i\\s+have\\s+to\\s+do|tasks\\s+do\\s+i\\s+have|is\\s+on\\s+my\\s+plate))\\??$/i,\n      /(?:what's\\s+(?:due|coming\\s+up|on\\s+my\\s+schedule))\\??$/i\n    ],\n\n    // Study Sessions\n    start_study: [\n      /(?:start|begin|launch)\\s+(?:a\\s+)?(?:study|focus|work)\\s+session(?:\\s+(?:for|on)\\s+(.+?))?(?:\\s+(?:of|lasting)\\s+(\\d+)\\s*(?:min|minutes?))?/i,\n      /(?:let's\\s+(?:study|focus|work))\\s*(?:\\s+(?:on|for)\\s+(.+?))?(?:\\s+(?:for|lasting)\\s+(\\d+)\\s*(?:min|minutes?))?/i,\n      /(?:time\\s+to\\s+(?:study|focus|work))\\s*(?:\\s+(?:on|for)\\s+(.+?))?(?:\\s+(?:for|lasting)\\s+(\\d+)\\s*(?:min|minutes?))?/i\n    ],\n\n    // Habit Tracking\n    complete_habit: [\n      /(?:i\\s+(?:did|completed?|finished))\\s+(.+?)(?:\\s+today)?$/i,\n      /(?:mark|check)\\s+(.+?)\\s+(?:as\\s+)?(?:done|completed?)(?:\\s+today)?$/i,\n      /(?:completed?|finished|did)\\s+(.+?)(?:\\s+habit)?(?:\\s+today)?$/i\n    ],\n\n    show_habits: [\n      /(?:show|list|display)\\s+(?:me\\s+)?(?:my\\s+)?habits?$/i,\n      /(?:what\\s+habits?\\s+(?:do\\s+i\\s+have|should\\s+i\\s+do))\\??$/i,\n      /(?:habit\\s+(?:tracker|status|progress))\\??$/i\n    ],\n\n    // Course Management\n    show_course: [\n      /(?:show|tell\\s+me\\s+about|what's\\s+up\\s+with)\\s+(?:my\\s+)?(.+?)\\s+course$/i,\n      /(?:course\\s+info|course\\s+details)\\s+(?:for\\s+)?(.+)$/i,\n      /(?:how's\\s+my\\s+)?(.+?)\\s+(?:course|class)\\s+(?:going|progress)\\??$/i\n    ],\n\n    // Materials\n    find_material: [\n      /(?:find|search|get|show)\\s+(?:me\\s+)?(?:materials?|notes?|resources?)(?:\\s+(?:for|about|on)\\s+(.+?))?(?:\\s+(?:in|from)\\s+(.+?))?/i,\n      /(?:where\\s+(?:are|is)\\s+my\\s+)?(.+?)\\s+(?:notes?|materials?|resources?)\\??$/i,\n      /(?:i\\s+need\\s+(?:materials?|notes?|resources?)\\s+(?:for|about|on)\\s+)?(.+)$/i\n    ],\n\n    // Scheduling\n    schedule_event: [\n      /(?:schedule|plan|set\\s+up)\\s+(?:a\\s+)?(?:meeting|event|appointment)(?:\\s+(?:called|named|titled)\\s+[\"']?([^\"']+)[\"']?)?(?:\\s+(?:for|on|at)\\s+(.+?))?(?:\\s+(?:with|and)\\s+(.+?))?/i,\n      /(?:add\\s+to\\s+(?:my\\s+)?calendar|put\\s+on\\s+(?:my\\s+)?schedule)\\s+(.+?)(?:\\s+(?:at|on)\\s+(.+?))?(?:\\s+(?:with|and)\\s+(.+?))?/i\n    ],\n\n    // Analytics\n    show_progress: [\n      /(?:show|tell\\s+me|get)\\s+(?:my\\s+)?(?:progress|stats|analytics|performance)(?:\\s+(?:for|on|in)\\s+(.+?))?(?:\\s+(?:this\\s+)?(?:week|month|year))?/i,\n      /(?:how\\s+(?:am\\s+i\\s+doing|is\\s+my\\s+progress|are\\s+my\\s+stats))\\??(?:\\s+(?:in|for|on)\\s+(.+?))?/i,\n      /(?:progress\\s+report|study\\s+stats|performance\\s+summary)(?:\\s+(?:for|on)\\s+(.+?))?\\??$/i\n    ],\n\n    // Multi-step Commands\n    study_plan: [\n      /(?:create|make|plan|generate)\\s+(?:a\\s+)?(?:study|revision|exam)\\s+plan(?:\\s+(?:for|exam)\\s+(.+?))?(?:\\s+(?:in|over)\\s+(\\d+)\\s*(?:days?|weeks?))?/i,\n      /(?:help\\s+me\\s+)?(?:plan|prepare)\\s+(?:for\\s+)?(?:my\\s+)?(.+?)\\s+(?:exam|test|quiz)(?:\\s+(?:in|over)\\s+(\\d+)\\s*(?:days?|weeks?))?/i\n    ],\n\n    productivity_session: [\n      /(?:start|begin|launch)\\s+(?:a\\s+)?(?:productivity|deep\\s+work|focus)\\s+session(?:\\s+(?:for|lasting)\\s+(\\d+)\\s*(?:min|minutes?|hours?))?/i,\n      /(?:let's\\s+(?:get|be)\\s+productive|time\\s+for\\s+deep\\s+work|focus\\s+mode|do\\s+not\\s+disturb)$/i\n    ]\n  }\n\n  private readonly INTENT_MAPPING = {\n    create_task: 'task.create',\n    complete_task: 'task.complete',\n    show_tasks: 'task.list',\n    start_study: 'study.start',\n    complete_habit: 'habit.complete',\n    show_habits: 'habit.list',\n    show_course: 'course.info',\n    find_material: 'material.search',\n    schedule_event: 'calendar.create',\n    show_progress: 'analytics.show',\n    study_plan: 'plan.create',\n    productivity_session: 'productivity.start'\n  }\n\n  parseCommand(command: string, context?: CommandContext): ParsedCommand {\n    const normalizedCommand = command.toLowerCase().trim()\n\n    // Try to match against patterns\n    for (const [intentKey, patterns] of Object.entries(this.COMMAND_PATTERNS)) {\n      for (const pattern of patterns) {\n        const match = normalizedCommand.match(pattern)\n        if (match) {\n          const parsed = this.buildParsedCommand(intentKey, match, command)\n          if (parsed.confidence > 0.3) {\n            // Add multi-step logic if needed\n            if (parsed.multiStep) {\n              parsed.steps = this.generateSteps(parsed, context)\n            }\n            return parsed\n          }\n        }\n      }\n    }\n\n    // Fallback to generic command\n    return {\n      intent: 'unknown',\n      entities: {},\n      confidence: 0.1,\n      originalCommand: command,\n      requiresConfirmation: true\n    }\n  }\n\n  private buildParsedCommand(intentKey: string, match: RegExpMatchArray, originalCommand: string): ParsedCommand {\n    const intent = this.INTENT_MAPPING[intentKey as keyof typeof this.INTENT_MAPPING] || intentKey\n    const entities: Record<string, any> = {}\n    let confidence = 0.8\n\n    switch (intentKey) {\n      case 'create_task':\n        entities.title = match[1] || match[2] || match[3]\n        entities.dueDate = this.parseDate(match[4] || match[5])\n        entities.course = match[6]\n        break\n\n      case 'complete_task':\n        entities.taskName = match[1] || match[2]\n        break\n\n      case 'show_tasks':\n        entities.filter = match[1] || match[2] ? { course: match[1], dueDate: match[2] } : null\n        break\n\n      case 'start_study':\n        entities.task = match[1] || match[2]\n        entities.duration = match[3] || match[4] ? parseInt(match[3] || match[4]) : 25\n        break\n\n      case 'complete_habit':\n        entities.habitName = match[1] || match[2] || match[3]\n        break\n\n      case 'show_course':\n        entities.courseName = match[1] || match[2] || match[3]\n        break\n\n      case 'find_material':\n        entities.topic = match[1] || match[2] || match[3]\n        entities.course = match[4]\n        break\n\n      case 'schedule_event':\n        entities.title = match[1] || match[4]\n        entities.dateTime = this.parseDate(match[2] || match[5])\n        entities.participants = match[3] || match[6]\n        break\n\n      case 'study_plan':\n        entities.examName = match[1] || match[2]\n        entities.days = match[3] || match[4] ? parseInt(match[3] || match[4]) : 7\n        confidence = 0.9\n        break\n\n      case 'productivity_session':\n        entities.duration = match[1] ? this.parseDuration(match[1]) : 90\n        confidence = 0.9\n        break\n\n      default:\n        confidence = 0.5\n    }\n\n    return {\n      intent,\n      entities,\n      confidence,\n      originalCommand,\n      multiStep: ['study_plan', 'productivity_session'].includes(intentKey),\n      requiresConfirmation: confidence < 0.7\n    }\n  }\n\n  private generateSteps(parsed: ParsedCommand, context?: CommandContext): CommandStep[] {\n    const steps: CommandStep[] = []\n\n    switch (parsed.intent) {\n      case 'plan.create':\n        steps.push(\n          {\n            id: 'gather_requirements',\n            action: 'analyze_course_materials',\n            params: { examName: parsed.entities.examName },\n            description: 'Analyzing course materials and syllabus'\n          },\n          {\n            id: 'assess_current_progress',\n            action: 'check_completion_status',\n            params: { course: parsed.entities.examName },\n            description: 'Checking current progress and completed topics'\n          },\n          {\n            id: 'calculate_study_load',\n            action: 'estimate_time_needed',\n            params: { days: parsed.entities.days, course: parsed.entities.examName },\n            description: 'Calculating optimal study time distribution'\n          },\n          {\n            id: 'generate_schedule',\n            action: 'create_study_plan',\n            params: { days: parsed.entities.days, course: parsed.entities.examName },\n            description: 'Creating detailed study schedule',\n            dependsOn: ['gather_requirements', 'assess_current_progress', 'calculate_study_load']\n          },\n          {\n            id: 'create_tasks',\n            action: 'schedule_tasks',\n            params: { planId: '{{generate_schedule.result}}' },\n            description: 'Adding study tasks to your planner',\n            dependsOn: ['generate_schedule']\n          }\n        )\n        break\n\n      case 'productivity.start':\n        steps.push(\n          {\n            id: 'prepare_environment',\n            action: 'setup_focus_mode',\n            params: { duration: parsed.entities.duration },\n            description: 'Setting up distraction-free environment'\n          },\n          {\n            id: 'select_task',\n            action: 'choose_next_task',\n            params: {},\n            description: 'Selecting the most important task to focus on',\n            requiresUserInput: true\n          },\n          {\n            id: 'start_timer',\n            action: 'begin_pomodoro',\n            params: { taskId: '{{select_task.result}}', duration: parsed.entities.duration },\n            description: 'Starting focused work session',\n            dependsOn: ['prepare_environment', 'select_task']\n          },\n          {\n            id: 'monitor_progress',\n            action: 'track_session',\n            params: { sessionId: '{{start_timer.result}}' },\n            description: 'Monitoring your progress and providing encouragement'\n          }\n        )\n        break\n    }\n\n    return steps\n  }\n\n  private parseDate(dateStr?: string): Date | null {\n    if (!dateStr) return null\n\n    // Simple date parsing - could be enhanced with a proper date library\n    const today = new Date()\n    const lowerStr = dateStr.toLowerCase()\n\n    if (lowerStr.includes('tomorrow')) {\n      const tomorrow = new Date(today)\n      tomorrow.setDate(today.getDate() + 1)\n      return tomorrow\n    }\n\n    if (lowerStr.includes('next week')) {\n      const nextWeek = new Date(today)\n      nextWeek.setDate(today.getDate() + 7)\n      return nextWeek\n    }\n\n    if (lowerStr.includes('end of week') || lowerStr.includes('friday')) {\n      const friday = new Date(today)\n      const daysUntilFriday = (5 - today.getDay() + 7) % 7\n      friday.setDate(today.getDate() + (daysUntilFriday === 0 ? 7 : daysUntilFriday))\n      return friday\n    }\n\n    // Try to parse as a specific date\n    const parsed = new Date(dateStr)\n    if (!isNaN(parsed.getTime())) {\n      return parsed\n    }\n\n    return null\n  }\n\n  private parseDuration(durationStr: string): number {\n    const match = durationStr.match(/(\\d+)\\s*(min|minutes?|hours?)/i)\n    if (match) {\n      const value = parseInt(match[1])\n      const unit = match[2].toLowerCase()\n      return unit.startsWith('hour') ? value * 60 : value\n    }\n    return 25 // Default 25 minutes\n  }\n\n  // Utility method to get suggested commands based on context\n  getSuggestedCommands(context?: CommandContext): string[] {\n    const suggestions: string[] = []\n\n    if (context?.currentPage === 'dashboard') {\n      suggestions.push(\n        \"Start a study session\",\n        \"Show my tasks\",\n        \"Complete a habit\",\n        \"Create a study plan\"\n      )\n    }\n\n    if (context?.currentPage === 'planner') {\n      suggestions.push(\n        \"Create a new task\",\n        \"Show tasks due today\",\n        \"Schedule an event\"\n      )\n    }\n\n    if (context?.availableData?.tasks && context.availableData.tasks.length > 0) {\n      suggestions.push(\"Show my tasks\")\n    }\n\n    if (context?.availableData?.habits && context.availableData.habits.length > 0) {\n      suggestions.push(\"Show my habits\")\n    }\n\n    return suggestions.slice(0, 4) // Return top 4 suggestions\n  }\n}\n\n// Singleton instance\nlet commandParser: JarvisCommandParser | null = null\n\nexport function getCommandParser(): JarvisCommandParser {\n  if (!commandParser) {\n    commandParser = new JarvisCommandParser()\n  }\n  return commandParser\n}"],"names":[],"mappings":"6DACA,IAAI,EAAA,EAAA,CAAA,CAAA,OAIA,EAFwC,GAAkB,AAAb,OAAO,KAEnC,KAAmC,GAFkB,GAE1C,GAAE,OAFqD,GAAQ,CAAJ,AAAM,SAAa,EAAF,AAqBxG,EAA4B,aAAnB,OAAO,SAA2B,QAAQ,GAAG,EAAI,GAC1D,EAAW,SAAS,CAAC,EACrB,MAA6C,oBAAtC,OAAO,CAFqE,QAE5D,CAAC,QAAQ,CAAC,IAAI,CAAC,EAC1C,EACI,EAA2B,WAAd,AACb,SAAS,EADe,AACJ,CAAK,EACrB,IAAI,EAAgB,KAAK,IAAf,EAAmB,CAAC,EAAI,EAAO,EAAQ,EAAI,IAAI,CAAE,EAAiB,KAAK,IAAf,EAAmB,aAAe,EAAO,EAAoB,EAAI,gBAAgB,CAAE,EAAmB,AAAsB,KAAK,MAAI,EAAS,EAChN,EAAY,EAAS,GAAO,2BAC5B,IAAI,CAAC,KAAK,CAAG,EACb,IAAI,CAAC,uBAAuB,CAAG,IAAM,EAAO,sBAC5C,EAAwC,WAA5B,OAAO,EAAgC,wCACnD,IAAI,CAAC,iBAAiB,CAAG,EACzB,IAAI,CAAC,YAAY,CAAG,OACpB,IAAI,CAAC,KAAK,CAAG,EAAE,CACf,IAAI,CAAC,SAAS,EAAG,EACjB,IAAI,CAAC,WAAW,CAAG,EAEnB,IAAI,CAAC,MAAM,CAAyC,EAAtC,EAClB,CACA,MAAI,EAAS,EAAW,SAAS,CA2LjC,OA1LA,EAAO,MAHkB,aAGC,CAAG,SAAS,AAAoB,CAAI,EAC1D,EAA4B,WAAhB,OAAO,EAAoB,2CACvC,EAAiC,IAArB,IAAI,CAAC,WAAW,CAAQ,oEACpC,IAAI,CAAC,KAAK,GACV,IAAI,CAAC,iBAAiB,CAAG,EACzB,IAAI,CAAC,MAAM,EACf,EACA,EAAO,kBAAkB,CAAG,SAAS,EACjC,OAAO,IAAI,CAAC,iBAAiB,AACjC,EACA,EAAO,MAAM,CAAG,SAAS,EACrB,IAAI,EAAQ,IAAI,CAChB,EAAY,CAAC,IAAI,CAAC,SAAS,CAAE,0BAC7B,IAAI,CAAC,SAAS,EAAG,EAajB,IAAI,CAAC,YAAY,CAAG,CAChB,SAAU,EAAE,CACZ,WAAY,SAAS,CAAI,CAAE,CAAK,EAU5B,MATqB,UAAjB,AAA2B,OAApB,EACP,EAAM,YAAY,CAAC,QAAQ,CAAC,EAAM,CAAG,CACjC,QAAS,CACb,EAEA,EAAM,YAAY,CAAC,QAAQ,CAAC,IAAI,CAAC,CAC7B,QAAS,CACb,GAEG,CACX,EACA,WAAY,SAAS,CAAK,EACtB,EAAM,YAAY,CAAC,QAAQ,CAAC,EAAM,CAAG,IACzC,CACJ,CACJ,EACA,EAAO,cAAc,CAAG,SAAS,AAAe,CAAG,EAC/C,GAAI,EAAI,KAAK,CACT,CADW,MACJ,EAAI,KAAK,CAGpB,IAAI,IAAI,EAAI,EAAG,EAAI,SAAS,WAAW,CAAC,MAAM,CAAE,IAAI,AAChD,GAAI,SAAS,WAAW,CAAC,EAAE,CAAC,SAAS,GAAK,EACtC,GAD2C,IACpC,SAAS,WAAW,CAAC,EAAE,AAG1C,EACA,EAAO,QAAQ,CAAG,SAAS,EACvB,OAAO,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,KAAK,CAAC,MAAM,CAAG,EAAE,CAChE,EACA,EAAO,UAAU,CAAG,SAAS,AAAW,CAAI,CAAE,CAAK,SAC/C,EAAY,EAAS,GAAO,qCAEH,UAAjB,AAA2B,OAApB,IACP,EAAQ,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC,MAAA,AAAM,EAE7C,IAAI,CAAC,YAAY,CAAC,UAAU,CAAC,EAAM,GAC5B,IAAI,CAAC,WAAW,EAsB/B,EACA,EAAO,WAAW,CAAG,SAAS,AAAY,CAAK,CAAE,CAAI,EAC7C,IAAI,CAAC,iBAAiB,CACtB,GAD0B,CACtB,EAA0D,IAAI,CAAC,CAAvD,WAAmE,CAI/E,GAHI,AAAC,EAAK,IAAI,IAAI,CACd,EAAO,IAAI,CAAC,KAF4B,GADA,aAAa,EAGzC,AAAuB,EAEnC,CAAC,EAAM,QAAQ,CAAC,EAAM,CAEtB,CAFwB,MAEjB,EAEX,EAAM,UAAU,CAAC,GACjB,GAAI,CACA,EAAM,UAAU,CAAC,EAAM,EAC3B,CAAE,MAAO,EAAO,CACR,AAAC,GACD,KADS,GACD,IAAI,CAAC,iCAAmC,EAAO,8DAG3D,EAAM,UAAU,CAAC,IAAI,CAAC,uBAAuB,CAAE,EACnD,CAMJ,OAAO,CACX,EACA,EAAO,UAAU,CAAG,SAAS,AAAW,CAAK,EAErC,IAAI,CAAC,YAAY,CAAC,UAAU,CAAC,EAWrC,EACA,EAAO,KAAK,CAAG,SAAS,EACpB,IAAI,CAAC,SAAS,EAAG,EACjB,IAAI,CAAC,WAAW,CAAG,EAQf,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAG,EAAE,AAEvC,EACA,EAAO,QAAQ,CAAG,SAAS,EAGnB,OAAO,IAAI,CAAC,YAAY,CAAC,QAAQ,AAYzC,EACA,EAAO,YAAY,CAAG,SAAS,AAAa,CAAI,CAAE,CAAS,CAAE,CAAa,EAClE,GACA,EAAY,EAAS,GAAY,CADtB,wDAGf,IAAI,EAAM,SAAS,aAAa,CAAC,SAC7B,IAAI,CAAC,MAAM,EAAE,EAAI,YAAY,CAAC,QAAS,IAAI,CAAC,MAAM,EACtD,EAAI,IAAI,CAAG,WACX,EAAI,YAAY,CAAC,QAAU,EAAM,IAC7B,GACA,EAAI,MADO,KACI,CAAC,SAAS,cAAc,CAAC,IAE5C,IAAI,EAAO,SAAS,IAAI,EAAI,SAAS,oBAAoB,CAAC,OAAO,CAAC,EAAE,CAMpE,OALI,EACA,EAAK,WADU,CACE,CAAC,EAAK,GAEvB,EAAK,WAAW,CAAC,GAEd,CACX,EA1M+B,EA2MN,CACrB,CACI,IAAK,EA7M4B,EAAE,KA8MnC,IAAK,EA9MyC,OA8MhC,EACV,OAAO,IAAI,CAAC,WAAW,AAC3B,CACJ,EACH,CAjNe,AAVjB,SAA2B,AAAlB,CAAwB,CAAE,CAAK,EACvC,IAAI,IAAI,EAAI,EAAG,EAAI,EAAM,MAAM,CAAE,IAAI,CACjC,IAAI,EAAa,CAAK,CAAC,EAAE,CACzB,EAAW,UAAU,CAAG,EAAW,UAAU,GAAI,EACjD,EAAW,YAAY,EAAG,EACtB,UAAW,IAAY,EAAW,QAAQ,EAAG,CAAA,EACjD,OAAO,cAAc,CAAC,EAAQ,EAAW,GAAG,CAAE,EAClD,CACJ,EA4MiB,AA1MqB,EAAY,SAAS,CAAE,GAkNlD,CACX,IACA,SAAS,EAAY,CAAS,CAAE,CAAO,EACnC,GAAI,CAAC,EACD,MAAU,AAAJ,GADM,GACI,eAAiB,EAAU,IAEnD,CAWA,IAAI,EATJ,SAAS,AAAK,CAAG,CASA,CAPb,IADA,IAAI,EAAS,KAAM,EAAI,EAAI,MAAM,CAC3B,EAAE,CACJ,EAAkB,GAAT,EAAc,EAAI,UAAU,CAAC,EAAE,GAIiB,OAAO,IAAW,CACnF,EAMI,EAAQ,CAAC,EAKT,SAAS,EAAU,CAAM,CAAE,CAAK,EAChC,GAAI,CAAC,EACD,KADQ,CACD,OAAS,EAEpB,IAAI,EAAgB,OAAO,GACvB,EAAM,EAAS,EAInB,OAHI,AAAC,CAAK,CAAC,EAAI,EAAE,CACb,CAAK,CAAC,EAAI,CAAG,OAAS,EAAW,EAAS,IAAM,EAAA,EAE7C,CAAK,CAAC,EAAI,AACrB,CAKI,SAAS,EAAgB,CAAE,CAAE,CAAG,EAQhC,IAAI,EAAQ,GAFR,EAAe,AAEF,AA9BV,EAAK,EA4BF,KA5BS,CAAC,YAAa,WA4Bd,EAMnB,OAHI,AAAC,CAAK,CAAC,EAAM,EAAE,CACf,CAAK,CAAC,EAAM,CAAG,EAAI,OAAO,CATC,AASA,gCAA0B,EAAA,EAElD,CAAK,CAAC,EAAM,AACvB,CAkBA,IAAI,EAAmC,WACnC,QADqB,CACZ,EAAmB,CAAK,EAC7B,IAAI,CAFwB,CAElB,AAAU,KAAK,MAAI,CAAC,EAAI,EAAO,EAAc,EAAI,UAAU,CAAE,EAAa,AAAgB,KAAK,MAAI,KAAO,EAAa,EAAoB,EAAI,gBAAgB,CAAE,EAAyC,KAAK,IAA3B,AAA+B,GAAQ,EACrO,IAAI,CAAC,MAAM,CAAG,GAAc,IAAI,EAAW,CACvC,KAAM,aACN,iBAAkB,CACtB,GACA,IAAI,CAAC,MAAM,CAAC,MAAM,GACd,GAA0C,WAA5B,AAAuC,OAAhC,IACrB,IAAI,CAAC,MAAM,CAAC,mBAAmB,CAAC,GAChC,IAAI,CAAC,iBAAiB,CAAG,IAAI,CAAC,MAAM,CAAC,kBAAkB,IAE3D,IAAI,CAAC,WAAW,MAAG,EACnB,IAAI,CAAC,QAAQ,CAAG,CAAC,EACjB,IAAI,CAAC,gBAAgB,CAAG,CAAC,CAC7B,CACA,IAAI,EAAS,EAAmB,SAAS,CAoHzC,OAnHA,EAAO,GAAG,CAAG,SAAS,AAAI,CAAK,EAC3B,IAAI,EAAQ,IAAI,MACZ,IAAc,IAAI,CAAC,iBAAiB,EAAE,CACtC,IAAI,CAAC,iBAAiB,CAAG,MAAM,OAAO,CAAC,EAAM,QAAQ,EACrD,IAAI,CAAC,MAAM,CAAC,mBAAmB,CAAC,IAAI,CAAC,iBAAiB,EACtD,IAAI,CAAC,iBAAiB,CAAG,IAAI,CAAC,MAAM,CAAC,kBAAkB,IAS3D,IAAI,EAAM,IAAI,CAAC,aAAa,CAAC,GAAQ,EAAU,EAAI,OAAO,CAAE,EAAQ,EAAI,KAAK,CAE7E,GAAI,KAAW,IAAI,CAAC,gBAAgB,CAAE,CAClC,IAAI,CAAC,gBAAgB,CAAC,EAAQ,EAAI,EAClC,MACJ,CACA,IAAI,EAAU,EAAM,GAAG,CAAC,SAAS,CAAI,EACjC,OAAO,EAAM,MAAM,CAAC,UAAU,CAAC,EACnC,GACC,AADC,MACK,CAAC,SAAS,CAAK,EAClB,OAAiB,CAAC,AAFO,IAElB,CACX,GACA,IAAI,CAAC,QAAQ,CAAC,EAAQ,CAAG,EACzB,IAAI,CAAC,gBAAgB,CAAC,EAAQ,CAAG,CACrC,EACA,EAAO,MAAM,CAAG,SAAgB,AAAP,CAAY,EACjC,IAAI,EAAQ,IAAI,CACZ,EAAU,IAAI,CAAC,aAAa,CAAC,GAAO,OAAO,CAG/C,GAFA,AAqFR,SAAS,AAAU,CAAS,CAAE,CAAO,EACjC,GAAI,CAAC,EACD,MAAM,AAAI,GADE,GACI,uBAAyB,EAAU,IAE3D,EAzFkB,KAAW,IAAI,CAAC,gBAAgB,CAAE,aAAe,EAAU,eACrE,IAAI,CAAC,gBAAgB,CAAC,EAAQ,EAAI,EAC9B,IAAI,CAAC,gBAAgB,CAAC,EAAQ,CAAG,EAAG,CACpC,IAAI,EAAgB,IAAI,CAAC,WAAW,EAAI,IAAI,CAAC,WAAW,CAAC,EAAQ,CAC7D,GACA,EAAc,UAAU,AADT,CACU,WAAW,CAAC,GACrC,OAAO,IAAI,CAAC,WAAW,CAAC,EAAQ,GAEhC,IAAI,CAAC,QAAQ,CAAC,EAAQ,CAAC,OAAO,CAAC,SAAS,CAAK,EACzC,OAAO,EAAM,MAAM,CAAC,UAAU,CAAC,EACnC,GACA,OAAO,IAAI,CAAC,QAAQ,CAAC,EAAQ,EAEjC,OAAO,IAAI,CAAC,gBAAgB,CAAC,EACjC,AADyC,CAE7C,EACA,EAAO,MAAM,CAAG,SAAS,AAAO,CAAK,CAAE,CAAS,EAC5C,IAAI,CAAC,GAAG,CAAC,GACT,IAAI,CAAC,MAAM,CAAC,EAChB,EACA,EAAO,KAAK,CAAG,SAAS,EACpB,IAAI,CAAC,MAAM,CAAC,KAAK,GACjB,IAAI,CAAC,MAAM,CAAC,MAAM,GAClB,IAAI,CAAC,WAAW,CAAG,OACnB,IAAI,CAAC,QAAQ,CAAG,CAAC,EACjB,IAAI,CAAC,gBAAgB,CAAG,CAAC,CAC7B,EACA,EAAO,QAAQ,CAAG,SAAS,EACvB,IAAI,EAAQ,IAAI,CACZ,EAAa,IAAI,CAAC,WAAW,CAAG,OAAO,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE,GAAG,CAAC,SAAS,CAAO,EAClF,MAAO,CACH,EACA,EAAM,WAAW,CAAC,EAAQ,CAC7B,AACL,GAAK,EAAE,CACH,EAAW,IAAI,CAAC,MAAM,CAAC,QAAQ,GACnC,OAAO,EAAW,MAAM,CAAC,OAAO,IAAI,CAAC,IAAI,CAAC,QAAQ,EAAE,GAAG,CAAC,SAAS,CAAO,EACpE,MAAO,CACH,EACA,EAAM,QAAQ,CAAC,EAAQ,CAAC,GAAG,CAAC,SAAS,CAAK,EACtC,OAAO,CAAQ,CAAC,EAAM,CAAC,OAAO,AAClC,GAAG,IAAI,CAAC,EAAM,iBAAiB,CAAG,GAAK,MAC1C,AACL,GAAE,AACD,MAAM,CAAC,SAAS,CAAI,EACjB,MAFuB,CAEhB,CAAQ,CAAI,CAAC,EAAE,AAC1B,GACJ,EACA,EAAO,MAAM,CAAG,SAAS,AAAO,CAAO,MAjHlB,IAkHjB,IAlHyB,GAkHlB,EAAgB,IAAI,CAAC,QAAQ,GAjHpC,AAAY,KAAK,KADU,EAkHa,KAlHN,AACd,EAAU,EAAC,EAC5B,EAAS,GAAG,CAAC,SAAS,CAAI,EAC7B,IAAI,EAAK,CAAI,CAAC,EAAE,CACZ,EAAM,CAAI,CAAC,EAAE,CACjB,OAAO,AAAc,EAAe,OAAU,CAAC,CAA7B,GAAiB,SAAyB,CAAC,QAAS,CAClE,GAAI,KAAO,EAEX,IAAK,KAAO,EACZ,MAAO,EAAQ,KAAK,CAAG,EAAQ,KAAK,MAAG,EACvC,wBAAyB,CACrB,OAAQ,CACZ,CACJ,EACJ,EAqGA,EACA,EAAO,aAAa,CAAG,SAAS,AAAc,CAAK,EAC/C,IAAI,EAAM,EAAM,QAAQ,CAAE,EAAU,EAAM,OAAO,CAAE,EAAK,EAAM,EAAE,CAChE,GAAI,EAAS,CACT,IAAI,EAAU,EAAU,EAAI,GAC5B,MAAO,CACH,QAAS,EACT,MAAO,MAAM,OAAO,CAAC,GAAO,EAAI,GAAG,CAAC,SAAS,CAAI,EAC7C,OAAO,EAAgB,EAAS,EACpC,GAAK,CACD,EAAgB,EAAS,GAC5B,AACL,CACJ,CACA,MAAO,CACH,QAAS,EAAU,GACnB,MAAO,MAAM,OAAO,CAAC,GAAO,EAAM,CAC9B,EACH,AACL,CACJ,EAKE,EAAO,gBAAgB,CAAG,SAAS,EAEjC,OAAO,AADQ,MAAM,SAAS,CAAC,KAAK,CAAC,IAAI,CAAC,SAAS,gBAAgB,CAAC,mBACpD,MAAM,CAAC,SAAS,CAAG,CAAE,CAAO,EAGxC,OADA,CAAG,CADM,AACL,EADa,EAAE,CAAC,KAAK,CAAC,GACnB,CAAG,EACH,CACX,EAAG,CAAC,EACR,EACO,CACX,IAMI,EAAkC,EAAM,aAAa,CAAC,EAAlC,IAExB,OAFmC,EAE1B,IACL,OAAO,IAAI,CACf,CAWA,SAAS,IACL,OAAO,EAAM,UAAU,CAAC,EAC5B,CAMA,SAAS,EAAS,CAAK,EACnB,IAAI,EAA+C,SAApC,EAEV,GAID,EAAS,GAAG,CAAC,CAJF,EACJ,IAiBf,CA3CA,EAAkB,WAAW,CAAG,KAuBK,eAHZ,EAAe,OAAU,CAAC,IAAZ,cAA8B,EAAI,EAAe,OAAU,CAAC,IAAZ,WAA2B,CAwBlH,EAAS,OAAO,CAAG,SAAS,CAAI,EAC5B,OAAO,EAAK,GAAG,CAAC,SAAS,CAAO,EAG5B,OAAO,EAFM,CAAO,CAAC,EAAE,CACX,CAAO,CAAC,CACH,CADK,CAE1B,GAAG,GAD0B,CACtB,CAAC,IACZ,EAEA,EAAQ,aAAa,CAhDrB,EAgDwB,OAhDD,AAAd,CAAmB,EACxB,IAAI,EAAqB,EAAM,QAAQ,CAAE,EAAW,EAAM,QAAQ,CAC9D,EAAe,EAAM,UAAU,CAAC,GAGhC,EAFM,AAEK,EAFC,QAAQ,CAAC,WACrB,OAAO,GAAgB,GAAsB,GACjD,EAAkB,CAAC,EAAE,CACrB,OAAO,AAAc,EAAe,OAAU,CAAC,CAA7B,GAAiB,SAAyB,CAAC,EAAkB,QAAQ,CAAE,CACrF,MAAO,CACX,EAAG,EACP,EAwCA,EAAQ,mBAAmB,CAAG,EAC9B,EAAQ,KAAK,CAAG,EAChB,EAAQ,gBAAgB,CAAG,mBClf3B,EAAO,OAAO,CAAG,EAAA,CAAA,CAAA,OAAwB,KAAK,uDKE9C,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OHiPO,SAAS,EAAM,CAAY,CAAE,EAAwB,CAAC,CAAC,EAC5D,OAAO,IAAI,QAAQ,CAAC,EAAS,KAEzB,EAAO,AAAI,MAAM,kCA8CrB,EACF,CASO,SAAS,IAGhB,CDjTA,EAAA,CAAA,CAAA,OACA,IAAA,EAAA,EAAA,CAAA,CAAA,MO+BO,OAAM,EACM,iBAAmB,CAElC,YAAa,CACX,+GACA,kHACA,sFACD,CAED,cAAe,CACb,0FACA,sDACD,CAED,WAAY,CACV,kHACA,yFACA,2DACD,CAGD,YAAa,CACX,+IACA,mHACA,uHACD,CAGD,eAAgB,CACd,6DACA,wEACA,kEACD,CAED,YAAa,CACX,wDACA,8DACA,+CACD,CAGD,YAAa,CACX,6EACA,yDACA,uEACD,CAGD,cAAe,CACb,oIACA,+EACA,+EACD,CAGD,eAAgB,CACd,oLACA,gIACD,CAGD,cAAe,CACb,mJACA,oGACA,2FACD,CAGD,WAAY,CACV,qJACA,qIACD,CAED,qBAAsB,CACpB,2IACA,iGACD,AACH,CAAC,AAEgB,gBAAiB,CAChC,YAAa,cACb,cAAe,gBACf,WAAY,YACZ,YAAa,cACb,eAAgB,iBAChB,YAAa,aACb,YAAa,cACb,cAAe,kBACf,eAAgB,kBAChB,cAAe,iBACf,WAAY,cACZ,qBAAsB,oBACxB,CAAC,CAED,aAAa,CAAe,CAAE,CAAwB,CAAiB,CACrE,IAAM,EAAoB,EAAQ,WAAW,GAAG,IAAI,GAGpD,IAAK,GAAM,CAAC,EAAW,EAAS,GAAI,OAAO,OAAO,CAAC,IAAI,CAAC,gBAAgB,EAAG,AACzE,IAAK,IAAM,KAAW,EAAU,CAC9B,IAAM,EAAQ,EAAkB,KAAK,CAAC,GACtC,GAAI,EAAO,CACT,IAAM,EAAS,IAAI,CAAC,kBAAkB,CAAC,EAAW,EAAO,GACzD,GAAI,EAAO,UAAU,CAAG,GAKtB,EAL2B,KAEvB,EAAO,SAAS,EAAE,CACpB,EAAO,KAAK,CAAG,IAAI,CAAC,aAAa,CAAC,EAAQ,EAAA,EAErC,CAEX,CACF,CAIF,MAAO,CACL,OAAQ,UACR,SAAU,CAAC,EACX,WAAY,GACZ,gBAAiB,EACjB,sBAAsB,CACxB,CACF,CAEQ,mBAAmB,CAAiB,CAAE,CAAuB,CAAE,CAAuB,CAAiB,CAC7G,IAAM,EAAS,IAAI,CAAC,cAAc,CAAC,EAA8C,EAAI,EAC/E,EAAgC,CAAC,EACnC,EAAa,GAEjB,OAAQ,GACN,IAAK,cACH,EAAS,KAAK,CAAG,CAAK,CAAC,EAAE,EAAI,CAAK,CAAC,EAAE,EAAI,CAAK,CAAC,EAAE,CACjD,EAAS,OAAO,CAAG,IAAI,CAAC,SAAS,CAAC,CAAK,CAAC,EAAE,EAAI,CAAK,CAAC,EAAE,EACtD,EAAS,MAAM,CAAG,CAAK,CAAC,EAAE,CAC1B,KAEF,KAAK,gBACH,EAAS,QAAQ,CAAG,CAAK,CAAC,EAAE,EAAI,CAAK,CAAC,EAAE,CACxC,KAEF,KAAK,aACH,EAAS,MAAM,CAAG,CAAK,CAAC,EAAE,EAAI,CAAK,CAAC,EAAE,CAAG,CAAE,OAAQ,CAAK,CAAC,EAAE,CAAE,QAAS,CAAK,CAAC,EAAE,AAAC,EAAI,KACnF,KAEF,KAAK,cACH,EAAS,IAAI,CAAG,CAAK,CAAC,EAAE,EAAI,CAAK,CAAC,EAAE,CACpC,EAAS,QAAQ,CAAG,CAAK,CAAC,EAAE,EAAI,CAAK,CAAC,EAAE,CAAG,SAAS,CAAK,CAAC,EAAE,EAAI,CAAK,CAAC,EAAE,EAAI,GAC5E,KAEF,KAAK,iBACH,EAAS,SAAS,CAAG,CAAK,CAAC,EAAE,EAAI,CAAK,CAAC,EAAE,EAAI,CAAK,CAAC,EAAE,CACrD,KAEF,KAAK,cACH,EAAS,UAAU,CAAG,CAAK,CAAC,EAAE,EAAI,CAAK,CAAC,EAAE,EAAI,CAAK,CAAC,EAAE,CACtD,KAEF,KAAK,gBACH,EAAS,KAAK,CAAG,CAAK,CAAC,EAAE,EAAI,CAAK,CAAC,EAAE,EAAI,CAAK,CAAC,EAAE,CACjD,EAAS,MAAM,CAAG,CAAK,CAAC,EAAE,CAC1B,KAEF,KAAK,iBACH,EAAS,KAAK,CAAG,CAAK,CAAC,EAAE,EAAI,CAAK,CAAC,EAAE,CACrC,EAAS,QAAQ,CAAG,IAAI,CAAC,SAAS,CAAC,CAAK,CAAC,EAAE,EAAI,CAAK,CAAC,EAAE,EACvD,EAAS,YAAY,CAAG,CAAK,CAAC,EAAE,EAAI,CAAK,CAAC,EAAE,CAC5C,KAEF,KAAK,aACH,EAAS,QAAQ,CAAG,CAAK,CAAC,EAAE,EAAI,CAAK,CAAC,EAAE,CACxC,EAAS,IAAI,CAAG,CAAK,CAAC,EAAE,EAAI,CAAK,CAAC,EAAE,CAAG,SAAS,CAAK,CAAC,EAAE,EAAI,CAAK,CAAC,EAAE,EAAI,EACxE,EAAa,GACb,KAEF,KAAK,uBACH,EAAS,QAAQ,CAAG,CAAK,CAAC,EAAE,CAAG,IAAI,CAAC,aAAa,CAAC,CAAK,CAAC,EAAE,EAAI,GAC9D,EAAa,GACb,KAEF,SACE,EAAa,EACjB,CAEA,MAAO,QACL,WACA,aACA,kBACA,EACA,UAAW,CAAC,aAAc,uBAAuB,CAAC,QAAQ,CAAC,GAC3D,qBAAsB,EAAa,EACrC,CACF,CAEQ,cAAc,CAAqB,CAAE,CAAwB,CAAiB,CACpF,IAAM,EAAuB,EAAE,CAE/B,OAAQ,EAAO,MAAM,EACnB,IAAK,cACH,EAAM,IAAI,CACR,CACE,GAAI,sBACJ,OAAQ,2BACR,OAAQ,CAAE,SAAU,EAAO,QAAQ,CAAC,QAAQ,AAAC,EAC7C,YAAa,yCACf,EACA,CACE,GAAI,0BACJ,OAAQ,0BACR,OAAQ,CAAE,OAAQ,EAAO,QAAQ,CAAC,QAAS,AAAD,EAC1C,YAAa,gDACf,EACA,CACE,GAAI,uBACJ,OAAQ,uBACR,OAAQ,CAAE,KAAM,EAAO,QAAQ,CAAC,IAAI,CAAE,OAAQ,EAAO,QAAQ,CAAC,QAAS,AAAD,EACtE,YAAa,6CACf,EACA,CACE,GAAI,oBACJ,OAAQ,oBACR,OAAQ,CAAE,KAAM,EAAO,QAAQ,CAAC,IAAI,CAAE,OAAQ,EAAO,QAAQ,CAAC,QAAQ,AAAC,EACvE,YAAa,mCACb,UAAW,CAAC,sBAAuB,0BAA2B,uBAAuB,AACvF,EACA,CACE,GAAI,eACJ,OAAQ,iBACR,OAAQ,CAAE,OAAQ,8BAA+B,EACjD,YAAa,qCACb,UAAW,CAAC,oBAAoB,AAClC,GAEF,KAEF,KAAK,qBACH,EAAM,IAAI,CACR,CACE,GAAI,sBACJ,OAAQ,mBACR,OAAQ,CAAE,SAAU,EAAO,QAAQ,CAAC,QAAQ,AAAC,EAC7C,YAAa,yCACf,EACA,CACE,GAAI,cACJ,OAAQ,mBACR,OAAQ,CAAC,EACT,YAAa,gDACb,mBAAmB,CACrB,EACA,CACE,GAAI,cACJ,OAAQ,iBACR,OAAQ,CAAE,OAAQ,yBAA0B,SAAU,EAAO,QAAQ,CAAC,QAAQ,AAAC,EAC/E,YAAa,gCACb,UAAW,CAAC,sBAAuB,cAAc,AACnD,EACA,CACE,GAAI,mBACJ,OAAQ,gBACR,OAAQ,CAAE,UAAW,wBAAyB,EAC9C,YAAa,sDACf,EAGN,CAEA,OAAO,CACT,CAEQ,UAAU,CAAgB,CAAe,CAC/C,GAAI,CAAC,EAAS,OAAO,KAGrB,IAAM,EAAQ,IAAI,KACZ,EAAW,EAAQ,WAAW,GAEpC,GAAI,EAAS,QAAQ,CAAC,YAAa,CACjC,IAAM,EAAW,IAAI,KAAK,GAE1B,OADA,EAAS,OAAO,CAAC,EAAM,OAAO,GAAK,GAC5B,CACT,CAEA,GAAI,EAAS,QAAQ,CAAC,aAAc,CAClC,IAAM,EAAW,IAAI,KAAK,GAE1B,OADA,EAAS,OAAO,CAAC,EAAM,OAAO,GAAK,GAC5B,CACT,CAEA,GAAI,EAAS,QAAQ,CAAC,gBAAkB,EAAS,QAAQ,CAAC,UAAW,CACnE,IAAM,EAAS,IAAI,KAAK,GAClB,EAAkB,CAAC,EAAI,EAAM,MAAM,IAAK,CAAC,CAAI,EAEnD,OADA,EAAO,OAAO,CAAC,EAAM,OAAO,IAA0B,CAArB,GAAC,EAAwB,EAAI,CAAA,CAAe,EACtE,CACT,CAGA,IAAM,EAAS,IAAI,KAAK,UACxB,AAAK,IAAD,EAAO,EAAO,OAAO,IAIlB,CAJuB,IACrB,CAIX,CAEQ,cAAc,CAAmB,CAAU,CACjD,IAAM,EAAQ,EAAY,KAAK,CAAC,kCAChC,GAAI,EAAO,CACT,IAAM,EAAQ,SAAS,CAAK,CAAC,EAAE,EAE/B,OADa,AACN,CADW,CAAC,EAAE,CAAC,WAAW,GACrB,UAAU,CAAC,QAAkB,GAAR,EAAa,CAChD,CACA,OAAO,EACT,CADY,AAIZ,qBAAqB,AAJY,CAIY,CAAY,CACvD,IAAM,EAAwB,EAAE,CA2BhC,OAzBI,GAAS,cAAgB,aAC3B,AADwC,EAC5B,IAAI,CACd,wBACA,gBACA,mBACA,uBAIA,GAAS,cAAgB,WAAW,AACtC,EAAY,IAAI,CACd,oBACA,uBACA,qBAIA,GAAS,eAAe,OAAS,EAAQ,aAAa,CAAC,KAAK,CAAC,MAAM,CAAG,GAAG,AAC3E,EAAY,IAAI,CAAC,iBAGf,GAAS,eAAe,QAAU,EAAQ,aAAa,CAAC,MAAM,CAAC,MAAM,CAAG,GAC1E,AAD6E,EACjE,IAAI,CAAC,kBAGZ,EAAY,KAAK,CAAC,EAAG,EAC9B,CADiC,AAEnC,CAGA,IAAI,EAA4C,KAEzC,SAAS,IAId,EAX4D,KAQxD,AAAC,IACH,EAAgB,IAAI,CAAA,EAEf,CACT,CAJsB,ALlXf,MAAM,EACH,UAAwB,EAAE,CAC1B,MAAc,AAEtB,aAAY,CAAc,CAAE,CAC1B,IAAI,CAAC,MAAM,CAAG,CAChB,CAEA,MAAM,YAA4B,CAChC,GAAI,CACF,IAAI,CAAC,SAAS,CAAG,MAAM,CAAA,EAAA,EAAA,YAAA,AAAY,EAAC,IAAI,CAAC,MAAM,CACjD,CAAE,MAAO,EAAO,CACd,QAAQ,KAAK,CAAC,uCAAwC,GACtD,IAAI,CAAC,SAAS,CAAG,EAAE,AACrB,CACF,CAEA,MAAM,OAAO,CAAa,CAAE,EAIxB,CAAC,CAAC,CAAmC,CACvC,GAAM,OAAE,EAAQ,EAAE,CAAE,OAAK,MAAE,CAAI,CAAE,CAAG,EAEpC,GAAI,CAAC,EAAM,IAAI,GACb,CADiB,KACV,EAAE,AAImB,GAAG,EAA7B,IAAI,CAAC,SAAS,CAAC,MAAM,EACvB,MAAM,IAAI,CAAC,UAAU,GAGvB,IAAM,EAAa,EAAM,WAAW,GAC9B,EAAkC,EAAE,CAE1C,IAAK,IAAM,KAAY,IAAI,CAAC,SAAS,CAAE,CAErC,GAAI,GAAS,EAAM,MAAM,CAAG,GAAK,CAAC,EAAM,QAAQ,CAAC,EAAS,IAAI,EAC5D,CAD+D,QAKjE,GAAI,GAAQ,EAAK,MAAM,CAAG,EAAG,CAC3B,IAAM,EAAkB,EAAS,OAAO,EAAI,GAC5C,GAAI,CAAC,EAAK,IAAI,CAAC,GAAO,EAAgB,WAAW,GAAG,QAAQ,CAAC,EAAI,WAAW,KAC1E,CADgF,OAGpF,CAEA,IAAI,EAAiB,EACjB,EAAU,GAGV,EAAS,KAAK,CAAC,WAAW,GAAG,QAAQ,CAAC,KACxC,GAAkB,GAClB,EAFqD,AAE3C,IAAI,CAAC,cAAc,CAAC,EAAS,KAAK,CAAE,IAI5C,EAAS,OAAO,EAAI,EAAS,OAAO,CAAC,WAAW,GAAG,QAAQ,CAAC,KAC9D,GAAkB,EACd,AAAC,GAFsE,CAGzE,EAAU,GADE,CACE,CAAC,cAAc,CAAC,EAAS,OAAO,CAAE,EAAA,GAKhD,EAAS,OAAO,EAAI,EAAS,OAAO,CAAC,WAAW,GAAG,QAAQ,CAAC,KAC9D,GAAkB,EACd,AAAC,GACH,AAHyE,GAG/D,CAAC,EADC,OACQ,EAAE,EAAS,OAAO,CAAA,CAAA,AAAE,GAIxC,EAAS,KAAK,CAAC,WAAW,KAAO,IACnC,GAAkB,EAAA,EAGhB,CAJ6C,CAI5B,GAAG,AACtB,EAAQ,IAAI,CAAC,CACX,GAAI,EAAS,EAAE,CACf,KAAM,EAAS,KAAK,CACpB,KAAM,EAAS,IAAI,CACnB,QAAS,EAAS,OAAO,EAAI,GAC7B,KAAM,CAAC,EAAS,OAAO,CAAC,gBACxB,EACA,QAAS,GAAW,EAAS,KAC/B,AADoC,EAGxC,CAKA,OAFA,EAAQ,IAAI,CAAC,CAAC,EAAG,IAAM,EAAE,cAAc,CAAG,EAAE,cAAc,EAEnD,EAAQ,KAAK,CAAC,EAAG,EAC1B,CAEQ,eAAe,CAAY,CAAE,CAAa,CAAE,EAAwB,EAAE,CAAU,CACtF,IAAM,EAAQ,EAAK,WAAW,GAAG,OAAO,CAAC,GACzC,GAAc,CAAC,IAAX,EAAc,OAAO,EAAK,SAAS,CAAC,EAAG,GAAiB,MAE5D,IAAM,EAAQ,KAAK,GAAG,CAAC,EAAG,EAAQ,EAAgB,GAC5C,EAAM,KAAK,GAAG,CAAC,EAAK,MAAM,CAAE,EAAQ,EAAM,MAAM,CAAG,EAAgB,GAErE,EAAU,EAAK,SAAS,CAAC,EAAO,GAIpC,OAHI,EAAQ,IAAG,EAAU,MAAQ,CAAA,EAC7B,EAAM,EAAK,MAAM,GAAE,GAAoB,KAAA,EAAV,AAE1B,CACT,CAEA,mBAA8B,CAE5B,OAAO,MAAM,IAAI,CADH,AACI,IADA,IAAI,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,GAAK,EAAE,IAAI,GAEtD,CAEA,kBAA6B,CAC3B,IAAM,EAAO,IAAI,IAMjB,OALA,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,IACjB,EAAS,OAAO,EAAE,AACpB,EAAK,GAAG,CAAC,EAAS,OAAO,CAE7B,GACO,MAAM,IAAI,CAAC,EACpB,CAEA,kBAA2B,CACzB,OAAO,IAAI,CAAC,SAAS,CAAC,MAAM,AAC9B,CACF,CAGA,IAAI,EAA2D,IC3HxD,OAAM,EACH,gBAA+C,IAAI,GAAK,CAC/C,YAAc,CAE7B,cAAe,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,IAAI,EACxC,gBAAiB,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,IAAI,EAC5C,YAAa,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,IAAI,EAGrC,cAAe,IAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,IAAI,EAG/C,iBAAkB,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,IAAI,EAC9C,aAAc,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,IAAI,EAGvC,cAAe,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,IAAI,EAG3C,kBAAmB,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,IAAI,EAGjD,kBAAmB,IAAI,CAAC,mBAAmB,CAAC,IAAI,CAAC,IAAI,EAGrD,iBAAkB,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,IAAI,EAG9C,cAAe,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,IAAI,EAC7C,qBAAsB,IAAI,CAAC,wBAAwB,CAAC,IAAI,CAAC,IAAI,EAG7D,yBAA4B,IAAI,CAAC,sBAAsB,CAAC,IAAI,CAAC,IAAI,EACjE,wBAA2B,IAAI,CAAC,qBAAqB,CAAC,IAAI,CAAC,IAAI,EAC/D,qBAAwB,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,IAAI,EACzD,kBAAqB,IAAI,CAAC,qBAAqB,CAAC,IAAI,CAAC,IAAI,EACzD,eAAkB,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,IAAI,EAC9C,iBAAoB,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI,EACjD,iBAAoB,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI,EACjD,eAAkB,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,IAAI,EAC9C,cAAiB,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,IAAI,CAC9C,CAEA,AAFC,OAEK,eAAe,CAAsB,CAAE,CAAuB,CAA4B,CAC9F,IAAM,EAAY,CAAC,IAAI,EAAE,KAAK,GAAG,GAAG,CAAC,EAAE,KAAK,MAAM,GAAG,QAAQ,CAAC,IAAI,MAAM,CAAC,EAAG,GAAA,CAAI,QAEhF,AAAI,EAAQ,SAAS,EAAI,EAAQ,KAAK,CAC7B,CAD+B,GAC3B,CAAC,uBAAuB,CAAC,EAAW,EAAS,GAEjD,IAAI,CAAC,oBAAoB,CAAC,EAAS,EAE9C,CAEA,MAAc,qBAAqB,CAAsB,CAAE,CAAuB,CAA4B,CAC5G,IAAM,EAAS,IAAI,CAAC,WAAW,CAAC,EAAQ,MAAM,CAAkC,CAEhF,GAAI,CAAC,EACH,MAAO,AADI,CAET,SAAS,EACT,QAAS,CAAC,4BAA4B,EAAE,EAAQ,MAAM,CAAC,eAAe,CAAC,AACzE,EAGF,GAAI,CACF,OAAO,MAAM,EAAO,EAAQ,QAAQ,CAAE,EACxC,CAAE,MAAO,EAAO,CAEd,OADA,QAAQ,KAAK,CAAC,2BAA4B,GACnC,CACL,SAAS,EACT,QAAS,CAAC,6EAA6E,CACzF,AAD0F,CAE5F,CACF,CAEA,MAAc,wBAAwB,CAAiB,CAAE,CAAsB,CAAE,CAAuB,CAA4B,CAClI,GAAI,CAAC,EAAQ,KAAK,CAChB,CADkB,KACX,CAAE,SAAS,EAAO,QAAS,yCAA0C,EAG9E,IAAM,EAAwB,WAC5B,EACA,YAAa,EACb,WAAY,EAAQ,KAAK,CAAC,MAAM,CAChC,QAAS,CAAC,EACV,OAAQ,SACV,EAEA,IAAI,CAAC,eAAe,CAAC,GAAG,CAAC,EAAW,GAEpC,GAAI,CACF,IAAK,IAAI,EAAI,EAAG,EAAI,EAAQ,KAAK,CAAC,MAAM,CAAE,IAAK,CAC7C,IAAM,EAAO,EAAQ,KAAK,CAAC,EAAE,CAI7B,GAHA,EAAM,WAAW,CAAG,EAGhB,EAAK,SAAS,CAAE,CAClB,IAAM,EAAc,EAAK,SAAS,CAAC,MAAM,CAAC,GAAO,CAAC,EAAM,OAAO,CAAC,EAAI,EACpE,GAAI,EAAY,MAAM,CAAG,EAAG,CAC1B,EAAM,MAAM,CAAG,SACf,EAAM,KAAK,CAAG,CAAC,sBAAsB,EAAE,EAAY,IAAI,CAAC,MAAA,CAAO,CAC/D,KACF,CACF,CAGA,IAAM,EAAa,MAAM,IAAI,CAAC,WAAW,CAAC,EAAM,EAAM,OAAO,CAAE,GAE/D,GAAI,CAAC,EAAW,OAAO,CAAE,CACvB,EAAM,MAAM,CAAG,SACf,EAAM,KAAK,CAAG,EAAW,OAAO,CAChC,KACF,CAKA,GAHA,EAAM,OAAO,CAAC,EAAK,EAAE,CAAC,CAAG,EAAW,IAAI,CAGpC,EAAW,iBAAiB,CAE9B,CAFgC,MAChC,EAAM,MAAM,CAAG,UACR,CACL,SAAS,EACT,QAAS,EAAW,eAAe,EAAI,wCACvC,mBAAmB,EACnB,SAAU,EAAK,EAAE,AACnB,CAEJ,CAGA,OADA,EAAM,MAAM,CAAG,YACR,CACL,SAAS,EACT,QAAS,IAAI,CAAC,yBAAyB,CAAC,EAAS,EAAM,OAAO,EAC9D,KAAM,EAAM,OAAO,AACrB,CAEF,CAAE,MAAO,EAAO,CAGd,OAFA,EAAM,MAAM,CAAG,SACf,EAAM,KAAK,CAAG,aAAiB,MAAQ,EAAM,OAAO,CAAG,gBAChD,CACL,SAAS,EACT,QAAS,6CACX,CACF,CACF,CAEA,MAAc,YAAY,CAAiB,CAAE,CAAoC,CAAE,CAAuB,CAA4B,CAEpI,IAAM,EAAS,IAAI,CAAC,wBAAwB,CAAC,EAAK,MAAM,CAAE,GAEpD,EAAS,IAAI,CAAC,WAAW,CAAC,EAAK,MAAM,CAAkC,QAExE,AAAL,EAOO,EAPH,IAAS,AAOA,EAAO,EAAQ,GANnB,CACL,SAAS,EACT,QAAS,CAAC,gBAAgB,EAAE,EAAK,MAAM,CAAA,CAAE,AAC3C,CAIJ,CAEQ,yBAAyB,CAA2B,CAAE,CAA4B,CAAuB,CAC/G,IAAM,EAAW,CAAE,GAAG,CAAM,AAAC,EAE7B,IAAK,GAAM,CAAC,EAAK,EAAM,GAAI,OAAO,OAAO,CAAC,GACxC,GAAI,AAAiB,IAD8B,aACxC,GAAsB,EAAM,UAAU,CAAC,OAAS,EAAM,QAAQ,CAAC,MAAO,CAE/E,GAAM,CAAC,EAAW,EAAS,CADP,AACU,EADJ,KAAK,CAAC,EAAG,CAAC,GACM,KAAK,CAAC,KAE5C,CAAO,CAAC,EAAU,EAAE,CACtB,CAAQ,CAAC,EAAI,CAAG,EAAW,CAAO,CAAC,EAAU,CAAC,EAAS,CAAG,CAAO,CAAC,EAAA,AAAU,CAEhF,CAGF,OAAO,CACT,CAIA,MAAc,WAAW,CAA6B,CAAE,CAAuB,CAA4B,CACzG,GAAI,CACF,IAAM,EAAW,CACf,OAAQ,EAAQ,MAAM,CACtB,MAAO,EAAS,KAAK,CACrB,YAAa,EAAS,WAAW,EAAI,GACrC,SAAU,EAAS,QAAQ,EAAI,SAC/B,OAAQ,OACR,QAAS,EAAS,OAAO,CACzB,OAAQ,EAAS,MAAM,CACvB,iBAAkB,EAAS,QAAQ,EAAI,GACvC,KAAM,EAAS,IAAI,EAAI,EAAE,CACzB,SAAU,EAAE,CACZ,MAAO,EAAE,AACX,EAEM,EAAS,MAAM,CAAA,EAAA,EAAA,UAAA,AAAU,EAAC,GAEhC,MAAO,CACL,SAAS,EACT,QAAS,CAAC,cAAc,EAAE,EAAS,KAAK,CAAC,CAAC,EAAE,EAAS,OAAO,CAAG,CAAC,KAAK,EAAE,EAAS,OAAO,CAAC,kBAAkB,GAAA,CAAI,CAAG,GAAA,CAAI,CACrH,KAAM,QAAE,CAAO,CACjB,CACF,CAAE,MAAO,EAAO,CACd,MAAO,CACL,SAAS,EACT,QAAS,0CACX,CACF,CACF,CAEA,MAAc,aAAa,CAA6B,CAAE,CAAuB,CAA4B,CAC3G,GAAI,CAEF,IAAM,EAAO,CADC,MAAM,CAAA,EAAA,EAAA,QAAQ,AAAR,EAAS,EAAQ,OAAM,EACxB,IAAI,CAAC,GAAK,EAAE,KAAK,CAAC,WAAW,GAAG,QAAQ,CAAC,EAAS,QAAQ,CAAC,WAAW,KAEzF,GAAI,CAAC,EACH,IADS,EACF,CACL,QAAS,GACT,QAAS,CAAC,8BAA8B,EAAE,EAAS,QAAQ,CAAC,8BAA8B,CAAC,AAC7F,EAKF,OAFA,MAAM,CAAA,EAAA,EAAA,UAAA,AAAU,EAAC,EAAK,EAAE,CAAE,CAAE,OAAQ,OAAQ,YAAa,IAAI,IAAO,GAE7D,CACL,SAAS,EACT,QAAS,CAAC,QAAQ,EAAE,EAAK,KAAK,CAAC,6BAA6B,CAAC,CAC7D,KAAM,CAAE,OAAQ,EAAK,EAAE,AAAC,CAC1B,CACF,CAAE,MAAO,EAAO,CACd,MAAO,CACL,QAAS,GACT,QAAS,4CACX,CACF,CACF,CAEA,MAAc,UAAU,CAA6B,CAAE,CAAuB,CAA4B,CACxG,GAAI,CAEF,IAAI,EADU,MAAM,CAAA,EAAA,EAAA,GACA,KADA,AAAQ,EAAC,EAAQ,MAAM,EAG3C,GAAI,EAAS,MAAM,EAAE,CACf,EAAS,MAAM,CAAC,MAAM,EAAE,CAC1B,EAAgB,EAAc,MAAM,CAAC,GAAK,EAAE,MAAM,EAAE,cAAc,SAAS,EAAS,MAAM,CAAC,MAAM,CAAC,WAAW,IAAA,EAE3G,EAAS,MAAM,CAAC,OAAO,EAAE,CAC3B,IAAM,EAAa,IAAI,KAAK,EAAS,MAAM,CAAC,OAAO,EACnD,EAAgB,EAAc,MAAM,CAAC,GAAK,EAAE,OAAO,EAAI,IAAI,KAAK,EAAE,OAAO,GAAK,EAChF,CAGF,IAAM,EAAe,EAAc,MAAM,CAAC,GAAkB,SAAb,EAAE,MAAM,EAEvD,GAA4B,GAAG,CAA3B,EAAa,MAAM,CACrB,MAAO,CACL,SAAS,EACT,QAAS,gCACT,KAAM,CAAE,MAAO,EAAE,AAAC,CACpB,EAGF,IAAM,EAAW,EAAa,KAAK,CAAC,EAAG,GAAG,GAAG,CAAC,GAAK,CAAC,EAAE,EAAE,EAAE,KAAK,CAAA,EAAG,EAAE,OAAO,CAAG,CAAC,MAAM,EAAE,IAAI,KAAK,EAAE,OAAO,EAAE,kBAAkB,GAAG,CAAC,CAAC,CAAG,GAAA,CAAI,EAAE,IAAI,CAAC,MAEhJ,MAAO,CACL,SAAS,EACT,QAAS,CAAC,cAAc,EAAE,EAAS,MAAM,CAAG,YAAc,GAAG;AAAQ,EAAE,EAAA,EAAW,EAAa,MAAM,CAAG,EAAI,CAAC;AAAA,OAAS,EAAE,EAAa,MAAM,CAAG,EAAE,KAAK,CAAC,CAAG,GAAA,CAAI,CAC7J,KAAM,CAAE,MAAO,CAAa,CAC9B,CACF,CAAE,MAAO,EAAO,CACd,MAAO,CACL,SAAS,EACT,QAAS,6CACX,CACF,CACF,CAEA,MAAc,kBAAkB,CAA6B,CAAE,CAAuB,CAA4B,CAEhH,MAAO,CACL,SAAS,EACT,QAAS,CAAC,WAAW,EAAE,EAAS,QAAQ,EAAI,GAAG,qBAAqB,EAAE,EAAS,IAAI,CAAG,CAAC,MAAM,EAAE,EAAS,IAAI,CAAC,CAAC,CAAC,CAAG,GAAG,0BAA0B,CAAC,CAChJ,KAAM,CAAE,SAAU,EAAS,QAAQ,EAAI,GAAI,KAAM,EAAS,IAAI,AAAC,CACjE,CACF,CAEA,MAAc,cAAc,CAA6B,CAAE,CAAuB,CAA4B,CAC5G,GAAI,CAEF,IAAM,EAAQ,CADC,MAAM,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,EAAQ,OAAM,EACxB,IAAI,CAAC,GAAK,EAAE,IAAI,CAAC,WAAW,GAAG,QAAQ,CAAC,EAAS,SAAS,CAAC,WAAW,KAE3F,GAAI,CAAC,EACH,KADU,CACH,CACL,SAAS,EACT,QAAS,CAAC,+BAA+B,EAAE,EAAS,SAAS,CAAC,8BAA8B,CAAC,AAC/F,EAKF,OAFA,MAAM,CAAA,EAAA,EAAA,qBAAA,AAAqB,EAAC,EAAM,EAAE,CAAE,IAAI,OAAO,WAAW,GAAG,KAAK,CAAC,IAAI,CAAC,EAAE,EAErE,CACL,SAAS,EACT,QAAS,CAAC,WAAW,EAAE,EAAM,IAAI,CAAC,uCAAuC,CAAC,CAC1E,KAAM,CAAE,QAAS,EAAM,EAAE,AAAC,CAC5B,CACF,CAAE,MAAO,EAAO,CACd,MAAO,CACL,SAAS,EACT,QAAS,6CACX,CACF,CACF,CAEA,MAAc,WAAW,CAA6B,CAAE,CAAuB,CAA4B,CACzG,GAAI,CACF,IAAM,EAAS,MAAM,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,EAAQ,MAAM,EACvC,EAAQ,IAAI,OAAO,WAAW,GAAG,KAAK,CAAC,IAAI,CAAC,EAAE,CAE9C,EAAc,EAAO,GAAG,CAAC,IAC7B,IAAM,EAAiB,EAAE,WAAW,CAAC,IAAI,CAAC,GAAK,EAAE,IAAI,GAAK,GAAS,EAAE,SAAS,EAC9E,MAAO,CAAC,EAAE,EAAE,EAAE,IAAI,CAAC,EAAE,EAAE,EAAiB,SAAW,YAAY,EAAE,EAAE,EAAE,aAAa,CAAC,YAAY,CAAC,AAClG,GAAG,IAAI,CAAC,MAER,MAAO,CACL,SAAS,EACT,QAAS,CAAC;AAA2B,EAAE,EAAA,CAAa,CACpD,KAAM,QAAE,CAAO,CACjB,CACF,CAAE,MAAO,EAAO,CACd,MAAO,CACL,SAAS,EACT,QAAS,8CACX,CACF,CACF,CAEA,MAAc,cAAc,CAA6B,CAAE,CAAuB,CAA4B,CAC5G,GAAI,CAEF,IAAM,EAAS,CADC,MAAM,CAAA,EAAA,EAAA,UAAU,AAAV,EAAW,EAAQ,OAAM,EACxB,IAAI,CAAC,GAAK,EAAE,IAAI,CAAC,WAAW,GAAG,QAAQ,CAAC,EAAS,UAAU,CAAC,WAAW,KAE9F,GAAI,CAAC,EACH,MADW,AACJ,CACL,SAAS,EACT,QAAS,CAAC,gCAAgC,EAAE,EAAS,UAAU,CAAC,EAAE,CAAC,AACrE,EAGF,IAAM,EAAO,CAAC,QAAQ,EAAE,EAAO,IAAI,CAAA,EAAG,EAAO,IAAI,CAAG,CAAC,EAAE,EAAE,EAAO,IAAI,CAAC,CAAC,CAAC,CAAG,GAAA,EAAK,EAAO,SAAS,CAAG,CAAC;AAAA,WAAa,EAAE,EAAO,SAAS,CAAA,CAAE,CAAG,GAAA,EAAK,EAAO,QAAQ,CAAG,CAAC;AAAA,WAAa,EAAE,IAAI,KAAK,EAAO,QAAQ,EAAE,kBAAkB,GAAA,CAAI,CAAG,GAAA,CAAI,CAErO,MAAO,CACL,SAAS,EACT,QAAS,EACT,KAAM,QAAE,CAAO,CACjB,CACF,CAAE,MAAO,EAAO,CACd,MAAO,CACL,SAAS,EACT,QAAS,wCACX,CACF,CACF,CAEA,MAAc,gBAAgB,CAA6B,CAAE,CAAuB,CAA4B,CAC9G,GAAI,OACF,IAAM,GDhPiC,ECgPgB,EAAQ,EDhPV,ICgPgB,CD/OrE,AAAC,GAA0B,EAAuB,CC+OxB,KD/OiC,GAAK,IAClE,EAAyB,EADiD,EAC7C,CADsB,CACI,EAAA,EAElD,EC6OH,OAAM,EAAkB,UAAU,GAElC,IAAM,EAAQ,EAAS,KAAK,EAAI,EAAS,KAAK,EAAI,GAC5C,EAAU,MAAM,EAAkB,MAAM,CAAC,EAAO,CACpD,MAAO,EACP,MAAO,EAAS,IAAI,CAAG,CAAC,EAAS,IAAI,CAAC,MAAG,EACzC,KAAM,EAAS,IAAI,CAAG,EAAS,IAAI,CAAC,KAAK,CAAC,KAAK,GAAG,CAAC,AAAC,GAAc,EAAE,IAAI,SAAM,CAChF,GAEA,GAAuB,GAAG,CAAtB,EAAQ,MAAM,CAChB,MAAO,CACL,SAAS,EACT,QAAS,CAAC,0CAA0C,EAAE,EAAM,GAAG,EAAE,EAAkB,gBAAgB,GAAK,EAAI,uDAAyD,0CAAA,CAA4C,AACnN,EAGF,IAAM,EAAe,EAAQ,GAAG,CAAC,GAC/B,CAAC,EAAE,EAAE,EAAE,IAAI,CAAC,EAAE,EAAE,EAAE,IAAI,CAAC,IAAI,EAAE,EAAE,OAAO,CAAA,CAAE,EACxC,IAAI,CAAC,MAEP,MAAO,CACL,SAAS,EACT,QAAS,CAAC,MAAM,EAAE,EAAQ,MAAM,CAAC,SAAS,EAAE,EAAQ,MAAM,CAAG,EAAI,IAAM,GAAG,aAAa,EAAE,EAAM;AAAI,EAAE,EAAA,CAAc,CACnH,KAAM,CAAE,UAAW,CAAQ,CAC7B,CACF,CAAE,MAAO,EAAO,CAEd,OADA,QAAQ,KAAK,CAAC,yBAA0B,GACjC,CACL,SAAS,EACT,QAAS,+CACX,CACF,CACF,CAEA,MAAc,oBAAoB,CAA6B,CAAE,CAAuB,CAA4B,CAClH,GAAI,CACF,IAAM,EAAY,CAChB,OAAQ,EAAQ,MAAM,CACtB,MAAO,EAAS,KAAK,CACrB,KAAM,UACN,UAAW,EAAS,QAAQ,EAAI,IAAI,KACpC,QAAS,IAAI,KAAK,CAAC,EAAS,QAAQ,EAAI,IAAI,IAAA,CAAM,CAAE,OAAO,GAAK,KAAK,CACrE,IAD0E,MAChE,EACV,aAAa,EACb,YAAa,EAAS,WAAW,EAAI,GACrC,MAAO,SACT,EAEM,EAAU,MAAM,CAAA,EAAA,EAAA,mBAAA,AAAmB,EAAC,GAE1C,MAAO,CACL,SAAS,EACT,QAAS,CAAC,WAAW,EAAE,EAAS,KAAK,CAAC,MAAM,EAAE,EAAS,QAAQ,EAAE,kBAAoB,MAAA,CAAO,CAC5F,KAAM,SAAE,CAAQ,CAClB,CACF,CAAE,MAAO,EAAO,CACd,MAAO,CACL,SAAS,EACT,QAAS,2BACX,CACF,CACF,CAEA,MAAc,cAAc,CAA6B,CAAE,CAAuB,CAA4B,CAC5G,GAAI,CACF,IAAM,EAAQ,IAAI,OAAO,WAAW,GAAG,KAAK,CAAC,IAAI,CAAC,EAAE,CAC9C,EAAa,MAAM,CAAA,EAAA,EAAA,aAAA,AAAa,EAAC,EAAQ,MAAM,CAAE,GAEvD,GAAI,CAAC,EACH,MAAO,CACL,GAFa,MAEJ,EACT,QAAS,qEACT,KAAM,CAAE,MAAO,IAAK,CACtB,EAGF,IAAM,EAAU,CAAC,AACd,mBADiC;eAClB,EAAE,KAAK,KAAK,CAAC,EAAW,iBAAiB,CAAG,GAAK,IAAM,GACtE,AADyE,GAAG,CAAC,GAC9E;AAAC,mBAAmB,EAAE,EAAW,aAAa,CAAC,EAAE,CAAC,GAClD;AAAC,sBAAsB,EAAE,EAAW,iBAAiB,CAAC,EAAE,CAAC,GACzD;AAAC,mBAAmB,EAAE,EAAW,SAAS,CAAC,KAAK,CAJb,AAIc,CAEnD,EALE,IAKK,CACL,SAAS,UACT,EACA,KAAM,CAAE,MAAO,CAAW,CAC5B,CACF,CAAE,MAAO,EAAO,CACd,MAAO,CACL,QAAS,GACT,QAAS,+BACX,CACF,CACF,CAGA,MAAc,gBAAgB,CAA6B,CAAE,CAAuB,CAA4B,CAE9G,MAAO,CACL,SAAS,EACT,QAAS,kCACT,KAAM,CAAE,SAAU,EAAS,QAAQ,CAAE,KAAM,EAAS,IAAI,AAAC,CAC3D,CACF,CAEA,MAAc,yBAAyB,CAA6B,CAAE,CAAuB,CAA4B,CAEvH,MAAO,CACL,SAAS,EACT,QAAS,qCACT,KAAM,CAAE,SAAU,EAAS,QAAQ,AAAC,CACtC,CACF,CAGA,MAAc,uBAAuB,CAA6B,CAAE,CAAuB,CAA4B,CACrH,GAAI,CAEF,IAAM,EAAS,CADC,MAAM,CAAA,EAAA,EAAA,UAAU,AAAV,EAAW,EAAQ,OAAM,EACxB,IAAI,CAAC,GAAK,EAAE,IAAI,CAAC,WAAW,GAAG,QAAQ,CAAC,EAAS,QAAQ,CAAC,WAAW,KAE5F,MAAO,CACL,SAAS,EACT,QAAS,4BACT,KAAM,CAAE,SAAQ,UAAW,GAAQ,UAAY,EAAE,AAAC,CACpD,CACF,CAAE,MAAO,EAAO,CACd,MAAO,CAAE,SAAS,EAAO,QAAS,oCAAqC,CACzE,CACF,CAEA,MAAc,sBAAsB,CAA6B,CAAE,CAAuB,CAA4B,CACpH,GAAI,CAEF,IAAM,EAAc,CADN,MAAM,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,EAAQ,OAAM,EACjB,MAAM,CAAC,GAAK,EAAE,MAAM,EAAE,cAAc,SAAS,EAAS,MAAM,CAAC,WAAW,KAC5F,EAAiB,EAAY,MAAM,CAAC,GAAkB,SAAb,EAAE,MAAM,EAEvD,MAAO,CACL,SAAS,EACT,QAAS,4BACT,KAAM,CAAE,UAAW,EAAe,MAAM,CAAE,MAAO,EAAY,MAAM,CAAE,SAAU,EAAe,MAAM,CAAG,EAAY,MAAM,AAAC,CAC5H,CACF,CAAE,MAAO,EAAO,CACd,MAAO,CAAE,SAAS,EAAO,QAAS,mCAAoC,CACxE,CACF,CAEA,MAAc,mBAAmB,CAA6B,CAAE,CAAuB,CAA4B,CACjH,IAAM,EAAiB,KAAK,GAAG,CAAiB,EAAhB,EAAS,IAAI,CAAM,IAEnD,AAFuD,MAEhD,CACL,QAAS,GACT,QAAS,cAJoF,gBAK7F,KAAM,gBAAE,EAAgB,WAAY,EAAiB,EAAS,IAAI,AAAC,CACrE,CACF,CAEA,MAAc,sBAAsB,CAA6B,CAAE,CAAuB,CAA4B,CACpH,GAAI,CAEF,IAAM,EAAO,CACX,GAAI,CAAC,KAAK,EAAE,KAAK,GAAG,GAAA,CAAI,CACxB,SAAU,EAAS,MAAM,CACzB,KAAM,EAAS,IAAI,CACnB,WAAY,KAAK,IAAI,CAAC,GAAK,EAAS,IAAI,EACxC,WAAY,CAAC,eAAgB,oBAAqB,cAAe,eAAe,AAClF,EAEA,MAAO,CACL,SAAS,EACT,QAAS,uBACT,KAAM,MAAE,EAAM,OAAQ,CAAC,KAAK,EAAE,KAAK,GAAG,GAAA,CAAI,AAAC,CAC7C,CACF,CAAE,MAAO,EAAO,CACd,MAAO,CAAE,SAAS,EAAO,QAAS,+BAAgC,CACpE,CACF,CAEA,MAAc,cAAc,CAA6B,CAAE,CAAuB,CAA4B,CAE5G,MAAO,CACL,SAAS,EACT,QAAS,wBACT,KAAM,CAAE,UAAW,CAAE,CACvB,CADyB,AAE3B,CAEA,MAAc,OAJ2B,QAIZ,CAA6B,CAAE,CAAuB,CAA4B,CAC7G,MAAO,CACL,QAAS,GACT,QAAS,wEACT,KAAM,CAAE,WAAW,CAAK,CAC1B,CACF,CAEA,MAAc,eAAe,CAA6B,CAAE,CAAuB,CAA4B,CAC7G,GAAI,CAEF,IAAM,EAAe,CADP,MAAM,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,EAAQ,OAAM,EAChB,MAAM,CAAC,GAAkB,SAAb,EAAE,MAAM,EAAa,IAAI,CAAC,CAAC,EAAG,KACnE,IAAM,EAAgB,CAAE,OAAQ,EAAG,KAAM,EAAG,OAAQ,EAAG,IAAK,CAAE,EAC9D,OAAO,CAAa,CAAC,EAAE,QAAQ,CAAC,CAAG,CAAa,CAAC,EAAE,QAAQ,CAAC,AAC9D,GAEA,GAA4B,AAAxB,GAA2B,GAAd,MAAM,CACrB,MAAO,CACL,SAAS,EACT,QAAS,yBACT,KAAM,CAAE,KAAM,IAAK,CACrB,EAGF,MAAO,CACL,SAAS,EACT,QAAS,CAAC,WAAW,EAAE,CAAY,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC,CAAC,CAC/C,KAAM,CAAE,KAAM,CAAY,CAAC,EAAG,AAAD,EAC7B,mBAAmB,EACnB,gBAAiB,CAAC,2BAA2B,EAAE,CAAY,CAAC,EAAE,CAAC,KAAK,CAAC,6BAA6B,CAAC,AACrG,CACF,CAAE,MAAO,EAAO,CACd,MAAO,CAAE,SAAS,EAAO,QAAS,uBAAwB,CAC5D,CACF,CAEA,MAAc,cAAc,CAA6B,CAAE,CAAuB,CAA4B,CAC5G,MAAO,CACL,QAAS,GACT,QAAS,CAAC,SAAS,EAAE,EAAS,QAAQ,CAAC,0BAA0B,EAAE,EAAS,MAAM,EAAE,OAAS,gBAAgB,CAAC,CAAC,CAC/G,KAAM,CAAE,UAAW,CAAC,QAAQ,EAAE,KAAK,GAAG,GAAA,CAAI,CAAE,SAAU,EAAS,QAAQ,AAAC,CAC1E,CACF,CAEA,MAAc,aAAa,CAA6B,CAAE,CAAuB,CAA4B,CAC3G,MAAO,CACL,SAAS,EACT,QAAS,qDACT,KAAM,CAAE,UAAU,CAAK,CACzB,CACF,CAEQ,0BAA0B,CAAsB,CAAE,CAA4B,CAAU,CAC9F,OAAQ,EAAQ,MAAM,EACpB,IAAK,cACH,MAAO,CAAC,qCAAqC,EAAE,EAAQ,cAAc,EAAE,WAAa,EAAE,qBAAqB,EAAE,EAAQ,QAAQ,CAAC,IAAI,CAAC,sCAAsC,CAE3K,AAF4K,KAEvK,qBACH,MAAO,CAAC,iCAAiC,EAAE,EAAQ,QAAQ,CAAC,QAAQ,CAAC,gDAAgD,CAAC,AAExH,SACE,MAAO,mCACX,CACF,CAGA,kBAAkB,CAAiB,CAAyB,CAC1D,OAAO,IAAI,CAAC,eAAe,CAAC,GAAG,CAAC,IAAc,IAChD,CAEA,gBAAgB,CAAiB,CAAQ,CACvC,IAAM,EAAQ,IAAI,CAAC,eAAe,CAAC,GAAG,CAAC,GACnC,IACF,EAAM,CADG,KACG,CAAG,SACf,EAAM,KAAK,CAAG,oBAElB,CACF,CAGA,IAAI,EAAgD,KC3nBpD,IAAA,EAAA,EAAA,CAAA,CAAA,OAYA,EAAA,EAAA,CAAA,CAAA,wCErB8B,OAAQ,CAAA,GDAM,CAAA,uFCEe,yCACb,CAAA,ADAK,CAAA,ACAL,CAAA,ADAK,CAAA,ACAL,UAAe,CAAA,qDACD,CAC3D,EDLK,CCAA,ADAA,CCAA,ADAA,CCAA,ADAA,CCAA,ADAA,CCAA,ADAA,AAAU,CCAV,ADAA,CAAU,OAAA,EAAiB,GCAK,CAAA,MDAM,CAAA,AAC1C,QAAS,CCAA,ADAA,AAAE,EAAA,iBAAsB,QAAA,CAAU,ACAA,CDAA,CCAA,ADAA,AAC3C,CAAC,CAAA,ACAA,CDAA,ACAA,CAAA,ADAA,CCAA,ADAA,CCAA,ADAA,CCAQ,ADAA,CCAA,ADAA,CCAA,ADAA,AAAE,EAAG,CCA4B,ADAC,CCAD,ADAC,CCAD,ADAC,CCAD,ADAC,CCAD,ADAC,CAAA,ACAD,CDAC,ACAD,CAAA,ADAC,CCAD,ADAC,CCAD,ADAC,CCAD,ADAC,CCAD,ADAC,CCAD,ADAC,CCAD,ADAC,CAAA,ACAD,CAAA,ADAC,CCAD,ADAC,CCAD,ADAC,CCAD,ADAC,CCAD,ADAC,CAAA,ACAD,CDAC,ACAD,CAAA,ADAC,CCAD,ADAC,CCAD,ADAC,CCAD,ADAC,CCAD,ADAC,CAAA,CCAD,ADAC,CCAD,ADAC,CCAD,ADAC,CAAK,UAAU,CAAA,AAC1D,CAAC,CAAA,ACAA,CDAA,ACAA,CDAA,ACAA,CAAA,ADAA,CCAA,ADAA,CCAQ,ADAA,CAAA,ACAA,CDAE,EAAA,kCAAsC,CAAA,CAAA,CAAA,CAAA,AAAK,UAAU,CAAA,AAChE,QAAS,CAAA,ACAA,ADAE,EAAG,CCA6B,ADAS,CCAT,ADAS,CCAT,ADAS,CCAT,ADAS,CAAA,ACAT,CAAA,ADAS,CCAT,ADAS,CAAA,ACAT,CAAA,ADAS,CCAT,ADAS,CCAT,ADAS,CCAT,ADAS,CAAA,ACAT,CDAS,ACAT,CDAS,ACAT,CAAA,ADAS,CCAT,ADAS,CAAA,ACAT,CAAA,ADAS,CCAT,ADAS,CCAT,ADAS,CAAA,ACAT,CDAS,ACAT,CAAA,ADAS,CCAT,ADAS,CCAT,ADAS,CAAA,ACAT,CAAA,ADAS,SAAA,CAAA,CAAA,CAAA,CAAA,UAAe,CAAA,AACnE,QAAS,CAAE,AAAF,EAAK,CAAmC,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,AAAK,QAAA,CAAU,CAAA,CAAA,AAChE,CAAC,CAAA,CAAA,CAAA,IAAQ,CAAA,AAAE,EAAG,CAAqC,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CA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","ignoreList":[0,1,7,8]}